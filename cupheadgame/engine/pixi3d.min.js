/*! Pixi3D v1.2.0 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("pixi.js")):"function"==typeof define&&define.amd?define("PIXI3D",["pixi.js"],t):"object"==typeof exports?exports.PIXI3D=t(require("pixi.js")):e.PIXI3D=t(e.PIXI)}(window,(function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=17)}([function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return o})),n.d(t,"__assign",(function(){return i})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return u})),n.d(t,"__param",(function(){return s})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return f})),n.d(t,"__generator",(function(){return l})),n.d(t,"__createBinding",(function(){return d})),n.d(t,"__exportStar",(function(){return h})),n.d(t,"__values",(function(){return p})),n.d(t,"__read",(function(){return _})),n.d(t,"__spread",(function(){return m})),n.d(t,"__spreadArrays",(function(){return v})),n.d(t,"__spreadArray",(function(){return g})),n.d(t,"__await",(function(){return b})),n.d(t,"__asyncGenerator",(function(){return y})),n.d(t,"__asyncDelegator",(function(){return M})),n.d(t,"__asyncValues",(function(){return x})),n.d(t,"__makeTemplateObject",(function(){return T})),n.d(t,"__importStar",(function(){return S})),n.d(t,"__importDefault",(function(){return w})),n.d(t,"__classPrivateFieldGet",(function(){return E})),n.d(t,"__classPrivateFieldSet",(function(){return P}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function u(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function h(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||d(t,e,n)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r}function g(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||t)}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||u(e,t)}))})}function u(e,t){try{(n=o[e](t)).value instanceof b?Promise.resolve(n.value.v).then(s,c):f(i[0][2],n)}catch(e){f(i[0][3],e)}var n}function s(e){u("next",e)}function c(e){u("throw",e)}function f(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function M(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:b(e[r](t)),done:"return"===r}:o?o(t):t}:o}}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&d(t,e,n);return A(t,e),t}function w(e){return e&&e.__esModule?e:{default:e}}function E(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function P(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n}},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Container3D=void 0;var r=n(0),o=r.__importStar(n(1)),i=n(34),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transform=new i.Transform3D,t}return r.__extends(t,e),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotationQuaternion",{get:function(){return this.transform.rotationQuaternion},set:function(e){this.transform.rotationQuaternion.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this.transform.position.z},set:function(e){this.transform.position.z=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),t}(o.Container);t.Container3D=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mat4=void 0;var r=n(16),o=function(){function e(){}return e.getTranslation=function(e,t){return void 0===t&&(t=new Float32Array(3)),r.mat4.getTranslation(t,e)},e.create=function(){return r.mat4.create()},e.translate=function(e,t,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.translate(n,e,t)},e.getScaling=function(e,t){return void 0===t&&(t=new Float32Array(3)),r.mat4.getScaling(t,e)},e.getRotation=function(e,t){return void 0===t&&(t=new Float32Array(4)),r.mat4.getRotation(t,e)},e.copy=function(e,t){return void 0===t&&(t=new Float32Array(16)),r.mat4.copy(t,e)},e.fromQuat=function(e,t){return void 0===t&&(t=new Float32Array(16)),r.mat4.fromQuat(t,e)},e.fromRotationTranslationScale=function(e,t,n,o){return void 0===o&&(o=new Float32Array(16)),r.mat4.fromRotationTranslationScale(o,e,t,n)},e.fromRotation=function(e,t,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.fromRotation(n,e,t)},e.fromScaling=function(e,t){return void 0===t&&(t=new Float32Array(16)),r.mat4.fromScaling(t,e)},e.fromTranslation=function(e,t){return void 0===t&&(t=new Float32Array(16)),r.mat4.fromTranslation(t,e)},e.multiply=function(e,t,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.multiply(n,e,t)},e.lookAt=function(e,t,n,o){return void 0===o&&(o=new Float32Array(16)),r.mat4.lookAt(o,e,t,n)},e.identity=function(e){return void 0===e&&(e=new Float32Array(16)),r.mat4.identity(e)},e.perspective=function(e,t,n,o,i){return void 0===i&&(i=new Float32Array(16)),r.mat4.perspective(i,e,t,n,o)},e.ortho=function(e,t,n,o,i,a,u){return void 0===u&&(u=new Float32Array(16)),r.mat4.ortho(u,e,t,n,o,i,a)},e.invert=function(e,t){return void 0===t&&(t=new Float32Array(16)),r.mat4.invert(t,e)},e.transpose=function(e,t){return void 0===t&&(t=new Float32Array(16)),r.mat4.transpose(t,e)},e.targetTo=function(e,t,n,o){return void 0===o&&(o=new Float32Array(16)),r.mat4.targetTo(o,e,t,n)},e.rotateX=function(e,t,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.rotateX(n,e,t)},e.rotateY=function(e,t,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.rotateY(n,e,t)},e.rotateZ=function(e,t,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.rotateZ(n,e,t)},e.rotate=function(e,t,n,o){return void 0===o&&(o=new Float32Array(16)),r.mat4.rotate(o,e,t,n)},e.scale=function(e,t,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.scale(n,e,t)},e}();t.Mat4=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vec3=void 0;var r=n(16),o=function(){function e(){}return e.set=function(e,t,n,o){return void 0===o&&(o=new Float32Array(3)),r.vec3.set(o,e,t,n)},e.fromValues=function(e,t,n){return r.vec3.fromValues(e,t,n)},e.create=function(){return r.vec3.create()},e.add=function(e,t,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.add(n,e,t)},e.transformQuat=function(e,t,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.transformQuat(n,e,t)},e.subtract=function(e,t,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.subtract(n,e,t)},e.scale=function(e,t,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.scale(n,e,t)},e.dot=function(e,t){return r.vec3.dot(e,t)},e.normalize=function(e,t){return void 0===t&&(t=new Float32Array(3)),r.vec3.normalize(t,e)},e.cross=function(e,t,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.cross(n,e,t)},e.transformMat4=function(e,t,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.transformMat4(n,e,t)},e.copy=function(e,t){return void 0===t&&(t=new Float32Array(3)),r.vec3.copy(t,e)},e.magnitude=function(e){return r.vec3.length(e)},e.inverse=function(e,t){return void 0===t&&(t=new Float32Array(3)),r.vec3.inverse(t,e)},e.negate=function(e,t){return void 0===t&&(t=new Float32Array(3)),r.vec3.negate(t,e)},e.multiply=function(e,t,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.multiply(n,e,t)},e.distance=function(e,t){return r.vec3.distance(e,t)},e.squaredDistance=function(e,t){return r.vec3.squaredDistance(e,t)},e}();t.Vec3=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;var r=n(0),o=r.__importStar(n(1)),i=n(2),a=n(3),u=n(37),s=n(4),c=n(35),f=n(36),l=n(22),d=new Float32Array(3),h=new Float32Array(16),p=new Float32Array(4),_=function(e){function t(n){var r=e.call(this)||this;r.renderer=n,r._transformId=0,r._orthographic=!1,r._orthographicSize=10,r._obliqueness=new o.ObservablePoint((function(){r._transformId++}),void 0),r._fieldOfView=60,r._near=.1,r._far=1e3;var i=n.width/n.height,a=-1;return r.renderer.on("prerender",(function(){r._aspect||n.width/n.height!==i&&(r._transformId++,i=n.width/n.height),r.parent||a===r.transform._localID||(r.transform.updateTransform(),a=r.transform._localID)})),t.main||(t.main=r),r.transform.position.z=5,r.transform.rotationQuaternion.setEulerAngles(0,180,0),r}return r.__extends(t,e),Object.defineProperty(t.prototype,"transformId",{get:function(){return this.transform._worldID+this._transformId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"obliqueness",{get:function(){return this._obliqueness},set:function(e){this._obliqueness.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype.destroy=function(n){e.prototype.destroy.call(this,n),this===t.main&&(t.main=void 0)},Object.defineProperty(t.prototype,"orthographicSize",{get:function(){return this._orthographicSize},set:function(e){this._orthographicSize!==e&&(this._orthographicSize=e,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"orthographic",{get:function(){return this._orthographic},set:function(e){this._orthographic!==e&&(this._orthographic=e,this._transformId++)},enumerable:!1,configurable:!0}),t.prototype.screenToRay=function(e,t,n){void 0===n&&(n=this.renderer.screen);var r=this.screenToWorld(e,t,1,void 0,n);if(r)return this.orthographic?new u.Ray(r.array,this.worldTransform.forward):new u.Ray(this.worldTransform.position,s.Vec3.subtract(r.array,this.worldTransform.position,d))},t.prototype.screenToWorld=function(e,t,n,r,o){var i;void 0===r&&(r=new l.ObservablePoint3D((function(){}),void 0)),void 0===o&&(o=this.renderer.screen),this.transform.updateTransform(null===(i=this.parent)||void 0===i?void 0:i.transform);var u=this.far;this.far=n;var s=a.Mat4.invert(this.viewProjection,h);if(null!==s){var f=c.Vec4.set(e/o.width*2-1,-1*(t/o.height*2-1),1,1,p);this.far=u;var d=c.Vec4.transformMat4(f,s,p);d[3]=1/d[3];for(var _=0;_<3;_++)d[_]*=d[3];return r.set(d[0],d[1],d[2])}},t.prototype.worldToScreen=function(e,t,n,r,i){var a;void 0===r&&(r=new o.Point),void 0===i&&(i=this.renderer.screen),this.transform.updateTransform(null===(a=this.parent)||void 0===a?void 0:a.transform);var u=c.Vec4.set(e,t,n,1,p),s=c.Vec4.transformMat4(c.Vec4.transformMat4(u,this.view,p),this.projection,p);if(0!==s[3])for(var f=0;f<3;f++)s[f]/=s[3];return r.set((s[0]+1)/2*i.width,i.height-(s[1]+1)/2*i.height)},Object.defineProperty(t.prototype,"aspect",{get:function(){return this._aspect},set:function(e){this._aspect!==e&&(this._aspect=e,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fieldOfView",{get:function(){return this._fieldOfView},set:function(e){this._fieldOfView!==e&&(this._fieldOfView=e,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"near",{get:function(){return this._near},set:function(e){this._near!==e&&(this._near=e,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"far",{get:function(){return this._far},set:function(e){this._far!==e&&(this._far=e,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"projection",{get:function(){var e=this;return this._projection||(this._projection=new f.MatrixComponent(this,16,(function(t){var n=e._aspect||e.renderer.width/e.renderer.height;e._orthographic?a.Mat4.ortho(-e._orthographicSize*n,e._orthographicSize*n,-e._orthographicSize,e._orthographicSize,e._near,e._far,t):(a.Mat4.perspective(e._fieldOfView*o.DEG_TO_RAD,n,e._near,e._far,t),t[8]=e._obliqueness.x,t[9]=e._obliqueness.y)}))),this._projection.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){var e=this;return this._view||(this._view=new f.MatrixComponent(this,16,(function(t){var n=s.Vec3.add(e.worldTransform.position,e.worldTransform.forward,d);a.Mat4.lookAt(e.worldTransform.position,n,e.worldTransform.up,t)}))),this._view.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewProjection",{get:function(){var e=this;return this._viewProjection||(this._viewProjection=new f.MatrixComponent(this,16,(function(t){a.Mat4.multiply(e.projection,e.view,t)}))),this._viewProjection.array},enumerable:!1,configurable:!0}),t}(i.Container3D);t.Camera=_,o.Renderer.registerPlugin("camera",_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Quat=void 0;var r=n(16),o=function(){function e(){}return e.set=function(e,t,n,o,i){return void 0===i&&(i=new Float32Array(4)),r.quat.set(i,e,t,n,o)},e.fromValues=function(e,t,n,o){return r.quat.fromValues(e,t,n,o)},e.create=function(){return r.quat.create()},e.normalize=function(e,t){return void 0===t&&(t=new Float32Array(4)),r.quat.normalize(t,e)},e.slerp=function(e,t,n,o){return void 0===o&&(o=new Float32Array(4)),r.quat.slerp(o,e,t,n)},e.fromEuler=function(e,t,n,o){return void 0===o&&(o=new Float32Array(4)),r.quat.fromEuler(o,e,t,n)},e.conjugate=function(e,t){return void 0===t&&(t=new Float32Array(4)),r.quat.conjugate(t,e)},e.rotateX=function(e,t,n){return void 0===n&&(n=new Float32Array(4)),r.quat.rotateX(n,e,t)},e.rotateY=function(e,t,n){return void 0===n&&(n=new Float32Array(4)),r.quat.rotateY(n,e,t)},e.rotateZ=function(e,t,n){return void 0===n&&(n=new Float32Array(4)),r.quat.rotateZ(n,e,t)},e}();t.Quat=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mesh3D=void 0;var r=n(0),o=n(60),i=n(61),a=n(2),u=n(62),s=n(63),c=n(11),f=n(17),l=n(28),d=function(e){function t(t,n){var r=e.call(this)||this;if(r.geometry=t,r.material=n,r.pluginName="pipeline",r.enabledRenderPasses={material:{}},r.renderSortOrder=0,r._instances=[],!t)throw new Error("PIXI3D: Geometry is required when creating a mesh.");return r}return r.__extends(t,e),Object.defineProperty(t.prototype,"instances",{get:function(){return this._instances},enumerable:!1,configurable:!0}),t.prototype.createInstance=function(){var e;if(this.material&&!this.material.isInstancingSupported)throw new Error("PIXI3D: Can't create instance of mesh, material does not support instancing.");return this._instances[this._instances.push(new s.InstancedMesh3D(this,null===(e=this.material)||void 0===e?void 0:e.createInstance()))-1]},t.prototype.removeInstance=function(e){var t=this._instances.indexOf(e);t>=0&&this._instances.splice(t,1)},t.prototype.enableRenderPass=function(e,t){this.enabledRenderPasses[e]||(this.enabledRenderPasses[e]=t||{})},t.prototype.disableRenderPass=function(e){this.enabledRenderPasses[e]&&delete this.enabledRenderPasses[e]},t.prototype.isRenderPassEnabled=function(e){return!!this.enabledRenderPasses[e]},t.prototype.destroy=function(t){(!0===t||t&&t.geometry)&&this.geometry.destroy(),(!0===t||t&&t.material)&&this.material&&this.material.destroy(),e.prototype.destroy.call(this,t)},t.prototype._render=function(e){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.skin&&this.skin.calculateJointMatrices(),e.plugins[this.pluginName].render(this)},t.prototype.getBoundingBox=function(){var e,t;if((null===(e=this.geometry.positions)||void 0===e?void 0:e.min)&&(null===(t=this.geometry.positions)||void 0===t?void 0:t.max)){for(var n=f.Vec3.transformMat4(this.geometry.positions.min,this.worldTransform.array),r=f.Vec3.transformMat4(this.geometry.positions.max,this.worldTransform.array),o=0;o<3;o++){var i=n[o];n[o]=Math.min(n[o],r[o]),r[o]=Math.max(i,r[o])}return l.AABB.from({min:n,max:r})}},t.createQuad=function(e){return void 0===e&&(e=new c.StandardMaterial),new t(u.QuadGeometry.create(),e)},t.createCube=function(e){return void 0===e&&(e=new c.StandardMaterial),new t(i.CubeGeometry.create(),e)},t.createPlane=function(e){return void 0===e&&(e=new c.StandardMaterial),new t(o.PlaneGeometry.create(),e)},t}(a.Container3D);t.Mesh3D=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeshShader=void 0;var r=n(0),o=n(1),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._state=Object.assign(new o.State,{culling:!0,clockwiseFrontFace:!1,depthTest:!0}),t}return r.__extends(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"mesh-shader"},enumerable:!1,configurable:!0}),t.prototype.createShaderGeometry=function(e,t){var n=new o.Geometry;return e.indices&&(1===e.indices.buffer.BYTES_PER_ELEMENT?n.addIndex(new o.Buffer(new Uint16Array(e.indices.buffer))):n.addIndex(new o.Buffer(e.indices.buffer))),e.positions&&n.addAttribute("a_Position",new o.Buffer(e.positions.buffer),3,!1,e.positions.componentType,e.positions.stride),e.uvs&&e.uvs[0]&&n.addAttribute("a_UV1",new o.Buffer(e.uvs[0].buffer),2,!1,e.uvs[0].componentType,e.uvs[0].stride),e.normals&&n.addAttribute("a_Normal",new o.Buffer(e.normals.buffer),3,!1,e.normals.componentType,e.normals.stride),e.tangents&&n.addAttribute("a_Tangent",new o.Buffer(e.tangents.buffer),4,!1,e.tangents.componentType,e.tangents.stride),n},t.prototype.render=function(e,t,n,r){void 0===n&&(n=this._state),void 0===r&&(r=o.DRAW_MODES.TRIANGLES);var i=e.instances.filter((function(e){return e.worldVisible&&e.renderable})).length,a=e.instances.length>0;e.geometry.hasShaderGeometry(this,a)||e.geometry.addShaderGeometry(this,a);var u=e.geometry.getShaderGeometry(this);t.shader.bind(this,!1),t.state.set(n),t.geometry.bind(u,this),t.geometry.draw(r,void 0,void 0,i)},t}(o.Shader);t.MeshShader=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;var r=n(0),o=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),this._array4=new Float32Array([e,t,n,r]),this._array3=this._array4.subarray(0,3)}return e.fromBytes=function(t,n,r,o){return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=255),new e(t/255,n/255,r/255,o/255)},e.fromHex=function(t){return"string"==typeof t&&(t=parseInt(t.replace(/[^0-9A-F]/gi,""),16)),e.fromBytes(t>>16&255,t>>8&255,255&t)},Object.defineProperty(e.prototype,"rgb",{get:function(){return this._array3},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rgba",{get:function(){return this._array4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"r",{get:function(){return this._array4[0]},set:function(e){this._array4[0]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this._array4[1]},set:function(e){this._array4[1]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this._array4[2]},set:function(e){this._array4[2]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this._array4[3]},set:function(e){this._array4[3]=e},enumerable:!1,configurable:!0}),e.from=function(t){return new(e.bind.apply(e,r.__spreadArray([void 0],r.__read(t))))},e}();t.Color=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeshGeometry3D=void 0;var r=function(){function e(){this._shaderGeometry={}}return e.prototype.getShaderGeometry=function(e){return this._shaderGeometry[e.name]},e.prototype.addShaderGeometry=function(e,t){this._shaderGeometry[e.name]=e.createShaderGeometry(this,t)},e.prototype.hasShaderGeometry=function(e,t){return!!this._shaderGeometry[e.name]&&(!t||t&&this._shaderGeometry[e.name].instanced)},e.prototype.destroy=function(){for(var e in this._shaderGeometry)this._shaderGeometry[e].destroy();this._shaderGeometry={}},e}();t.MeshGeometry3D=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterial=void 0;var r=n(0),o=n(1),i=n(12),a=n(64),u=n(65),s=n(27),c=n(5),f=n(41),l=n(18),d=n(69),h=n(9),p=n(42),_=n(70),m=n(47),v=n(17),g={},b=function(e){return e?e.lights.length+(e.imageBasedLighting?.5:0):0},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lightingEnvironmentConfigId=0,t._unlit=!1,t._alphaMode=l.StandardMaterialAlphaMode.opaque,t._baseColor=new Float32Array(4),t._instancingEnabled=!1,t._skinUniforms=new d.StandardMaterialSkinUniforms,t.roughness=1,t.metallic=1,t.baseColor=new h.Color(1,1,1,1),t.alphaCutoff=.5,t.emissive=new h.Color(0,0,0),t.exposure=1,t}return r.__extends(t,e),Object.defineProperty(t.prototype,"baseColorTexture",{get:function(){return this._baseColorTexture},set:function(e){e!==this._baseColorTexture&&(this.invalidateShader(),!(null==e?void 0:e.transform)&&(null==e?void 0:e.frame)&&(e.transform=v.TextureTransform.fromTexture(e)),this._baseColorTexture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metallicRoughnessTexture",{get:function(){return this._metallicRoughnessTexture},set:function(e){e!==this._metallicRoughnessTexture&&(this.invalidateShader(),!(null==e?void 0:e.transform)&&(null==e?void 0:e.frame)&&(e.transform=v.TextureTransform.fromTexture(e)),this._metallicRoughnessTexture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"normalTexture",{get:function(){return this._normalTexture},set:function(e){e!==this._normalTexture&&(this.invalidateShader(),!(null==e?void 0:e.transform)&&(null==e?void 0:e.frame)&&(e.transform=v.TextureTransform.fromTexture(e)),this._normalTexture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"occlusionTexture",{get:function(){return this._occlusionTexture},set:function(e){e!==this._occlusionTexture&&(this.invalidateShader(),!(null==e?void 0:e.transform)&&(null==e?void 0:e.frame)&&(e.transform=v.TextureTransform.fromTexture(e)),this._occlusionTexture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"emissiveTexture",{get:function(){return this._emissiveTexture},set:function(e){e!==this._emissiveTexture&&(this.invalidateShader(),!(null==e?void 0:e.transform)&&(null==e?void 0:e.frame)&&(e.transform=v.TextureTransform.fromTexture(e)),this._emissiveTexture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alphaMode",{get:function(){return this._alphaMode},set:function(e){this._alphaMode!==e&&(this._alphaMode=e,this.invalidateShader())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowCastingLight",{get:function(){return this._shadowCastingLight},set:function(e){e!==this._shadowCastingLight&&(this.invalidateShader(),this._shadowCastingLight=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"debugMode",{get:function(){return this._debugMode},set:function(e){this._debugMode!==e&&(this.invalidateShader(),this._debugMode=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lightingEnvironment",{get:function(){return this._lightingEnvironment},set:function(e){e!==this._lightingEnvironment&&(this.invalidateShader(),this._lightingEnvironmentConfigId=b(e),this._lightingEnvironment=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unlit",{get:function(){return this._unlit},set:function(e){this._unlit!==e&&(this._unlit=e,this.invalidateShader())},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){var e,t,n,r,o;null===(e=this._baseColorTexture)||void 0===e||e.destroy(),null===(t=this._normalTexture)||void 0===t||t.destroy(),null===(n=this._emissiveTexture)||void 0===n||n.destroy(),null===(r=this._occlusionTexture)||void 0===r||r.destroy(),null===(o=this._metallicRoughnessTexture)||void 0===o||o.destroy(),this._skinUniforms.destroy()},t.prototype.invalidateShader=function(){this._shader=void 0},t.create=function(e){return(new _.StandardMaterialFactory).create(e)},t.prototype.render=function(t,n){!this._instancingEnabled&&t.instances.length>0&&(this.invalidateShader(),this._instancingEnabled=t.instances.length>0);var r=this.lightingEnvironment||f.LightingEnvironment.main,o=b(r);o!==this._lightingEnvironmentConfigId&&(this.invalidateShader(),this._lightingEnvironmentConfigId=o),e.prototype.render.call(this,t,n)},Object.defineProperty(t.prototype,"isInstancingSupported",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.createInstance=function(){return new p.InstancedStandardMaterial(this)},t.prototype.createShader=function(e,t){var n,o;if(1===t.context.webGLVersion){try{for(var i=r.__values(["EXT_shader_texture_lod","OES_standard_derivatives"]),s=i.next();!s.done;s=i.next()){var c=s.value;t.gl.getExtension(c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}}var l=this.lightingEnvironment||f.LightingEnvironment.main,d=a.StandardMaterialFeatureSet.build(t,e,e.geometry,this,l);if(d){e.skin&&a.StandardMaterialFeatureSet.hasSkinningTextureFeature(d)&&this._skinUniforms.enableJointMatrixTextures(e.skin.joints.length);var h=d.join(",");return g[h]||(g[h]=u.StandardShader.build(t,d)),g[h]}},t.prototype.updateUniforms=function(e,t){var n,r,a,u,s;this._baseColor.set(this.baseColor.rgb),this._baseColor[3]=this.baseColor.a*e.worldAlpha;var d=this.camera||c.Camera.main;e.skin&&this._skinUniforms.update(e,t),t.uniforms.u_Camera=d.worldTransform.position,t.uniforms.u_ViewProjectionMatrix=d.viewProjection,t.uniforms.u_Exposure=this.exposure,t.uniforms.u_MetallicFactor=this.metallic,t.uniforms.u_RoughnessFactor=this.roughness,t.uniforms.u_BaseColorFactor=this._baseColor,t.uniforms.u_ModelMatrix=e.worldTransform.array,t.uniforms.u_NormalMatrix=e.transform.normalTransform.array,this._alphaMode===l.StandardMaterialAlphaMode.mask&&(t.uniforms.u_AlphaCutoff=this.alphaCutoff),e.targetWeights&&(t.uniforms.u_morphWeights=e.targetWeights),(null===(n=this.baseColorTexture)||void 0===n?void 0:n.valid)&&(t.uniforms.u_BaseColorSampler=this.baseColorTexture,t.uniforms.u_BaseColorUVSet=this.baseColorTexture.uvSet||0,this.baseColorTexture.transform&&(t.uniforms.u_BaseColorUVTransform=this.baseColorTexture.transform.array));for(var h=this.lightingEnvironment||f.LightingEnvironment.main,p=0;p<h.lights.length;p++){var _=h.lights[p],v=0;switch(_.type){case i.LightType.point:v=1;break;case i.LightType.directional:v=0;break;case i.LightType.spot:v=2}t.uniforms["u_Lights["+p+"].type"]=v,t.uniforms["u_Lights["+p+"].position"]=_.worldTransform.position,t.uniforms["u_Lights["+p+"].direction"]=_.worldTransform.forward,t.uniforms["u_Lights["+p+"].range"]=_.range,t.uniforms["u_Lights["+p+"].color"]=_.color.rgb,t.uniforms["u_Lights["+p+"].intensity"]=_.intensity,t.uniforms["u_Lights["+p+"].innerConeCos"]=Math.cos(_.innerConeAngle*o.DEG_TO_RAD),t.uniforms["u_Lights["+p+"].outerConeCos"]=Math.cos(_.outerConeAngle*o.DEG_TO_RAD)}this._shadowCastingLight&&(t.uniforms.u_ShadowSampler=this._shadowCastingLight.shadowTexture,t.uniforms.u_LightViewProjectionMatrix=this._shadowCastingLight.lightViewProjection,t.uniforms.u_ShadowLightIndex=h.lights.indexOf(this._shadowCastingLight.light));var g=h.imageBasedLighting;(null==g?void 0:g.valid)&&(t.uniforms.u_DiffuseEnvSampler=g.diffuse,t.uniforms.u_SpecularEnvSampler=g.specular,t.uniforms.u_brdfLUT=g.lookupBrdf||m.ImageBasedLighting.defaultLookupBrdf,t.uniforms.u_MipCount=g.specular.levels-1),(null===(r=this.emissiveTexture)||void 0===r?void 0:r.valid)&&(t.uniforms.u_EmissiveSampler=this.emissiveTexture,t.uniforms.u_EmissiveUVSet=this.emissiveTexture.uvSet||0,t.uniforms.u_EmissiveFactor=this.emissive.rgb,this.emissiveTexture.transform&&(t.uniforms.u_EmissiveUVTransform=this.emissiveTexture.transform.array)),(null===(a=this.normalTexture)||void 0===a?void 0:a.valid)&&(t.uniforms.u_NormalSampler=this.normalTexture,t.uniforms.u_NormalScale=this.normalTexture.scale||1,t.uniforms.u_NormalUVSet=this.normalTexture.uvSet||0,this.normalTexture.transform&&(t.uniforms.u_NormalUVTransform=this.normalTexture.transform.array)),(null===(u=this.metallicRoughnessTexture)||void 0===u?void 0:u.valid)&&(t.uniforms.u_MetallicRoughnessSampler=this.metallicRoughnessTexture,t.uniforms.u_MetallicRoughnessUVSet=this.metallicRoughnessTexture.uvSet||0,this.metallicRoughnessTexture.transform&&(t.uniforms.u_MetallicRoughnessUVTransform=this.metallicRoughnessTexture.transform.array)),(null===(s=this.occlusionTexture)||void 0===s?void 0:s.valid)&&(t.uniforms.u_OcclusionSampler=this.occlusionTexture,t.uniforms.u_OcclusionStrength=this.occlusionTexture.strength||1,t.uniforms.u_OcclusionUVSet=this.occlusionTexture.uvSet||0,this.occlusionTexture.transform&&(t.uniforms.u_OcclusionUVTransform=this.occlusionTexture.transform.array))},t}(s.Material);t.StandardMaterial=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LightType=void 0,function(e){e.spot="spot",e.directional="directional",e.point="point"}(t.LightType||(t.LightType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Capabilities=void 0,function(e){var t,n,r,o,i,a;e.getMaxVertexUniformVectors=function(e){if(void 0!==t)return t;var n=e.gl;return t=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS)},e.isFloatingPointTextureSupported=function(e){if(2===e.context.webGLVersion)return!0;if(void 0!==n)return n;var t=e.gl;return n=!!t.getExtension("OES_texture_float")},e.isHalfFloatFramebufferSupported=function(e){if(2===e.context.webGLVersion)return!0;if(void 0!==r)return r;var t=e.gl,n=t.getExtension("OES_texture_half_float");if(!n)return!1;var o=t.createTexture();t.bindTexture(t.TEXTURE_2D,o),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,8,8,0,t.RGBA,n.HALF_FLOAT_OES,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i);var a=t.COLOR_ATTACHMENT0;return t.framebufferTexture2D(t.FRAMEBUFFER,a,t.TEXTURE_2D,o,0),r=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE},e.isFloatFramebufferSupported=function(e){if(2===e.context.webGLVersion)return!0;if(void 0!==o)return o;var t=e.gl;if(!t.getExtension("OES_texture_float"))return!1;var n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,8,8,0,t.RGBA,t.FLOAT,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r);var i=t.COLOR_ATTACHMENT0;return t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,n,0),o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE},e.supportsFloatLinear=function(e){if(void 0!==i)return i;var t=e.gl;return i=null!==t.getExtension("OES_texture_float_linear")},e.isShaderTextureLodSupported=function(e){return 2===e.context.webGLVersion||null!==e.gl.getExtension("EXT_shader_texture_lod")},e.isInstancingSupported=function(e){if(void 0!==a)return a;var t=e.gl;return a=void 0!==t.getExtension("ANGLE_instanced_arrays")}}(t.Capabilities||(t.Capabilities={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFChannel=void 0;var r=function(){function e(e,t){this._position=0,this._frame=0,this._input=e,this._interpolation=t}return Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(e){this.setPosition(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._input[this._input.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._input.length},enumerable:!1,configurable:!0}),e.prototype.setPosition=function(e){this._position=e,this._frame=this.calculateFrame(this._position),this.updateTarget(this._interpolation.interpolate(this._frame,this.calculateFramePosition(this._frame,this._position)))},e.prototype.update=function(e){this.position+=e},e.prototype.calculateFramePosition=function(e,t){return e===this._input.length-1?1:(t-this._input[e])/(this._input[e+1]-this._input[e])},e.prototype.calculateFrame=function(e){if(e<this._input[0])return 0;for(var t=0;t<this._input.length-1;t++)if(e>=this._input[t]&&e<this._input[t+1])return t;return this._input.length-1},e.from=function(e,t,n,r,f){if("translation"===r)return new c.glTFTranslation(f.transform,e,o.glTFInterpolation.from(n,e,t,3));if("scale"===r)return new a.glTFScale(f.transform,e,o.glTFInterpolation.from(n,e,t,3));if("rotation"===r)return"LINEAR"===n?new s.glTFRotation(f.transform,e,new i.glTFSphericalLinear(t)):new s.glTFRotation(f.transform,e,o.glTFInterpolation.from(n,e,t,4));if("weights"===r){var l=f.children[0].targetWeights;if(!l)return;return new u.glTFWeights(l,e,o.glTFInterpolation.from(n,e,t,l.length))}throw new Error('PIXI3D: Unknown channel path "'+r+'"')},e}();t.glTFChannel=r;var o=n(15),i=n(77),a=n(78),u=n(79),s=n(80),c=n(81)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFInterpolation=void 0;var r=function(){function e(){}return e.from=function(e,t,n,r){switch(e){case"LINEAR":return new o.glTFLinear(n,r);case"CUBICSPLINE":return new i.glTFCubicSpline(t,n,r);case"STEP":return new a.glTFStep(n,r)}throw new Error('PIXI3D: Unknown interpolation type "'+e+'"')},e}();t.glTFInterpolation=r;var o=n(74),i=n(75),a=n(76)},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"EPSILON",(function(){return h})),n.d(r,"ARRAY_TYPE",(function(){return p})),n.d(r,"RANDOM",(function(){return _})),n.d(r,"setMatrixArrayType",(function(){return m})),n.d(r,"toRadian",(function(){return g})),n.d(r,"equals",(function(){return b}));var o={};n.r(o),n.d(o,"create",(function(){return y})),n.d(o,"clone",(function(){return M})),n.d(o,"copy",(function(){return x})),n.d(o,"identity",(function(){return T})),n.d(o,"fromValues",(function(){return A})),n.d(o,"set",(function(){return S})),n.d(o,"transpose",(function(){return w})),n.d(o,"invert",(function(){return E})),n.d(o,"adjoint",(function(){return P})),n.d(o,"determinant",(function(){return O})),n.d(o,"multiply",(function(){return C})),n.d(o,"rotate",(function(){return R})),n.d(o,"scale",(function(){return I})),n.d(o,"fromRotation",(function(){return N})),n.d(o,"fromScaling",(function(){return L})),n.d(o,"str",(function(){return F})),n.d(o,"frob",(function(){return D})),n.d(o,"LDU",(function(){return j})),n.d(o,"add",(function(){return B})),n.d(o,"subtract",(function(){return U})),n.d(o,"exactEquals",(function(){return G})),n.d(o,"equals",(function(){return V})),n.d(o,"multiplyScalar",(function(){return H})),n.d(o,"multiplyScalarAndAdd",(function(){return k})),n.d(o,"mul",(function(){return Q})),n.d(o,"sub",(function(){return z}));var i={};n.r(i),n.d(i,"create",(function(){return W})),n.d(i,"clone",(function(){return q})),n.d(i,"copy",(function(){return X})),n.d(i,"identity",(function(){return J})),n.d(i,"fromValues",(function(){return K})),n.d(i,"set",(function(){return Y})),n.d(i,"invert",(function(){return Z})),n.d(i,"determinant",(function(){return $})),n.d(i,"multiply",(function(){return ee})),n.d(i,"rotate",(function(){return te})),n.d(i,"scale",(function(){return ne})),n.d(i,"translate",(function(){return re})),n.d(i,"fromRotation",(function(){return oe})),n.d(i,"fromScaling",(function(){return ie})),n.d(i,"fromTranslation",(function(){return ae})),n.d(i,"str",(function(){return ue})),n.d(i,"frob",(function(){return se})),n.d(i,"add",(function(){return ce})),n.d(i,"subtract",(function(){return fe})),n.d(i,"multiplyScalar",(function(){return le})),n.d(i,"multiplyScalarAndAdd",(function(){return de})),n.d(i,"exactEquals",(function(){return he})),n.d(i,"equals",(function(){return pe})),n.d(i,"mul",(function(){return _e})),n.d(i,"sub",(function(){return me}));var a={};n.r(a),n.d(a,"create",(function(){return ve})),n.d(a,"fromMat4",(function(){return ge})),n.d(a,"clone",(function(){return be})),n.d(a,"copy",(function(){return ye})),n.d(a,"fromValues",(function(){return Me})),n.d(a,"set",(function(){return xe})),n.d(a,"identity",(function(){return Te})),n.d(a,"transpose",(function(){return Ae})),n.d(a,"invert",(function(){return Se})),n.d(a,"adjoint",(function(){return we})),n.d(a,"determinant",(function(){return Ee})),n.d(a,"multiply",(function(){return Pe})),n.d(a,"translate",(function(){return Oe})),n.d(a,"rotate",(function(){return Ce})),n.d(a,"scale",(function(){return Re})),n.d(a,"fromTranslation",(function(){return Ie})),n.d(a,"fromRotation",(function(){return Ne})),n.d(a,"fromScaling",(function(){return Le})),n.d(a,"fromMat2d",(function(){return Fe})),n.d(a,"fromQuat",(function(){return De})),n.d(a,"normalFromMat4",(function(){return je})),n.d(a,"projection",(function(){return Be})),n.d(a,"str",(function(){return Ue})),n.d(a,"frob",(function(){return Ge})),n.d(a,"add",(function(){return Ve})),n.d(a,"subtract",(function(){return He})),n.d(a,"multiplyScalar",(function(){return ke})),n.d(a,"multiplyScalarAndAdd",(function(){return Qe})),n.d(a,"exactEquals",(function(){return ze})),n.d(a,"equals",(function(){return We})),n.d(a,"mul",(function(){return qe})),n.d(a,"sub",(function(){return Xe}));var u={};n.r(u),n.d(u,"create",(function(){return Je})),n.d(u,"clone",(function(){return Ke})),n.d(u,"copy",(function(){return Ye})),n.d(u,"fromValues",(function(){return Ze})),n.d(u,"set",(function(){return $e})),n.d(u,"identity",(function(){return et})),n.d(u,"transpose",(function(){return tt})),n.d(u,"invert",(function(){return nt})),n.d(u,"adjoint",(function(){return rt})),n.d(u,"determinant",(function(){return ot})),n.d(u,"multiply",(function(){return it})),n.d(u,"translate",(function(){return at})),n.d(u,"scale",(function(){return ut})),n.d(u,"rotate",(function(){return st})),n.d(u,"rotateX",(function(){return ct})),n.d(u,"rotateY",(function(){return ft})),n.d(u,"rotateZ",(function(){return lt})),n.d(u,"fromTranslation",(function(){return dt})),n.d(u,"fromScaling",(function(){return ht})),n.d(u,"fromRotation",(function(){return pt})),n.d(u,"fromXRotation",(function(){return _t})),n.d(u,"fromYRotation",(function(){return mt})),n.d(u,"fromZRotation",(function(){return vt})),n.d(u,"fromRotationTranslation",(function(){return gt})),n.d(u,"fromQuat2",(function(){return bt})),n.d(u,"getTranslation",(function(){return yt})),n.d(u,"getScaling",(function(){return Mt})),n.d(u,"getRotation",(function(){return xt})),n.d(u,"fromRotationTranslationScale",(function(){return Tt})),n.d(u,"fromRotationTranslationScaleOrigin",(function(){return At})),n.d(u,"fromQuat",(function(){return St})),n.d(u,"frustum",(function(){return wt})),n.d(u,"perspective",(function(){return Et})),n.d(u,"perspectiveFromFieldOfView",(function(){return Pt})),n.d(u,"ortho",(function(){return Ot})),n.d(u,"lookAt",(function(){return Ct})),n.d(u,"targetTo",(function(){return Rt})),n.d(u,"str",(function(){return It})),n.d(u,"frob",(function(){return Nt})),n.d(u,"add",(function(){return Lt})),n.d(u,"subtract",(function(){return Ft})),n.d(u,"multiplyScalar",(function(){return Dt})),n.d(u,"multiplyScalarAndAdd",(function(){return jt})),n.d(u,"exactEquals",(function(){return Bt})),n.d(u,"equals",(function(){return Ut})),n.d(u,"mul",(function(){return Gt})),n.d(u,"sub",(function(){return Vt}));var s={};n.r(s),n.d(s,"create",(function(){return Ht})),n.d(s,"clone",(function(){return kt})),n.d(s,"length",(function(){return Qt})),n.d(s,"fromValues",(function(){return zt})),n.d(s,"copy",(function(){return Wt})),n.d(s,"set",(function(){return qt})),n.d(s,"add",(function(){return Xt})),n.d(s,"subtract",(function(){return Jt})),n.d(s,"multiply",(function(){return Kt})),n.d(s,"divide",(function(){return Yt})),n.d(s,"ceil",(function(){return Zt})),n.d(s,"floor",(function(){return $t})),n.d(s,"min",(function(){return en})),n.d(s,"max",(function(){return tn})),n.d(s,"round",(function(){return nn})),n.d(s,"scale",(function(){return rn})),n.d(s,"scaleAndAdd",(function(){return on})),n.d(s,"distance",(function(){return an})),n.d(s,"squaredDistance",(function(){return un})),n.d(s,"squaredLength",(function(){return sn})),n.d(s,"negate",(function(){return cn})),n.d(s,"inverse",(function(){return fn})),n.d(s,"normalize",(function(){return ln})),n.d(s,"dot",(function(){return dn})),n.d(s,"cross",(function(){return hn})),n.d(s,"lerp",(function(){return pn})),n.d(s,"hermite",(function(){return _n})),n.d(s,"bezier",(function(){return mn})),n.d(s,"random",(function(){return vn})),n.d(s,"transformMat4",(function(){return gn})),n.d(s,"transformMat3",(function(){return bn})),n.d(s,"transformQuat",(function(){return yn})),n.d(s,"rotateX",(function(){return Mn})),n.d(s,"rotateY",(function(){return xn})),n.d(s,"rotateZ",(function(){return Tn})),n.d(s,"angle",(function(){return An})),n.d(s,"zero",(function(){return Sn})),n.d(s,"str",(function(){return wn})),n.d(s,"exactEquals",(function(){return En})),n.d(s,"equals",(function(){return Pn})),n.d(s,"sub",(function(){return Cn})),n.d(s,"mul",(function(){return Rn})),n.d(s,"div",(function(){return In})),n.d(s,"dist",(function(){return Nn})),n.d(s,"sqrDist",(function(){return Ln})),n.d(s,"len",(function(){return Fn})),n.d(s,"sqrLen",(function(){return Dn})),n.d(s,"forEach",(function(){return jn}));var c={};n.r(c),n.d(c,"create",(function(){return Bn})),n.d(c,"clone",(function(){return Un})),n.d(c,"fromValues",(function(){return Gn})),n.d(c,"copy",(function(){return Vn})),n.d(c,"set",(function(){return Hn})),n.d(c,"add",(function(){return kn})),n.d(c,"subtract",(function(){return Qn})),n.d(c,"multiply",(function(){return zn})),n.d(c,"divide",(function(){return Wn})),n.d(c,"ceil",(function(){return qn})),n.d(c,"floor",(function(){return Xn})),n.d(c,"min",(function(){return Jn})),n.d(c,"max",(function(){return Kn})),n.d(c,"round",(function(){return Yn})),n.d(c,"scale",(function(){return Zn})),n.d(c,"scaleAndAdd",(function(){return $n})),n.d(c,"distance",(function(){return er})),n.d(c,"squaredDistance",(function(){return tr})),n.d(c,"length",(function(){return nr})),n.d(c,"squaredLength",(function(){return rr})),n.d(c,"negate",(function(){return or})),n.d(c,"inverse",(function(){return ir})),n.d(c,"normalize",(function(){return ar})),n.d(c,"dot",(function(){return ur})),n.d(c,"cross",(function(){return sr})),n.d(c,"lerp",(function(){return cr})),n.d(c,"random",(function(){return fr})),n.d(c,"transformMat4",(function(){return lr})),n.d(c,"transformQuat",(function(){return dr})),n.d(c,"zero",(function(){return hr})),n.d(c,"str",(function(){return pr})),n.d(c,"exactEquals",(function(){return _r})),n.d(c,"equals",(function(){return mr})),n.d(c,"sub",(function(){return vr})),n.d(c,"mul",(function(){return gr})),n.d(c,"div",(function(){return br})),n.d(c,"dist",(function(){return yr})),n.d(c,"sqrDist",(function(){return Mr})),n.d(c,"len",(function(){return xr})),n.d(c,"sqrLen",(function(){return Tr})),n.d(c,"forEach",(function(){return Ar}));var f={};n.r(f),n.d(f,"create",(function(){return Sr})),n.d(f,"identity",(function(){return wr})),n.d(f,"setAxisAngle",(function(){return Er})),n.d(f,"getAxisAngle",(function(){return Pr})),n.d(f,"getAngle",(function(){return Or})),n.d(f,"multiply",(function(){return Cr})),n.d(f,"rotateX",(function(){return Rr})),n.d(f,"rotateY",(function(){return Ir})),n.d(f,"rotateZ",(function(){return Nr})),n.d(f,"calculateW",(function(){return Lr})),n.d(f,"exp",(function(){return Fr})),n.d(f,"ln",(function(){return Dr})),n.d(f,"pow",(function(){return jr})),n.d(f,"slerp",(function(){return Br})),n.d(f,"random",(function(){return Ur})),n.d(f,"invert",(function(){return Gr})),n.d(f,"conjugate",(function(){return Vr})),n.d(f,"fromMat3",(function(){return Hr})),n.d(f,"fromEuler",(function(){return kr})),n.d(f,"str",(function(){return Qr})),n.d(f,"clone",(function(){return Yr})),n.d(f,"fromValues",(function(){return Zr})),n.d(f,"copy",(function(){return $r})),n.d(f,"set",(function(){return eo})),n.d(f,"add",(function(){return to})),n.d(f,"mul",(function(){return no})),n.d(f,"scale",(function(){return ro})),n.d(f,"dot",(function(){return oo})),n.d(f,"lerp",(function(){return io})),n.d(f,"length",(function(){return ao})),n.d(f,"len",(function(){return uo})),n.d(f,"squaredLength",(function(){return so})),n.d(f,"sqrLen",(function(){return co})),n.d(f,"normalize",(function(){return fo})),n.d(f,"exactEquals",(function(){return lo})),n.d(f,"equals",(function(){return ho})),n.d(f,"rotationTo",(function(){return po})),n.d(f,"sqlerp",(function(){return _o})),n.d(f,"setAxes",(function(){return mo}));var l={};n.r(l),n.d(l,"create",(function(){return vo})),n.d(l,"clone",(function(){return go})),n.d(l,"fromValues",(function(){return bo})),n.d(l,"fromRotationTranslationValues",(function(){return yo})),n.d(l,"fromRotationTranslation",(function(){return Mo})),n.d(l,"fromTranslation",(function(){return xo})),n.d(l,"fromRotation",(function(){return To})),n.d(l,"fromMat4",(function(){return Ao})),n.d(l,"copy",(function(){return So})),n.d(l,"identity",(function(){return wo})),n.d(l,"set",(function(){return Eo})),n.d(l,"getReal",(function(){return Po})),n.d(l,"getDual",(function(){return Oo})),n.d(l,"setReal",(function(){return Co})),n.d(l,"setDual",(function(){return Ro})),n.d(l,"getTranslation",(function(){return Io})),n.d(l,"translate",(function(){return No})),n.d(l,"rotateX",(function(){return Lo})),n.d(l,"rotateY",(function(){return Fo})),n.d(l,"rotateZ",(function(){return Do})),n.d(l,"rotateByQuatAppend",(function(){return jo})),n.d(l,"rotateByQuatPrepend",(function(){return Bo})),n.d(l,"rotateAroundAxis",(function(){return Uo})),n.d(l,"add",(function(){return Go})),n.d(l,"multiply",(function(){return Vo})),n.d(l,"mul",(function(){return Ho})),n.d(l,"scale",(function(){return ko})),n.d(l,"dot",(function(){return Qo})),n.d(l,"lerp",(function(){return zo})),n.d(l,"invert",(function(){return Wo})),n.d(l,"conjugate",(function(){return qo})),n.d(l,"length",(function(){return Xo})),n.d(l,"len",(function(){return Jo})),n.d(l,"squaredLength",(function(){return Ko})),n.d(l,"sqrLen",(function(){return Yo})),n.d(l,"normalize",(function(){return Zo})),n.d(l,"str",(function(){return $o})),n.d(l,"exactEquals",(function(){return ei})),n.d(l,"equals",(function(){return ti}));var d={};n.r(d),n.d(d,"create",(function(){return ni})),n.d(d,"clone",(function(){return ri})),n.d(d,"fromValues",(function(){return oi})),n.d(d,"copy",(function(){return ii})),n.d(d,"set",(function(){return ai})),n.d(d,"add",(function(){return ui})),n.d(d,"subtract",(function(){return si})),n.d(d,"multiply",(function(){return ci})),n.d(d,"divide",(function(){return fi})),n.d(d,"ceil",(function(){return li})),n.d(d,"floor",(function(){return di})),n.d(d,"min",(function(){return hi})),n.d(d,"max",(function(){return pi})),n.d(d,"round",(function(){return _i})),n.d(d,"scale",(function(){return mi})),n.d(d,"scaleAndAdd",(function(){return vi})),n.d(d,"distance",(function(){return gi})),n.d(d,"squaredDistance",(function(){return bi})),n.d(d,"length",(function(){return yi})),n.d(d,"squaredLength",(function(){return Mi})),n.d(d,"negate",(function(){return xi})),n.d(d,"inverse",(function(){return Ti})),n.d(d,"normalize",(function(){return Ai})),n.d(d,"dot",(function(){return Si})),n.d(d,"cross",(function(){return wi})),n.d(d,"lerp",(function(){return Ei})),n.d(d,"random",(function(){return Pi})),n.d(d,"transformMat2",(function(){return Oi})),n.d(d,"transformMat2d",(function(){return Ci})),n.d(d,"transformMat3",(function(){return Ri})),n.d(d,"transformMat4",(function(){return Ii})),n.d(d,"rotate",(function(){return Ni})),n.d(d,"angle",(function(){return Li})),n.d(d,"zero",(function(){return Fi})),n.d(d,"str",(function(){return Di})),n.d(d,"exactEquals",(function(){return ji})),n.d(d,"equals",(function(){return Bi})),n.d(d,"len",(function(){return Ui})),n.d(d,"sub",(function(){return Gi})),n.d(d,"mul",(function(){return Vi})),n.d(d,"div",(function(){return Hi})),n.d(d,"dist",(function(){return ki})),n.d(d,"sqrDist",(function(){return Qi})),n.d(d,"sqrLen",(function(){return zi})),n.d(d,"forEach",(function(){return Wi}));var h=1e-6,p="undefined"!=typeof Float32Array?Float32Array:Array,_=Math.random;function m(e){p=e}var v=Math.PI/180;function g(e){return e*v}function b(e,t){return Math.abs(e-t)<=h*Math.max(1,Math.abs(e),Math.abs(t))}function y(){var e=new p(4);return p!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function M(e){var t=new p(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function x(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function T(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function A(e,t,n,r){var o=new p(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o}function S(e,t,n,r,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e}function w(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function E(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n*i-o*r;return a?(a=1/a,e[0]=i*a,e[1]=-r*a,e[2]=-o*a,e[3]=n*a,e):null}function P(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e}function O(e){return e[0]*e[3]-e[2]*e[1]}function C(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=n[0],s=n[1],c=n[2],f=n[3];return e[0]=r*u+i*s,e[1]=o*u+a*s,e[2]=r*c+i*f,e[3]=o*c+a*f,e}function R(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s+i*u,e[1]=o*s+a*u,e[2]=r*-u+i*s,e[3]=o*-u+a*s,e}function I(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=n[0],s=n[1];return e[0]=r*u,e[1]=o*u,e[2]=i*s,e[3]=a*s,e}function N(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e}function L(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function F(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function D(e){return Math.hypot(e[0],e[1],e[2],e[3])}function j(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]}function B(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function U(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function G(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function V(e,t){var n=e[0],r=e[1],o=e[2],i=e[3],a=t[0],u=t[1],s=t[2],c=t[3];return Math.abs(n-a)<=h*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=h*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-s)<=h*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=h*Math.max(1,Math.abs(i),Math.abs(c))}function H(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function k(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Q=C,z=U;function W(){var e=new p(6);return p!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function q(e){var t=new p(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function X(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function J(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function K(e,t,n,r,o,i){var a=new p(6);return a[0]=e,a[1]=t,a[2]=n,a[3]=r,a[4]=o,a[5]=i,a}function Y(e,t,n,r,o,i,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=i,e[5]=a,e}function Z(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=n*i-r*o;return s?(s=1/s,e[0]=i*s,e[1]=-r*s,e[2]=-o*s,e[3]=n*s,e[4]=(o*u-i*a)*s,e[5]=(r*a-n*u)*s,e):null}function $(e){return e[0]*e[3]-e[1]*e[2]}function ee(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=n[0],f=n[1],l=n[2],d=n[3],h=n[4],p=n[5];return e[0]=r*c+i*f,e[1]=o*c+a*f,e[2]=r*l+i*d,e[3]=o*l+a*d,e[4]=r*h+i*p+u,e[5]=o*h+a*p+s,e}function te(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=Math.sin(n),f=Math.cos(n);return e[0]=r*f+i*c,e[1]=o*f+a*c,e[2]=r*-c+i*f,e[3]=o*-c+a*f,e[4]=u,e[5]=s,e}function ne(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=n[0],f=n[1];return e[0]=r*c,e[1]=o*c,e[2]=i*f,e[3]=a*f,e[4]=u,e[5]=s,e}function re(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=n[0],f=n[1];return e[0]=r,e[1]=o,e[2]=i,e[3]=a,e[4]=r*c+i*f+u,e[5]=o*c+a*f+s,e}function oe(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e[4]=0,e[5]=0,e}function ie(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function ae(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function ue(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function se(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function ce(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e}function fe(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}function le(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e}function de(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e}function he(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function pe(e,t){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=t[0],c=t[1],f=t[2],l=t[3],d=t[4],p=t[5];return Math.abs(n-s)<=h*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=h*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-f)<=h*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-l)<=h*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-d)<=h*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-p)<=h*Math.max(1,Math.abs(u),Math.abs(p))}var _e=ee,me=fe;function ve(){var e=new p(9);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function ge(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function be(e){var t=new p(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function ye(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Me(e,t,n,r,o,i,a,u,s){var c=new p(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=o,c[5]=i,c[6]=a,c[7]=u,c[8]=s,c}function xe(e,t,n,r,o,i,a,u,s,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=i,e[5]=a,e[6]=u,e[7]=s,e[8]=c,e}function Te(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ae(e,t){if(e===t){var n=t[1],r=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Se(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=f*a-u*c,d=-f*i+u*s,h=c*i-a*s,p=n*l+r*d+o*h;return p?(p=1/p,e[0]=l*p,e[1]=(-f*r+o*c)*p,e[2]=(u*r-o*a)*p,e[3]=d*p,e[4]=(f*n-o*s)*p,e[5]=(-u*n+o*i)*p,e[6]=h*p,e[7]=(-c*n+r*s)*p,e[8]=(a*n-r*i)*p,e):null}function we(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8];return e[0]=a*f-u*c,e[1]=o*c-r*f,e[2]=r*u-o*a,e[3]=u*s-i*f,e[4]=n*f-o*s,e[5]=o*i-n*u,e[6]=i*c-a*s,e[7]=r*s-n*c,e[8]=n*a-r*i,e}function Ee(e){var t=e[0],n=e[1],r=e[2],o=e[3],i=e[4],a=e[5],u=e[6],s=e[7],c=e[8];return t*(c*i-a*s)+n*(-c*o+a*u)+r*(s*o-i*u)}function Pe(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=t[8],d=n[0],h=n[1],p=n[2],_=n[3],m=n[4],v=n[5],g=n[6],b=n[7],y=n[8];return e[0]=d*r+h*a+p*c,e[1]=d*o+h*u+p*f,e[2]=d*i+h*s+p*l,e[3]=_*r+m*a+v*c,e[4]=_*o+m*u+v*f,e[5]=_*i+m*s+v*l,e[6]=g*r+b*a+y*c,e[7]=g*o+b*u+y*f,e[8]=g*i+b*s+y*l,e}function Oe(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=t[8],d=n[0],h=n[1];return e[0]=r,e[1]=o,e[2]=i,e[3]=a,e[4]=u,e[5]=s,e[6]=d*r+h*a+c,e[7]=d*o+h*u+f,e[8]=d*i+h*s+l,e}function Ce(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=t[8],d=Math.sin(n),h=Math.cos(n);return e[0]=h*r+d*a,e[1]=h*o+d*u,e[2]=h*i+d*s,e[3]=h*a-d*r,e[4]=h*u-d*o,e[5]=h*s-d*i,e[6]=c,e[7]=f,e[8]=l,e}function Re(e,t,n){var r=n[0],o=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Ie(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Ne(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Le(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Fe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function De(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n+n,u=r+r,s=o+o,c=n*a,f=r*a,l=r*u,d=o*a,h=o*u,p=o*s,_=i*a,m=i*u,v=i*s;return e[0]=1-l-p,e[3]=f-v,e[6]=d+m,e[1]=f+v,e[4]=1-c-p,e[7]=h-_,e[2]=d-m,e[5]=h+_,e[8]=1-c-l,e}function je(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],d=t[10],h=t[11],p=t[12],_=t[13],m=t[14],v=t[15],g=n*u-r*a,b=n*s-o*a,y=n*c-i*a,M=r*s-o*u,x=r*c-i*u,T=o*c-i*s,A=f*_-l*p,S=f*m-d*p,w=f*v-h*p,E=l*m-d*_,P=l*v-h*_,O=d*v-h*m,C=g*O-b*P+y*E+M*w-x*S+T*A;return C?(C=1/C,e[0]=(u*O-s*P+c*E)*C,e[1]=(s*w-a*O-c*S)*C,e[2]=(a*P-u*w+c*A)*C,e[3]=(o*P-r*O-i*E)*C,e[4]=(n*O-o*w+i*S)*C,e[5]=(r*w-n*P-i*A)*C,e[6]=(_*T-m*x+v*M)*C,e[7]=(m*y-p*T-v*b)*C,e[8]=(p*x-_*y+v*g)*C,e):null}function Be(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Ue(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Ge(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Ve(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function He(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function ke(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function Qe(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function ze(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function We(e,t){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=t[0],d=t[1],p=t[2],_=t[3],m=t[4],v=t[5],g=t[6],b=t[7],y=t[8];return Math.abs(n-l)<=h*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-d)<=h*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(o-p)<=h*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(i-_)<=h*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(a-m)<=h*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(u-v)<=h*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(s-g)<=h*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-b)<=h*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(f-y)<=h*Math.max(1,Math.abs(f),Math.abs(y))}var qe=Pe,Xe=He;function Je(){var e=new p(16);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ke(e){var t=new p(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ye(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ze(e,t,n,r,o,i,a,u,s,c,f,l,d,h,_,m){var v=new p(16);return v[0]=e,v[1]=t,v[2]=n,v[3]=r,v[4]=o,v[5]=i,v[6]=a,v[7]=u,v[8]=s,v[9]=c,v[10]=f,v[11]=l,v[12]=d,v[13]=h,v[14]=_,v[15]=m,v}function $e(e,t,n,r,o,i,a,u,s,c,f,l,d,h,p,_,m){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=i,e[5]=a,e[6]=u,e[7]=s,e[8]=c,e[9]=f,e[10]=l,e[11]=d,e[12]=h,e[13]=p,e[14]=_,e[15]=m,e}function et(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function tt(e,t){if(e===t){var n=t[1],r=t[2],o=t[3],i=t[6],a=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=i,e[11]=t[14],e[12]=o,e[13]=a,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function nt(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],d=t[10],h=t[11],p=t[12],_=t[13],m=t[14],v=t[15],g=n*u-r*a,b=n*s-o*a,y=n*c-i*a,M=r*s-o*u,x=r*c-i*u,T=o*c-i*s,A=f*_-l*p,S=f*m-d*p,w=f*v-h*p,E=l*m-d*_,P=l*v-h*_,O=d*v-h*m,C=g*O-b*P+y*E+M*w-x*S+T*A;return C?(C=1/C,e[0]=(u*O-s*P+c*E)*C,e[1]=(o*P-r*O-i*E)*C,e[2]=(_*T-m*x+v*M)*C,e[3]=(d*x-l*T-h*M)*C,e[4]=(s*w-a*O-c*S)*C,e[5]=(n*O-o*w+i*S)*C,e[6]=(m*y-p*T-v*b)*C,e[7]=(f*T-d*y+h*b)*C,e[8]=(a*P-u*w+c*A)*C,e[9]=(r*w-n*P-i*A)*C,e[10]=(p*x-_*y+v*g)*C,e[11]=(l*y-f*x-h*g)*C,e[12]=(u*S-a*E-s*A)*C,e[13]=(n*E-r*S+o*A)*C,e[14]=(_*b-p*M-m*g)*C,e[15]=(f*M-l*b+d*g)*C,e):null}function rt(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],d=t[10],h=t[11],p=t[12],_=t[13],m=t[14],v=t[15];return e[0]=u*(d*v-h*m)-l*(s*v-c*m)+_*(s*h-c*d),e[1]=-(r*(d*v-h*m)-l*(o*v-i*m)+_*(o*h-i*d)),e[2]=r*(s*v-c*m)-u*(o*v-i*m)+_*(o*c-i*s),e[3]=-(r*(s*h-c*d)-u*(o*h-i*d)+l*(o*c-i*s)),e[4]=-(a*(d*v-h*m)-f*(s*v-c*m)+p*(s*h-c*d)),e[5]=n*(d*v-h*m)-f*(o*v-i*m)+p*(o*h-i*d),e[6]=-(n*(s*v-c*m)-a*(o*v-i*m)+p*(o*c-i*s)),e[7]=n*(s*h-c*d)-a*(o*h-i*d)+f*(o*c-i*s),e[8]=a*(l*v-h*_)-f*(u*v-c*_)+p*(u*h-c*l),e[9]=-(n*(l*v-h*_)-f*(r*v-i*_)+p*(r*h-i*l)),e[10]=n*(u*v-c*_)-a*(r*v-i*_)+p*(r*c-i*u),e[11]=-(n*(u*h-c*l)-a*(r*h-i*l)+f*(r*c-i*u)),e[12]=-(a*(l*m-d*_)-f*(u*m-s*_)+p*(u*d-s*l)),e[13]=n*(l*m-d*_)-f*(r*m-o*_)+p*(r*d-o*l),e[14]=-(n*(u*m-s*_)-a*(r*m-o*_)+p*(r*s-o*u)),e[15]=n*(u*d-s*l)-a*(r*d-o*l)+f*(r*s-o*u),e}function ot(e){var t=e[0],n=e[1],r=e[2],o=e[3],i=e[4],a=e[5],u=e[6],s=e[7],c=e[8],f=e[9],l=e[10],d=e[11],h=e[12],p=e[13],_=e[14],m=e[15];return(t*a-n*i)*(l*m-d*_)-(t*u-r*i)*(f*m-d*p)+(t*s-o*i)*(f*_-l*p)+(n*u-r*a)*(c*m-d*h)-(n*s-o*a)*(c*_-l*h)+(r*s-o*u)*(c*p-f*h)}function it(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=t[8],d=t[9],h=t[10],p=t[11],_=t[12],m=t[13],v=t[14],g=t[15],b=n[0],y=n[1],M=n[2],x=n[3];return e[0]=b*r+y*u+M*l+x*_,e[1]=b*o+y*s+M*d+x*m,e[2]=b*i+y*c+M*h+x*v,e[3]=b*a+y*f+M*p+x*g,b=n[4],y=n[5],M=n[6],x=n[7],e[4]=b*r+y*u+M*l+x*_,e[5]=b*o+y*s+M*d+x*m,e[6]=b*i+y*c+M*h+x*v,e[7]=b*a+y*f+M*p+x*g,b=n[8],y=n[9],M=n[10],x=n[11],e[8]=b*r+y*u+M*l+x*_,e[9]=b*o+y*s+M*d+x*m,e[10]=b*i+y*c+M*h+x*v,e[11]=b*a+y*f+M*p+x*g,b=n[12],y=n[13],M=n[14],x=n[15],e[12]=b*r+y*u+M*l+x*_,e[13]=b*o+y*s+M*d+x*m,e[14]=b*i+y*c+M*h+x*v,e[15]=b*a+y*f+M*p+x*g,e}function at(e,t,n){var r,o,i,a,u,s,c,f,l,d,h,p,_=n[0],m=n[1],v=n[2];return t===e?(e[12]=t[0]*_+t[4]*m+t[8]*v+t[12],e[13]=t[1]*_+t[5]*m+t[9]*v+t[13],e[14]=t[2]*_+t[6]*m+t[10]*v+t[14],e[15]=t[3]*_+t[7]*m+t[11]*v+t[15]):(r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=t[8],d=t[9],h=t[10],p=t[11],e[0]=r,e[1]=o,e[2]=i,e[3]=a,e[4]=u,e[5]=s,e[6]=c,e[7]=f,e[8]=l,e[9]=d,e[10]=h,e[11]=p,e[12]=r*_+u*m+l*v+t[12],e[13]=o*_+s*m+d*v+t[13],e[14]=i*_+c*m+h*v+t[14],e[15]=a*_+f*m+p*v+t[15]),e}function ut(e,t,n){var r=n[0],o=n[1],i=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function st(e,t,n,r){var o,i,a,u,s,c,f,l,d,p,_,m,v,g,b,y,M,x,T,A,S,w,E,P,O=r[0],C=r[1],R=r[2],I=Math.hypot(O,C,R);return I<h?null:(O*=I=1/I,C*=I,R*=I,o=Math.sin(n),a=1-(i=Math.cos(n)),u=t[0],s=t[1],c=t[2],f=t[3],l=t[4],d=t[5],p=t[6],_=t[7],m=t[8],v=t[9],g=t[10],b=t[11],y=O*O*a+i,M=C*O*a+R*o,x=R*O*a-C*o,T=O*C*a-R*o,A=C*C*a+i,S=R*C*a+O*o,w=O*R*a+C*o,E=C*R*a-O*o,P=R*R*a+i,e[0]=u*y+l*M+m*x,e[1]=s*y+d*M+v*x,e[2]=c*y+p*M+g*x,e[3]=f*y+_*M+b*x,e[4]=u*T+l*A+m*S,e[5]=s*T+d*A+v*S,e[6]=c*T+p*A+g*S,e[7]=f*T+_*A+b*S,e[8]=u*w+l*E+m*P,e[9]=s*w+d*E+v*P,e[10]=c*w+p*E+g*P,e[11]=f*w+_*E+b*P,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ct(e,t,n){var r=Math.sin(n),o=Math.cos(n),i=t[4],a=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*o+c*r,e[5]=a*o+f*r,e[6]=u*o+l*r,e[7]=s*o+d*r,e[8]=c*o-i*r,e[9]=f*o-a*r,e[10]=l*o-u*r,e[11]=d*o-s*r,e}function ft(e,t,n){var r=Math.sin(n),o=Math.cos(n),i=t[0],a=t[1],u=t[2],s=t[3],c=t[8],f=t[9],l=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o-c*r,e[1]=a*o-f*r,e[2]=u*o-l*r,e[3]=s*o-d*r,e[8]=i*r+c*o,e[9]=a*r+f*o,e[10]=u*r+l*o,e[11]=s*r+d*o,e}function lt(e,t,n){var r=Math.sin(n),o=Math.cos(n),i=t[0],a=t[1],u=t[2],s=t[3],c=t[4],f=t[5],l=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o+c*r,e[1]=a*o+f*r,e[2]=u*o+l*r,e[3]=s*o+d*r,e[4]=c*o-i*r,e[5]=f*o-a*r,e[6]=l*o-u*r,e[7]=d*o-s*r,e}function dt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function ht(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pt(e,t,n){var r,o,i,a=n[0],u=n[1],s=n[2],c=Math.hypot(a,u,s);return c<h?null:(a*=c=1/c,u*=c,s*=c,r=Math.sin(t),i=1-(o=Math.cos(t)),e[0]=a*a*i+o,e[1]=u*a*i+s*r,e[2]=s*a*i-u*r,e[3]=0,e[4]=a*u*i-s*r,e[5]=u*u*i+o,e[6]=s*u*i+a*r,e[7]=0,e[8]=a*s*i+u*r,e[9]=u*s*i-a*r,e[10]=s*s*i+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function _t(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mt(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function vt(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function gt(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=r+r,s=o+o,c=i+i,f=r*u,l=r*s,d=r*c,h=o*s,p=o*c,_=i*c,m=a*u,v=a*s,g=a*c;return e[0]=1-(h+_),e[1]=l+g,e[2]=d-v,e[3]=0,e[4]=l-g,e[5]=1-(f+_),e[6]=p+m,e[7]=0,e[8]=d+v,e[9]=p-m,e[10]=1-(f+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function bt(e,t){var n=new p(3),r=-t[0],o=-t[1],i=-t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=r*r+o*o+i*i+a*a;return l>0?(n[0]=2*(u*a+f*r+s*i-c*o)/l,n[1]=2*(s*a+f*o+c*r-u*i)/l,n[2]=2*(c*a+f*i+u*o-s*r)/l):(n[0]=2*(u*a+f*r+s*i-c*o),n[1]=2*(s*a+f*o+c*r-u*i),n[2]=2*(c*a+f*i+u*o-s*r)),gt(e,t,n),e}function yt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Mt(e,t){var n=t[0],r=t[1],o=t[2],i=t[4],a=t[5],u=t[6],s=t[8],c=t[9],f=t[10];return e[0]=Math.hypot(n,r,o),e[1]=Math.hypot(i,a,u),e[2]=Math.hypot(s,c,f),e}function xt(e,t){var n=new p(3);Mt(n,t);var r=1/n[0],o=1/n[1],i=1/n[2],a=t[0]*r,u=t[1]*o,s=t[2]*i,c=t[4]*r,f=t[5]*o,l=t[6]*i,d=t[8]*r,h=t[9]*o,_=t[10]*i,m=a+f+_,v=0;return m>0?(v=2*Math.sqrt(m+1),e[3]=.25*v,e[0]=(l-h)/v,e[1]=(d-s)/v,e[2]=(u-c)/v):a>f&&a>_?(v=2*Math.sqrt(1+a-f-_),e[3]=(l-h)/v,e[0]=.25*v,e[1]=(u+c)/v,e[2]=(d+s)/v):f>_?(v=2*Math.sqrt(1+f-a-_),e[3]=(d-s)/v,e[0]=(u+c)/v,e[1]=.25*v,e[2]=(l+h)/v):(v=2*Math.sqrt(1+_-a-f),e[3]=(u-c)/v,e[0]=(d+s)/v,e[1]=(l+h)/v,e[2]=.25*v),e}function Tt(e,t,n,r){var o=t[0],i=t[1],a=t[2],u=t[3],s=o+o,c=i+i,f=a+a,l=o*s,d=o*c,h=o*f,p=i*c,_=i*f,m=a*f,v=u*s,g=u*c,b=u*f,y=r[0],M=r[1],x=r[2];return e[0]=(1-(p+m))*y,e[1]=(d+b)*y,e[2]=(h-g)*y,e[3]=0,e[4]=(d-b)*M,e[5]=(1-(l+m))*M,e[6]=(_+v)*M,e[7]=0,e[8]=(h+g)*x,e[9]=(_-v)*x,e[10]=(1-(l+p))*x,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function At(e,t,n,r,o){var i=t[0],a=t[1],u=t[2],s=t[3],c=i+i,f=a+a,l=u+u,d=i*c,h=i*f,p=i*l,_=a*f,m=a*l,v=u*l,g=s*c,b=s*f,y=s*l,M=r[0],x=r[1],T=r[2],A=o[0],S=o[1],w=o[2],E=(1-(_+v))*M,P=(h+y)*M,O=(p-b)*M,C=(h-y)*x,R=(1-(d+v))*x,I=(m+g)*x,N=(p+b)*T,L=(m-g)*T,F=(1-(d+_))*T;return e[0]=E,e[1]=P,e[2]=O,e[3]=0,e[4]=C,e[5]=R,e[6]=I,e[7]=0,e[8]=N,e[9]=L,e[10]=F,e[11]=0,e[12]=n[0]+A-(E*A+C*S+N*w),e[13]=n[1]+S-(P*A+R*S+L*w),e[14]=n[2]+w-(O*A+I*S+F*w),e[15]=1,e}function St(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n+n,u=r+r,s=o+o,c=n*a,f=r*a,l=r*u,d=o*a,h=o*u,p=o*s,_=i*a,m=i*u,v=i*s;return e[0]=1-l-p,e[1]=f+v,e[2]=d-m,e[3]=0,e[4]=f-v,e[5]=1-c-p,e[6]=h+_,e[7]=0,e[8]=d+m,e[9]=h-_,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wt(e,t,n,r,o,i,a){var u=1/(n-t),s=1/(o-r),c=1/(i-a);return e[0]=2*i*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*s,e[6]=0,e[7]=0,e[8]=(n+t)*u,e[9]=(o+r)*s,e[10]=(a+i)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*i*2*c,e[15]=0,e}function Et(e,t,n,r,o){var i,a=1/Math.tan(t/2);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0?(i=1/(r-o),e[10]=(o+r)*i,e[14]=2*o*r*i):(e[10]=-1,e[14]=-2*r),e}function Pt(e,t,n,r){var o=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(o+i);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-u)*s*.5,e[9]=(o-i)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function Ot(e,t,n,r,o,i,a){var u=1/(t-n),s=1/(r-o),c=1/(i-a);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*u,e[13]=(o+r)*s,e[14]=(a+i)*c,e[15]=1,e}function Ct(e,t,n,r){var o,i,a,u,s,c,f,l,d,p,_=t[0],m=t[1],v=t[2],g=r[0],b=r[1],y=r[2],M=n[0],x=n[1],T=n[2];return Math.abs(_-M)<h&&Math.abs(m-x)<h&&Math.abs(v-T)<h?et(e):(f=_-M,l=m-x,d=v-T,o=b*(d*=p=1/Math.hypot(f,l,d))-y*(l*=p),i=y*(f*=p)-g*d,a=g*l-b*f,(p=Math.hypot(o,i,a))?(o*=p=1/p,i*=p,a*=p):(o=0,i=0,a=0),u=l*a-d*i,s=d*o-f*a,c=f*i-l*o,(p=Math.hypot(u,s,c))?(u*=p=1/p,s*=p,c*=p):(u=0,s=0,c=0),e[0]=o,e[1]=u,e[2]=f,e[3]=0,e[4]=i,e[5]=s,e[6]=l,e[7]=0,e[8]=a,e[9]=c,e[10]=d,e[11]=0,e[12]=-(o*_+i*m+a*v),e[13]=-(u*_+s*m+c*v),e[14]=-(f*_+l*m+d*v),e[15]=1,e)}function Rt(e,t,n,r){var o=t[0],i=t[1],a=t[2],u=r[0],s=r[1],c=r[2],f=o-n[0],l=i-n[1],d=a-n[2],h=f*f+l*l+d*d;h>0&&(f*=h=1/Math.sqrt(h),l*=h,d*=h);var p=s*d-c*l,_=c*f-u*d,m=u*l-s*f;return(h=p*p+_*_+m*m)>0&&(p*=h=1/Math.sqrt(h),_*=h,m*=h),e[0]=p,e[1]=_,e[2]=m,e[3]=0,e[4]=l*m-d*_,e[5]=d*p-f*m,e[6]=f*_-l*p,e[7]=0,e[8]=f,e[9]=l,e[10]=d,e[11]=0,e[12]=o,e[13]=i,e[14]=a,e[15]=1,e}function It(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Nt(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Lt(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function Ft(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function Dt(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function jt(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function Bt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Ut(e,t){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],d=e[10],p=e[11],_=e[12],m=e[13],v=e[14],g=e[15],b=t[0],y=t[1],M=t[2],x=t[3],T=t[4],A=t[5],S=t[6],w=t[7],E=t[8],P=t[9],O=t[10],C=t[11],R=t[12],I=t[13],N=t[14],L=t[15];return Math.abs(n-b)<=h*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-y)<=h*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(o-M)<=h*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(i-x)<=h*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-T)<=h*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(u-A)<=h*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(s-S)<=h*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(c-w)<=h*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(f-E)<=h*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(l-P)<=h*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(d-O)<=h*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(p-C)<=h*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(_-R)<=h*Math.max(1,Math.abs(_),Math.abs(R))&&Math.abs(m-I)<=h*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(v-N)<=h*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(g-L)<=h*Math.max(1,Math.abs(g),Math.abs(L))}var Gt=it,Vt=Ft;function Ht(){var e=new p(3);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function kt(e){var t=new p(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Qt(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function zt(e,t,n){var r=new p(3);return r[0]=e,r[1]=t,r[2]=n,r}function Wt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function qt(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function Xt(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Jt(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function Kt(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function Yt(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function Zt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function $t(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function en(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function tn(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function nn(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function rn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function on(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function an(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return Math.hypot(n,r,o)}function un(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return n*n+r*r+o*o}function sn(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function cn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function fn(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function ln(e,t){var n=t[0],r=t[1],o=t[2],i=n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function dn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function hn(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[0],u=n[1],s=n[2];return e[0]=o*s-i*u,e[1]=i*a-r*s,e[2]=r*u-o*a,e}function pn(e,t,n,r){var o=t[0],i=t[1],a=t[2];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e[2]=a+r*(n[2]-a),e}function _n(e,t,n,r,o,i){var a=i*i,u=a*(2*i-3)+1,s=a*(i-2)+i,c=a*(i-1),f=a*(3-2*i);return e[0]=t[0]*u+n[0]*s+r[0]*c+o[0]*f,e[1]=t[1]*u+n[1]*s+r[1]*c+o[1]*f,e[2]=t[2]*u+n[2]*s+r[2]*c+o[2]*f,e}function mn(e,t,n,r,o,i){var a=1-i,u=a*a,s=i*i,c=u*a,f=3*i*u,l=3*s*a,d=s*i;return e[0]=t[0]*c+n[0]*f+r[0]*l+o[0]*d,e[1]=t[1]*c+n[1]*f+r[1]*l+o[1]*d,e[2]=t[2]*c+n[2]*f+r[2]*l+o[2]*d,e}function vn(e,t){t=t||1;var n=2*_()*Math.PI,r=2*_()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=r*t,e}function gn(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[3]*r+n[7]*o+n[11]*i+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/a,e[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/a,e[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/a,e}function bn(e,t,n){var r=t[0],o=t[1],i=t[2];return e[0]=r*n[0]+o*n[3]+i*n[6],e[1]=r*n[1]+o*n[4]+i*n[7],e[2]=r*n[2]+o*n[5]+i*n[8],e}function yn(e,t,n){var r=n[0],o=n[1],i=n[2],a=n[3],u=t[0],s=t[1],c=t[2],f=o*c-i*s,l=i*u-r*c,d=r*s-o*u,h=o*d-i*l,p=i*f-r*d,_=r*l-o*f,m=2*a;return f*=m,l*=m,d*=m,h*=2,p*=2,_*=2,e[0]=u+f+h,e[1]=s+l+p,e[2]=c+d+_,e}function Mn(e,t,n,r){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[0],i[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),i[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function xn(e,t,n,r){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),i[1]=o[1],i[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function Tn(e,t,n,r){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),i[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),i[2]=o[2],e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function An(e,t){var n=e[0],r=e[1],o=e[2],i=t[0],a=t[1],u=t[2],s=Math.sqrt(n*n+r*r+o*o)*Math.sqrt(i*i+a*a+u*u),c=s&&dn(e,t)/s;return Math.acos(Math.min(Math.max(c,-1),1))}function Sn(e){return e[0]=0,e[1]=0,e[2]=0,e}function wn(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function En(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Pn(e,t){var n=e[0],r=e[1],o=e[2],i=t[0],a=t[1],u=t[2];return Math.abs(n-i)<=h*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-a)<=h*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(o-u)<=h*Math.max(1,Math.abs(o),Math.abs(u))}var On,Cn=Jt,Rn=Kt,In=Yt,Nn=an,Ln=un,Fn=Qt,Dn=sn,jn=(On=Ht(),function(e,t,n,r,o,i){var a,u;for(t||(t=3),n||(n=0),u=r?Math.min(r*t+n,e.length):e.length,a=n;a<u;a+=t)On[0]=e[a],On[1]=e[a+1],On[2]=e[a+2],o(On,On,i),e[a]=On[0],e[a+1]=On[1],e[a+2]=On[2];return e});function Bn(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Un(e){var t=new p(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Gn(e,t,n,r){var o=new p(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o}function Vn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Hn(e,t,n,r,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e}function kn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function Qn(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function zn(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function Wn(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function qn(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Xn(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Jn(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function Kn(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function Yn(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Zn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function $n(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function er(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],i=t[3]-e[3];return Math.hypot(n,r,o,i)}function tr(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],i=t[3]-e[3];return n*n+r*r+o*o+i*i}function nr(e){var t=e[0],n=e[1],r=e[2],o=e[3];return Math.hypot(t,n,r,o)}function rr(e){var t=e[0],n=e[1],r=e[2],o=e[3];return t*t+n*n+r*r+o*o}function or(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function ir(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function ar(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n*n+r*r+o*o+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=r*a,e[2]=o*a,e[3]=i*a,e}function ur(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function sr(e,t,n,r){var o=n[0]*r[1]-n[1]*r[0],i=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],u=n[1]*r[2]-n[2]*r[1],s=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],f=t[0],l=t[1],d=t[2],h=t[3];return e[0]=l*c-d*s+h*u,e[1]=-f*c+d*a-h*i,e[2]=f*s-l*a+h*o,e[3]=-f*u+l*i-d*o,e}function cr(e,t,n,r){var o=t[0],i=t[1],a=t[2],u=t[3];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e[2]=a+r*(n[2]-a),e[3]=u+r*(n[3]-u),e}function fr(e,t){var n,r,o,i,a,u;t=t||1;do{a=(n=2*_()-1)*n+(r=2*_()-1)*r}while(a>=1);do{u=(o=2*_()-1)*o+(i=2*_()-1)*i}while(u>=1);var s=Math.sqrt((1-a)/u);return e[0]=t*n,e[1]=t*r,e[2]=t*o*s,e[3]=t*i*s,e}function lr(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3];return e[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*a,e[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*a,e[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*a,e[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*a,e}function dr(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[0],u=n[1],s=n[2],c=n[3],f=c*r+u*i-s*o,l=c*o+s*r-a*i,d=c*i+a*o-u*r,h=-a*r-u*o-s*i;return e[0]=f*c+h*-a+l*-s-d*-u,e[1]=l*c+h*-u+d*-a-f*-s,e[2]=d*c+h*-s+f*-u-l*-a,e[3]=t[3],e}function hr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function pr(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function _r(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function mr(e,t){var n=e[0],r=e[1],o=e[2],i=e[3],a=t[0],u=t[1],s=t[2],c=t[3];return Math.abs(n-a)<=h*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=h*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-s)<=h*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=h*Math.max(1,Math.abs(i),Math.abs(c))}var vr=Qn,gr=zn,br=Wn,yr=er,Mr=tr,xr=nr,Tr=rr,Ar=function(){var e=Bn();return function(t,n,r,o,i,a){var u,s;for(n||(n=4),r||(r=0),s=o?Math.min(o*n+r,t.length):t.length,u=r;u<s;u+=n)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],i(e,e,a),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}}();function Sr(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function wr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Er(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Pr(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>h?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function Or(e,t){var n=oo(e,t);return Math.acos(2*n*n-1)}function Cr(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=n[0],s=n[1],c=n[2],f=n[3];return e[0]=r*f+a*u+o*c-i*s,e[1]=o*f+a*s+i*u-r*c,e[2]=i*f+a*c+r*s-o*u,e[3]=a*f-r*u-o*s-i*c,e}function Rr(e,t,n){n*=.5;var r=t[0],o=t[1],i=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s+a*u,e[1]=o*s+i*u,e[2]=i*s-o*u,e[3]=a*s-r*u,e}function Ir(e,t,n){n*=.5;var r=t[0],o=t[1],i=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s-i*u,e[1]=o*s+a*u,e[2]=i*s+r*u,e[3]=a*s-o*u,e}function Nr(e,t,n){n*=.5;var r=t[0],o=t[1],i=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s+o*u,e[1]=o*s-r*u,e[2]=i*s+a*u,e[3]=a*s-i*u,e}function Lr(e,t){var n=t[0],r=t[1],o=t[2];return e[0]=n,e[1]=r,e[2]=o,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),e}function Fr(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=Math.sqrt(n*n+r*r+o*o),u=Math.exp(i),s=a>0?u*Math.sin(a)/a:0;return e[0]=n*s,e[1]=r*s,e[2]=o*s,e[3]=u*Math.cos(a),e}function Dr(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=Math.sqrt(n*n+r*r+o*o),u=a>0?Math.atan2(a,i)/a:0;return e[0]=n*u,e[1]=r*u,e[2]=o*u,e[3]=.5*Math.log(n*n+r*r+o*o+i*i),e}function jr(e,t,n){return Dr(e,t),ro(e,e,n),Fr(e,e),e}function Br(e,t,n,r){var o,i,a,u,s,c=t[0],f=t[1],l=t[2],d=t[3],p=n[0],_=n[1],m=n[2],v=n[3];return(i=c*p+f*_+l*m+d*v)<0&&(i=-i,p=-p,_=-_,m=-m,v=-v),1-i>h?(o=Math.acos(i),a=Math.sin(o),u=Math.sin((1-r)*o)/a,s=Math.sin(r*o)/a):(u=1-r,s=r),e[0]=u*c+s*p,e[1]=u*f+s*_,e[2]=u*l+s*m,e[3]=u*d+s*v,e}function Ur(e){var t=_(),n=_(),r=_(),o=Math.sqrt(1-t),i=Math.sqrt(t);return e[0]=o*Math.sin(2*Math.PI*n),e[1]=o*Math.cos(2*Math.PI*n),e[2]=i*Math.sin(2*Math.PI*r),e[3]=i*Math.cos(2*Math.PI*r),e}function Gr(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n*n+r*r+o*o+i*i,u=a?1/a:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-o*u,e[3]=i*u,e}function Vr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Hr(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var o=0;t[4]>t[0]&&(o=1),t[8]>t[3*o+o]&&(o=2);var i=(o+1)%3,a=(o+2)%3;n=Math.sqrt(t[3*o+o]-t[3*i+i]-t[3*a+a]+1),e[o]=.5*n,n=.5/n,e[3]=(t[3*i+a]-t[3*a+i])*n,e[i]=(t[3*i+o]+t[3*o+i])*n,e[a]=(t[3*a+o]+t[3*o+a])*n}return e}function kr(e,t,n,r){var o=.5*Math.PI/180;t*=o,n*=o,r*=o;var i=Math.sin(t),a=Math.cos(t),u=Math.sin(n),s=Math.cos(n),c=Math.sin(r),f=Math.cos(r);return e[0]=i*s*f-a*u*c,e[1]=a*u*f+i*s*c,e[2]=a*s*c-i*u*f,e[3]=a*s*f+i*u*c,e}function Qr(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var zr,Wr,qr,Xr,Jr,Kr,Yr=Un,Zr=Gn,$r=Vn,eo=Hn,to=kn,no=Cr,ro=Zn,oo=ur,io=cr,ao=nr,uo=ao,so=rr,co=so,fo=ar,lo=_r,ho=mr,po=(zr=Ht(),Wr=zt(1,0,0),qr=zt(0,1,0),function(e,t,n){var r=dn(t,n);return r<-.999999?(hn(zr,Wr,t),Fn(zr)<1e-6&&hn(zr,qr,t),ln(zr,zr),Er(e,zr,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(hn(zr,t,n),e[0]=zr[0],e[1]=zr[1],e[2]=zr[2],e[3]=1+r,fo(e,e))}),_o=(Xr=Sr(),Jr=Sr(),function(e,t,n,r,o,i){return Br(Xr,t,o,i),Br(Jr,n,r,i),Br(e,Xr,Jr,2*i*(1-i)),e}),mo=(Kr=ve(),function(e,t,n,r){return Kr[0]=n[0],Kr[3]=n[1],Kr[6]=n[2],Kr[1]=r[0],Kr[4]=r[1],Kr[7]=r[2],Kr[2]=-t[0],Kr[5]=-t[1],Kr[8]=-t[2],fo(e,Hr(e,Kr))});function vo(){var e=new p(8);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function go(e){var t=new p(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function bo(e,t,n,r,o,i,a,u){var s=new p(8);return s[0]=e,s[1]=t,s[2]=n,s[3]=r,s[4]=o,s[5]=i,s[6]=a,s[7]=u,s}function yo(e,t,n,r,o,i,a){var u=new p(8);u[0]=e,u[1]=t,u[2]=n,u[3]=r;var s=.5*o,c=.5*i,f=.5*a;return u[4]=s*r+c*n-f*t,u[5]=c*r+f*e-s*n,u[6]=f*r+s*t-c*e,u[7]=-s*e-c*t-f*n,u}function Mo(e,t,n){var r=.5*n[0],o=.5*n[1],i=.5*n[2],a=t[0],u=t[1],s=t[2],c=t[3];return e[0]=a,e[1]=u,e[2]=s,e[3]=c,e[4]=r*c+o*s-i*u,e[5]=o*c+i*a-r*s,e[6]=i*c+r*u-o*a,e[7]=-r*a-o*u-i*s,e}function xo(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e}function To(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Ao(e,t){var n=Sr();xt(n,t);var r=new p(3);return yt(r,t),Mo(e,n,r),e}function So(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function wo(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Eo(e,t,n,r,o,i,a,u,s){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=i,e[5]=a,e[6]=u,e[7]=s,e}var Po=$r;function Oo(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}var Co=$r;function Ro(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function Io(e,t){var n=t[4],r=t[5],o=t[6],i=t[7],a=-t[0],u=-t[1],s=-t[2],c=t[3];return e[0]=2*(n*c+i*a+r*s-o*u),e[1]=2*(r*c+i*u+o*a-n*s),e[2]=2*(o*c+i*s+n*u-r*a),e}function No(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=.5*n[0],s=.5*n[1],c=.5*n[2],f=t[4],l=t[5],d=t[6],h=t[7];return e[0]=r,e[1]=o,e[2]=i,e[3]=a,e[4]=a*u+o*c-i*s+f,e[5]=a*s+i*u-r*c+l,e[6]=a*c+r*s-o*u+d,e[7]=-r*u-o*s-i*c+h,e}function Lo(e,t,n){var r=-t[0],o=-t[1],i=-t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=u*a+f*r+s*i-c*o,d=s*a+f*o+c*r-u*i,h=c*a+f*i+u*o-s*r,p=f*a-u*r-s*o-c*i;return Rr(e,t,n),r=e[0],o=e[1],i=e[2],a=e[3],e[4]=l*a+p*r+d*i-h*o,e[5]=d*a+p*o+h*r-l*i,e[6]=h*a+p*i+l*o-d*r,e[7]=p*a-l*r-d*o-h*i,e}function Fo(e,t,n){var r=-t[0],o=-t[1],i=-t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=u*a+f*r+s*i-c*o,d=s*a+f*o+c*r-u*i,h=c*a+f*i+u*o-s*r,p=f*a-u*r-s*o-c*i;return Ir(e,t,n),r=e[0],o=e[1],i=e[2],a=e[3],e[4]=l*a+p*r+d*i-h*o,e[5]=d*a+p*o+h*r-l*i,e[6]=h*a+p*i+l*o-d*r,e[7]=p*a-l*r-d*o-h*i,e}function Do(e,t,n){var r=-t[0],o=-t[1],i=-t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=u*a+f*r+s*i-c*o,d=s*a+f*o+c*r-u*i,h=c*a+f*i+u*o-s*r,p=f*a-u*r-s*o-c*i;return Nr(e,t,n),r=e[0],o=e[1],i=e[2],a=e[3],e[4]=l*a+p*r+d*i-h*o,e[5]=d*a+p*o+h*r-l*i,e[6]=h*a+p*i+l*o-d*r,e[7]=p*a-l*r-d*o-h*i,e}function jo(e,t,n){var r=n[0],o=n[1],i=n[2],a=n[3],u=t[0],s=t[1],c=t[2],f=t[3];return e[0]=u*a+f*r+s*i-c*o,e[1]=s*a+f*o+c*r-u*i,e[2]=c*a+f*i+u*o-s*r,e[3]=f*a-u*r-s*o-c*i,u=t[4],s=t[5],c=t[6],f=t[7],e[4]=u*a+f*r+s*i-c*o,e[5]=s*a+f*o+c*r-u*i,e[6]=c*a+f*i+u*o-s*r,e[7]=f*a-u*r-s*o-c*i,e}function Bo(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=n[0],s=n[1],c=n[2],f=n[3];return e[0]=r*f+a*u+o*c-i*s,e[1]=o*f+a*s+i*u-r*c,e[2]=i*f+a*c+r*s-o*u,e[3]=a*f-r*u-o*s-i*c,u=n[4],s=n[5],c=n[6],f=n[7],e[4]=r*f+a*u+o*c-i*s,e[5]=o*f+a*s+i*u-r*c,e[6]=i*f+a*c+r*s-o*u,e[7]=a*f-r*u-o*s-i*c,e}function Uo(e,t,n,r){if(Math.abs(r)<h)return So(e,t);var o=Math.hypot(n[0],n[1],n[2]);r*=.5;var i=Math.sin(r),a=i*n[0]/o,u=i*n[1]/o,s=i*n[2]/o,c=Math.cos(r),f=t[0],l=t[1],d=t[2],p=t[3];e[0]=f*c+p*a+l*s-d*u,e[1]=l*c+p*u+d*a-f*s,e[2]=d*c+p*s+f*u-l*a,e[3]=p*c-f*a-l*u-d*s;var _=t[4],m=t[5],v=t[6],g=t[7];return e[4]=_*c+g*a+m*s-v*u,e[5]=m*c+g*u+v*a-_*s,e[6]=v*c+g*s+_*u-m*a,e[7]=g*c-_*a-m*u-v*s,e}function Go(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e}function Vo(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=n[4],s=n[5],c=n[6],f=n[7],l=t[4],d=t[5],h=t[6],p=t[7],_=n[0],m=n[1],v=n[2],g=n[3];return e[0]=r*g+a*_+o*v-i*m,e[1]=o*g+a*m+i*_-r*v,e[2]=i*g+a*v+r*m-o*_,e[3]=a*g-r*_-o*m-i*v,e[4]=r*f+a*u+o*c-i*s+l*g+p*_+d*v-h*m,e[5]=o*f+a*s+i*u-r*c+d*g+p*m+h*_-l*v,e[6]=i*f+a*c+r*s-o*u+h*g+p*v+l*m-d*_,e[7]=a*f-r*u-o*s-i*c+p*g-l*_-d*m-h*v,e}var Ho=Vo;function ko(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e}var Qo=oo;function zo(e,t,n,r){var o=1-r;return Qo(t,n)<0&&(r=-r),e[0]=t[0]*o+n[0]*r,e[1]=t[1]*o+n[1]*r,e[2]=t[2]*o+n[2]*r,e[3]=t[3]*o+n[3]*r,e[4]=t[4]*o+n[4]*r,e[5]=t[5]*o+n[5]*r,e[6]=t[6]*o+n[6]*r,e[7]=t[7]*o+n[7]*r,e}function Wo(e,t){var n=Ko(t);return e[0]=-t[0]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[3]/n,e[4]=-t[4]/n,e[5]=-t[5]/n,e[6]=-t[6]/n,e[7]=t[7]/n,e}function qo(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}var Xo=ao,Jo=Xo,Ko=so,Yo=Ko;function Zo(e,t){var n=Ko(t);if(n>0){n=Math.sqrt(n);var r=t[0]/n,o=t[1]/n,i=t[2]/n,a=t[3]/n,u=t[4],s=t[5],c=t[6],f=t[7],l=r*u+o*s+i*c+a*f;e[0]=r,e[1]=o,e[2]=i,e[3]=a,e[4]=(u-r*l)/n,e[5]=(s-o*l)/n,e[6]=(c-i*l)/n,e[7]=(f-a*l)/n}return e}function $o(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function ei(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function ti(e,t){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=t[0],l=t[1],d=t[2],p=t[3],_=t[4],m=t[5],v=t[6],g=t[7];return Math.abs(n-f)<=h*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-l)<=h*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-d)<=h*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-p)<=h*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-_)<=h*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(u-m)<=h*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(s-v)<=h*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-g)<=h*Math.max(1,Math.abs(c),Math.abs(g))}function ni(){var e=new p(2);return p!=Float32Array&&(e[0]=0,e[1]=0),e}function ri(e){var t=new p(2);return t[0]=e[0],t[1]=e[1],t}function oi(e,t){var n=new p(2);return n[0]=e,n[1]=t,n}function ii(e,t){return e[0]=t[0],e[1]=t[1],e}function ai(e,t,n){return e[0]=t,e[1]=n,e}function ui(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function si(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function ci(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function fi(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function li(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function di(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function hi(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function pi(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function _i(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function mi(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function vi(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function gi(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function bi(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function yi(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function Mi(e){var t=e[0],n=e[1];return t*t+n*n}function xi(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Ti(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function Ai(e,t){var n=t[0],r=t[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e}function Si(e,t){return e[0]*t[0]+e[1]*t[1]}function wi(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function Ei(e,t,n,r){var o=t[0],i=t[1];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e}function Pi(e,t){t=t||1;var n=2*_()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function Oi(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[2]*o,e[1]=n[1]*r+n[3]*o,e}function Ci(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[2]*o+n[4],e[1]=n[1]*r+n[3]*o+n[5],e}function Ri(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[3]*o+n[6],e[1]=n[1]*r+n[4]*o+n[7],e}function Ii(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[4]*o+n[12],e[1]=n[1]*r+n[5]*o+n[13],e}function Ni(e,t,n,r){var o=t[0]-n[0],i=t[1]-n[1],a=Math.sin(r),u=Math.cos(r);return e[0]=o*u-i*a+n[0],e[1]=o*a+i*u+n[1],e}function Li(e,t){var n=e[0],r=e[1],o=t[0],i=t[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(o*o+i*i),u=a&&(n*o+r*i)/a;return Math.acos(Math.min(Math.max(u,-1),1))}function Fi(e){return e[0]=0,e[1]=0,e}function Di(e){return"vec2("+e[0]+", "+e[1]+")"}function ji(e,t){return e[0]===t[0]&&e[1]===t[1]}function Bi(e,t){var n=e[0],r=e[1],o=t[0],i=t[1];return Math.abs(n-o)<=h*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-i)<=h*Math.max(1,Math.abs(r),Math.abs(i))}var Ui=yi,Gi=si,Vi=ci,Hi=fi,ki=gi,Qi=bi,zi=Mi,Wi=function(){var e=ni();return function(t,n,r,o,i,a){var u,s;for(n||(n=2),r||(r=0),s=o?Math.min(o*n+r,t.length):t.length,u=r;u<s;u+=n)e[0]=t[u],e[1]=t[u+1],i(e,e,a),t[u]=e[0],t[u+1]=e[1];return t}}();n.d(t,"glMatrix",(function(){return r})),n.d(t,"mat2",(function(){return o})),n.d(t,"mat2d",(function(){return i})),n.d(t,"mat3",(function(){return a})),n.d(t,"mat4",(function(){return u})),n.d(t,"quat",(function(){return f})),n.d(t,"quat2",(function(){return l})),n.d(t,"vec2",(function(){return d})),n.d(t,"vec3",(function(){return s})),n.d(t,"vec4",(function(){return c}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Quat=t.Mat4=t.Vec3=t.Plane=t.Ray=t.AABB=t.PostProcessingSprite=t.ShadowQuality=t.ShadowCastingLight=t.ShadowRenderPass=t.Joint=t.Skin=t.PickingInteraction=t.PickingHitArea=t.InstancedStandardMaterial=t.StandardMaterialTexture=t.StandardMaterialOcclusionTexture=t.StandardMaterialNormalTexture=t.StandardMaterialDebugMode=t.StandardMaterialAlphaMode=t.StandardMaterial=t.Skybox=t.ShaderSourceLoader=t.Cubemap=t.CubemapLoader=t.TextureTransform=t.MaterialRenderSortType=t.Material=t.MaterialRenderPass=t.StandardPipeline=t.ImageBasedLighting=t.LightingEnvironment=t.Light=t.LightType=t.Animation=t.InstancedModel=t.Model=t.MeshShader=t.MeshGeometry3D=t.Mesh3D=t.CameraOrbitControl=t.Camera=t.Container3D=t.Matrix4=t.Transform3D=t.ObservableQuaternion=t.ObservablePoint3D=t.glTFAsset=t.glTFBinaryLoader=t.glTFLoader=void 0,t.Debug=t.SpriteBillboardType=t.SpriteBatchRenderer=t.Sprite3D=t.CubemapResource=t.Color=void 0;var r=n(57);Object.defineProperty(t,"glTFLoader",{enumerable:!0,get:function(){return r.glTFLoader}});var o=n(58);Object.defineProperty(t,"glTFBinaryLoader",{enumerable:!0,get:function(){return o.glTFBinaryLoader}});var i=n(21);Object.defineProperty(t,"glTFAsset",{enumerable:!0,get:function(){return i.glTFAsset}});var a=n(22);Object.defineProperty(t,"ObservablePoint3D",{enumerable:!0,get:function(){return a.ObservablePoint3D}});var u=n(33);Object.defineProperty(t,"ObservableQuaternion",{enumerable:!0,get:function(){return u.ObservableQuaternion}});var s=n(34);Object.defineProperty(t,"Transform3D",{enumerable:!0,get:function(){return s.Transform3D}});var c=n(23);Object.defineProperty(t,"Matrix4",{enumerable:!0,get:function(){return c.Matrix4}});var f=n(2);Object.defineProperty(t,"Container3D",{enumerable:!0,get:function(){return f.Container3D}});var l=n(5);Object.defineProperty(t,"Camera",{enumerable:!0,get:function(){return l.Camera}});var d=n(59);Object.defineProperty(t,"CameraOrbitControl",{enumerable:!0,get:function(){return d.CameraOrbitControl}});var h=n(7);Object.defineProperty(t,"Mesh3D",{enumerable:!0,get:function(){return h.Mesh3D}});var p=n(10);Object.defineProperty(t,"MeshGeometry3D",{enumerable:!0,get:function(){return p.MeshGeometry3D}});var _=n(8);Object.defineProperty(t,"MeshShader",{enumerable:!0,get:function(){return _.MeshShader}});var m=n(29);Object.defineProperty(t,"Model",{enumerable:!0,get:function(){return m.Model}});var v=n(51);Object.defineProperty(t,"InstancedModel",{enumerable:!0,get:function(){return v.InstancedModel}});var g=n(48);Object.defineProperty(t,"Animation",{enumerable:!0,get:function(){return g.Animation}});var b=n(12);Object.defineProperty(t,"LightType",{enumerable:!0,get:function(){return b.LightType}});var y=n(84);Object.defineProperty(t,"Light",{enumerable:!0,get:function(){return y.Light}});var M=n(41);Object.defineProperty(t,"LightingEnvironment",{enumerable:!0,get:function(){return M.LightingEnvironment}});var x=n(47);Object.defineProperty(t,"ImageBasedLighting",{enumerable:!0,get:function(){return x.ImageBasedLighting}});var T=n(85);Object.defineProperty(t,"StandardPipeline",{enumerable:!0,get:function(){return T.StandardPipeline}});var A=n(52);Object.defineProperty(t,"MaterialRenderPass",{enumerable:!0,get:function(){return A.MaterialRenderPass}});var S=n(27);Object.defineProperty(t,"Material",{enumerable:!0,get:function(){return S.Material}});var w=n(19);Object.defineProperty(t,"MaterialRenderSortType",{enumerable:!0,get:function(){return w.MaterialRenderSortType}});var E=n(44);Object.defineProperty(t,"TextureTransform",{enumerable:!0,get:function(){return E.TextureTransform}});var P=n(94);Object.defineProperty(t,"CubemapLoader",{enumerable:!0,get:function(){return P.CubemapLoader}});var O=n(31);Object.defineProperty(t,"Cubemap",{enumerable:!0,get:function(){return O.Cubemap}});var C=n(99);Object.defineProperty(t,"ShaderSourceLoader",{enumerable:!0,get:function(){return C.ShaderSourceLoader}});var R=n(100);Object.defineProperty(t,"Skybox",{enumerable:!0,get:function(){return R.Skybox}});var I=n(11);Object.defineProperty(t,"StandardMaterial",{enumerable:!0,get:function(){return I.StandardMaterial}});var N=n(18);Object.defineProperty(t,"StandardMaterialAlphaMode",{enumerable:!0,get:function(){return N.StandardMaterialAlphaMode}});var L=n(38);Object.defineProperty(t,"StandardMaterialDebugMode",{enumerable:!0,get:function(){return L.StandardMaterialDebugMode}});var F=n(45);Object.defineProperty(t,"StandardMaterialNormalTexture",{enumerable:!0,get:function(){return F.StandardMaterialNormalTexture}});var D=n(46);Object.defineProperty(t,"StandardMaterialOcclusionTexture",{enumerable:!0,get:function(){return D.StandardMaterialOcclusionTexture}});var j=n(20);Object.defineProperty(t,"StandardMaterialTexture",{enumerable:!0,get:function(){return j.StandardMaterialTexture}});var B=n(42);Object.defineProperty(t,"InstancedStandardMaterial",{enumerable:!0,get:function(){return B.InstancedStandardMaterial}});var U=n(104);Object.defineProperty(t,"PickingHitArea",{enumerable:!0,get:function(){return U.PickingHitArea}});var G=n(106);Object.defineProperty(t,"PickingInteraction",{enumerable:!0,get:function(){return G.PickingInteraction}});var V=n(49);Object.defineProperty(t,"Skin",{enumerable:!0,get:function(){return V.Skin}});var H=n(50);Object.defineProperty(t,"Joint",{enumerable:!0,get:function(){return H.Joint}});var k=n(53);Object.defineProperty(t,"ShadowRenderPass",{enumerable:!0,get:function(){return k.ShadowRenderPass}});var Q=n(110);Object.defineProperty(t,"ShadowCastingLight",{enumerable:!0,get:function(){return Q.ShadowCastingLight}});var z=n(32);Object.defineProperty(t,"ShadowQuality",{enumerable:!0,get:function(){return z.ShadowQuality}});var W=n(54);Object.defineProperty(t,"PostProcessingSprite",{enumerable:!0,get:function(){return W.PostProcessingSprite}});var q=n(28);Object.defineProperty(t,"AABB",{enumerable:!0,get:function(){return q.AABB}});var X=n(37);Object.defineProperty(t,"Ray",{enumerable:!0,get:function(){return X.Ray}});var J=n(113);Object.defineProperty(t,"Plane",{enumerable:!0,get:function(){return J.Plane}});var K=n(4);Object.defineProperty(t,"Vec3",{enumerable:!0,get:function(){return K.Vec3}});var Y=n(3);Object.defineProperty(t,"Mat4",{enumerable:!0,get:function(){return Y.Mat4}});var Z=n(6);Object.defineProperty(t,"Quat",{enumerable:!0,get:function(){return Z.Quat}});var $=n(9);Object.defineProperty(t,"Color",{enumerable:!0,get:function(){return $.Color}});var ee=n(55);Object.defineProperty(t,"CubemapResource",{enumerable:!0,get:function(){return ee.CubemapResource}});var te=n(114);Object.defineProperty(t,"Sprite3D",{enumerable:!0,get:function(){return te.Sprite3D}});var ne=n(116);Object.defineProperty(t,"SpriteBatchRenderer",{enumerable:!0,get:function(){return ne.SpriteBatchRenderer}});var re=n(56);Object.defineProperty(t,"SpriteBillboardType",{enumerable:!0,get:function(){return re.SpriteBillboardType}});var oe=n(26);Object.defineProperty(t,"Debug",{enumerable:!0,get:function(){return oe.Debug}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialAlphaMode=void 0,function(e){e.opaque="opaque",e.mask="mask",e.blend="blend"}(t.StandardMaterialAlphaMode||(t.StandardMaterialAlphaMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaterialRenderSortType=void 0,function(e){e.opaque="opaque",e.transparent="transparent"}(t.MaterialRenderSortType||(t.MaterialRenderSortType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialTexture=void 0;var r=n(0),o=function(e){function t(t,n){var r=e.call(this,t)||this;return r.uvSet=n,r}return r.__extends(t,e),t}(n(1).Texture);t.StandardMaterialTexture=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFAsset=void 0;var r=n(1),o=function(){function e(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=[]),this.descriptor=e,this.buffers=t,this.images=n}return e.load=function(t,n){for(var o=new e(t),i=function(r){var i,a=t.buffers[r];if(e.isEmbeddedResource(a.uri))o.buffers[r]=(i=a.uri,Uint8Array.from(atob(i.split(",")[1]),(function(e){return e.charCodeAt(0)})).buffer);else{if(!n)throw new Error("PIXI3D: A resource loader is required when buffer is not embedded.");n.load(a.uri,(function(e){o.buffers[r]=e.data}))}},a=0;a<t.buffers.length;a++)i(a);if(!t.images)return o;var u=function(i){var a=t.images[i];if(e.isEmbeddedResource(a.uri))o.images[i]=r.Texture.from(a.uri);else{if(!n)throw new Error("PIXI3D: A resource loader is required when image is not embedded.");n.load(a.uri,(function(e){e.texture&&(o.images[i]=e.texture)}))}};for(a=0;a<t.images.length;a++)u(a);return o},e.isValidBuffer=function(e){var t=new Uint32Array(e,0,3);return 1179937895===t[0]&&2===t[1]},e.isEmbeddedResource=function(e){return e.startsWith("data:")},e.fromBuffer=function(t,n){for(var o=[],i=12;i<t.byteLength;){var a=new Uint32Array(t,i,3);o.push({length:a[0],type:a[1],offset:i+8}),i+=a[0]+8}for(var u=new Uint8Array(t,o[0].offset,o[0].length),s=JSON.parse(new TextDecoder("utf-8").decode(u)),c=[],f=1;f<o.length;f++)c.push(t.slice(o[f].offset,o[f].offset+o[f].length));s.images&&0!==s.images.length||n(new e(s,c));var l=[],d=0,h=function(t){var o=s.images[t];if(void 0!==o.bufferView){var i=s.bufferViews[o.bufferView],a=c[i.buffer],u=new Uint8Array(a,i.byteOffset,i.byteLength),f=new Blob([u],{type:o.mimeType}),h=new FileReader;h.onload=function(){l[t]=r.Texture.from(h.result),++d===s.images.length&&n(new e(s,c,l))},h.readAsDataURL(f)}};for(f=0;s.images&&f<s.images.length;f++)h(f)},e}();t.glTFAsset=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObservablePoint3D=void 0;var r=n(0),o=function(e){function t(t,n,r,o,i){void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0);var a=e.call(this,t,n)||this;return a._array=new Float32Array(3),a._array.set([r,o,i]),a}return r.__extends(t,e),Object.defineProperty(t.prototype,"array",{get:function(){return this._array},set:function(e){this.setFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._array[0]},set:function(e){this._array[0]!==e&&(this._array[0]=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._array[1]},set:function(e){this._array[1]!==e&&(this._array[1]=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._array[2]},set:function(e){this._array[2]!==e&&(this._array[2]=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this.x,this.y,this.z)},t.prototype.copyFrom=function(e){return this._array[0]===e.x&&this._array[1]===e.y&&this._array[2]===e.z||(this._array[0]=e.x,this._array[1]=e.y,this._array[2]=e.z,this.cb.call(this.scope)),this},t.prototype.copyTo=function(e){return e instanceof t&&e.set(this.x,this.y,this.z),e},t.prototype.equals=function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},t.prototype.set=function(e,t,n){return void 0===t&&(t=e),void 0===n&&(n=e),this._array[0]===e&&this._array[1]===t&&this._array[2]===n||(this._array[0]=e,this._array[1]=t,this._array[2]=n,this.cb.call(this.scope)),this},t.prototype.setFrom=function(e){return this.set(e[0],e[1],e[2]),this},t}(r.__importStar(n(1)).ObservablePoint);t.ObservablePoint3D=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix4=void 0;var r=n(0),o=n(1),i=n(3),a=n(4),u=n(35),s=n(36),c=n(6),f=function(e){function t(t){var n=e.call(this)||this;return n._transformId=0,n.array=t?new Float32Array(t):new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n}return r.__extends(t,e),Object.defineProperty(t.prototype,"transformId",{get:function(){return this._transformId},enumerable:!1,configurable:!0}),t.prototype.toArray=function(e,t){return e?i.Mat4.transpose(this.array,t):t?i.Mat4.copy(this.array,t):this.array},Object.defineProperty(t.prototype,"position",{get:function(){var e=this;return this._position||(this._position=new s.MatrixComponent(this,3,(function(t){i.Mat4.getTranslation(e.array,t)}))),this._position.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaling",{get:function(){var e=this;return this._scaling||(this._scaling=new s.MatrixComponent(this,3,(function(t){i.Mat4.getScaling(e.array,t)}))),this._scaling.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){var e=this;if(!this._rotation){var t=new Float32Array(16);this._rotation=new s.MatrixComponent(this,4,(function(n){var o,a;try{for(var u=r.__values([0,1,2]),s=u.next();!s.done;s=u.next()){var f=s.value;t[f+0]=e.array[f+0]/e.scaling[0],t[f+4]=e.array[f+4]/e.scaling[1],t[f+8]=e.array[f+8]/e.scaling[2]}}catch(e){o={error:e}}finally{try{s&&!s.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}c.Quat.normalize(i.Mat4.getRotation(t,n),n)}))}return this._rotation.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"up",{get:function(){var e=this;return this._up||(this._up=new s.MatrixComponent(this,3,(function(t){a.Vec3.normalize(a.Vec3.set(e.array[4],e.array[5],e.array[6],t),t)}))),this._up.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"down",{get:function(){var e=this;return this._down||(this._down=new s.MatrixComponent(this,3,(function(t){a.Vec3.negate(e.up,t)}))),this._down.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){var e=this;return this._right||(this._right=new s.MatrixComponent(this,3,(function(t){a.Vec3.negate(e.left,t)}))),this._right.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){var e=this;return this._left||(this._left=new s.MatrixComponent(this,3,(function(t){a.Vec3.normalize(a.Vec3.cross(e.up,e.forward,t),t)}))),this._left.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"forward",{get:function(){var e=this;return this._forward||(this._forward=new s.MatrixComponent(this,3,(function(t){a.Vec3.normalize(a.Vec3.set(e.array[8],e.array[9],e.array[10],t),t)}))),this._forward.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backward",{get:function(){var e=this;return this._backward||(this._backward=new s.MatrixComponent(this,3,(function(t){a.Vec3.negate(e.forward,t)}))),this._backward.array},enumerable:!1,configurable:!0}),t.prototype.copyFrom=function(e){return e instanceof t&&(i.Mat4.copy(e.array,this.array),this._transformId++),this},t.prototype.setFromRotationPositionScale=function(e,t,n){u.Vec4.set(e.x,e.y,e.z,e.w,this.rotation),a.Vec3.set(n.x,n.y,n.z,this.scaling),a.Vec3.set(t.x,t.y,t.z,this.position),i.Mat4.fromRotationTranslationScale(this.rotation,this.position,this.scaling,this.array),this._transformId++},t.prototype.multiply=function(e){i.Mat4.multiply(e.array,this.array,this.array),this._transformId++},t}(o.Matrix);t.Matrix4=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialMatrixTexture=void 0;var r=n(0),o=n(25),i=n(1),a=n(13),u=function(e){function t(t){var n=this,r=new Float32Array(16*t),a=new o.BufferResource(r,{width:4,height:t});return(n=e.call(this,new i.BaseTexture(a,{mipmap:i.MIPMAP_MODES.OFF,wrapMode:i.WRAP_MODES.CLAMP,scaleMode:i.SCALE_MODES.NEAREST,format:i.FORMATS.RGBA,type:i.TYPES.FLOAT,alphaMode:i.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA}))||this)._buffer=r,n}return r.__extends(t,e),t.isSupported=function(e){return a.Capabilities.isFloatingPointTextureSupported(e)},t.prototype.updateBuffer=function(e){this._buffer.set(e),this.baseTexture.resource.update()},t}(i.Texture);t.StandardMaterialMatrixTexture=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferResource=void 0;var r=n(0).__importStar(n(1));t.BufferResource=r.BufferResource||r.resources.BufferResource},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Debug=void 0;var r=n(0).__importStar(n(1));!function(e){var t=[],n=new r.utils.EventEmitter;function o(e,t){for(var n,r=e;null!==(n=/{(\w*)}/g.exec(r))&&t;)r=r.replace(n[0],t[n[1]]);return r}e.on=function(e,t,r){n.on(e,t,r)},e.warn=function(e,r){if(!t.includes(e)){t.push(e);var i=o(e,r);console.warn("PIXI3D: "+i),n.emit("warn",i)}},e.error=function(e,r){if(!t.includes(e)){t.push(e);var i=o(e,r);console.error("PIXI3D: "+i),n.emit("error",i)}}}(t.Debug||(t.Debug={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0;var r=n(1),o=n(19),i=function(){function e(){this._renderSortType=o.MaterialRenderSortType.opaque,this.state=Object.assign(new r.State,{culling:!0,clockwiseFrontFace:!1,depthTest:!0}),this.drawMode=r.DRAW_MODES.TRIANGLES,this.renderSortType=o.MaterialRenderSortType.opaque}return Object.defineProperty(e.prototype,"depthMask",{get:function(){return this.state.depthMask},set:function(e){this.state.depthMask=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doubleSided",{get:function(){return!this.state.culling},set:function(e){this.state.culling=!e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){},Object.defineProperty(e.prototype,"isInstancingSupported",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createInstance=function(){},e.prototype.render=function(e,t){(this._shader||(this._shader=this.createShader(e,t),this._shader))&&(this.updateUniforms&&this.updateUniforms(e,this._shader),this._shader.render(e,t,this.state,this.drawMode))},e}();t.Material=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AABB=void 0;var r=n(17),o=function(){function e(){var e=this;this._onChanged=function(){e._center.set((e._min.x+e._max.x)/2,(e._min.y+e._max.y)/2,(e._min.z+e._max.z)/2),e._extents.set(Math.abs(e._max.x-e._center.x),Math.abs(e._max.y-e._center.y),Math.abs(e._max.z-e._center.z)),e._size.set(2*e._extents.x,2*e._extents.y,2*e._extents.z)},this._min=new r.ObservablePoint3D(this._onChanged,this),this._max=new r.ObservablePoint3D(this._onChanged,this),this._center=new r.ObservablePoint3D((function(){}),this),this._size=new r.ObservablePoint3D((function(){}),this),this._extents=new r.ObservablePoint3D((function(){}),this)}return Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(e){this._min.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(e){this._max.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this._center},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extents",{get:function(){return this._extents},enumerable:!1,configurable:!0}),e.from=function(t){var n=new e;return n.min.setFrom(t.min),n.max.setFrom(t.max),n},e.prototype.encapsulate=function(e){this._min.x=Math.min(this._min.x,e.x),this._min.y=Math.min(this._min.y,e.y),this._min.z=Math.min(this._min.z,e.z),this._max.x=Math.max(this._max.x,e.x),this._max.y=Math.max(this._max.y,e.y),this._max.z=Math.max(this._max.z,e.z)},e}();t.AABB=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var r=n(0),o=n(73),i=n(2),a=n(51),u=n(28),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animations=[],t.meshes=[],t}return r.__extends(t,e),t.from=function(e,t){return o.glTFParser.createModel(e,t)},t.prototype.createInstance=function(){return new a.InstancedModel(this)},t.prototype.getBoundingBox=function(){this.updateTransform();var e=new u.AABB,t=this.meshes[0].getBoundingBox();t&&(e.min=t.min,e.max=t.max);for(var n=1;n<this.meshes.length;n++){var r=this.meshes[n].getBoundingBox();r&&(e.encapsulate(r.min),e.encapsulate(r.max))}return e},t}(i.Container3D);t.Model=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowShader=void 0;var r=n(0),o=n(1),i=n(8),a=n(40),u=function(e){function t(t,r){void 0===r&&(r=[]);var i=n(90),u=n(91);return e.call(this,o.Program.from(a.StandardShaderSource.build(i,r,t),a.StandardShaderSource.build(u,r,t)))||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"maxSupportedJoints",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.createShaderGeometry=function(e){var t=new o.Geometry;return e.indices&&(1===e.indices.buffer.BYTES_PER_ELEMENT?t.addIndex(new o.Buffer(new Uint16Array(e.indices.buffer))):t.addIndex(new o.Buffer(e.indices.buffer))),e.positions&&t.addAttribute("a_Position",new o.Buffer(e.positions.buffer),3,!1,e.positions.componentType,e.positions.stride),t},Object.defineProperty(t.prototype,"name",{get:function(){return"shadow-shader"},enumerable:!1,configurable:!0}),t.prototype.updateUniforms=function(e,t){this.uniforms.u_ModelMatrix=e.worldTransform.array,this.uniforms.u_ViewProjectionMatrix=t.lightViewProjection},t}(i.MeshShader);t.ShadowShader=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cubemap=void 0;var r=n(0),o=n(1),i=n(95),a=n(55),u=n(25),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t,"faces",{get:function(){return["posx","negx","posy","negy","posz","negz"]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"levels",{get:function(){return this.resource.levels},enumerable:!1,configurable:!0}),t.fromFaces=function(e){var n=Array.isArray(e)?e:[e],r=t.faces.map((function(e,t){return new i.MipmapResource(n.map((function(t){return t[e]})),o.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+t)}));return new t(new a.CubemapResource(r,n.length))},t.fromColors=function(e,n,r,s,c,f){void 0===n&&(n=e),void 0===r&&(r=e),void 0===s&&(s=e),void 0===c&&(c=e),void 0===f&&(f=e);for(var l=[],d=[e,n,r,s,c,f],h=0;h<d.length;h++){var p=new u.BufferResource(new Uint8Array(d[h].rgba.map((function(e){return 255*e}))),{width:1,height:1}),_=new o.Texture(new o.BaseTexture(p,{type:o.TYPES.UNSIGNED_BYTE,format:o.FORMATS.RGB,alphaMode:o.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA}));l.push(new i.MipmapResource([_],o.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+h))}return new t(new a.CubemapResource(l,1))},t}(o.BaseTexture);t.Cubemap=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowQuality=void 0,function(e){e.low="low",e.medium="medium",e.high="high"}(t.ShadowQuality||(t.ShadowQuality={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObservableQuaternion=void 0;var r=n(0),o=n(1),i=n(6),a=function(e){function t(t,n,r,o,i,a){void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=1);var u=e.call(this,t,n)||this;return u._array=new Float32Array(4),u._array.set([r,o,i,a]),u}return r.__extends(t,e),Object.defineProperty(t.prototype,"array",{get:function(){return this._array},set:function(e){this.setFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._array[0]},set:function(e){this._array[0]!==e&&(this._array[0]=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._array[1]},set:function(e){this._array[1]!==e&&(this._array[1]=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._array[2]},set:function(e){this._array[2]!==e&&(this._array[2]=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._array[3]},set:function(e){this._array[3]!==e&&(this._array[3]=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t.prototype.setEulerAngles=function(e,t,n){i.Quat.fromEuler(e,t,n,this._array),this.cb.call(this.scope)},t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(e){return this._array[0]===e.x&&this._array[1]===e.y&&this._array[2]===e.z&&this._array[3]===e.w||(this._array[0]=e.x,this._array[1]=e.y,this._array[2]=e.z,this._array[3]=e.w,this.cb.call(this.scope)),this},t.prototype.copyTo=function(e){return e instanceof t&&e.set(this.x,this.y,this.z,this.w),e},t.prototype.equals=function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},t.prototype.set=function(e,t,n,r){return void 0===t&&(t=e),void 0===n&&(n=e),void 0===r&&(r=e),this._array[0]===e&&this._array[1]===t&&this._array[2]===n&&this._array[3]===r||(this._array[0]=e,this._array[1]=t,this._array[2]=n,this._array[3]=r,this.cb.call(this.scope)),this},t.prototype.setFrom=function(e){return this.set(e[0],e[1],e[2],e[3]),this},t}(o.ObservablePoint);t.ObservableQuaternion=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transform3D=void 0;var r=n(0),o=n(1),i=n(23),a=n(22),u=n(33),s=n(3),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.position=new a.ObservablePoint3D(t.onChange,t,0,0,0),t.scale=new a.ObservablePoint3D(t.onChange,t,1,1,1),t.rotationQuaternion=new u.ObservableQuaternion(t.onChange,t,0,0,0,1),t.worldTransform=new i.Matrix4,t.localTransform=new i.Matrix4,t.inverseWorldTransform=new i.Matrix4,t.normalTransform=new i.Matrix4,t}return r.__extends(t,e),t.prototype.updateLocalTransform=function(){this._localID!==this._currentLocalID&&(this.localTransform.setFromRotationPositionScale(this.rotationQuaternion,this.position,this.scale),this._parentID=-1,this._currentLocalID=this._localID)},t.prototype.setFromMatrix=function(e){this.localTransform.copyFrom(e),this.position.set(this.localTransform.position[0],this.localTransform.position[1],this.localTransform.position[2]),this.scale.set(this.localTransform.scaling[0],this.localTransform.scaling[1],this.localTransform.scaling[2]),this.rotationQuaternion.set(this.localTransform.rotation[0],this.localTransform.rotation[1],this.localTransform.rotation[2],this.localTransform.rotation[3])},t.prototype.updateTransform=function(e){this.updateLocalTransform(),e&&this._parentID===e._worldID||(this.worldTransform.copyFrom(this.localTransform),e instanceof t&&this.worldTransform.multiply(e.worldTransform),s.Mat4.invert(this.worldTransform.array,this.inverseWorldTransform.array),s.Mat4.transpose(this.inverseWorldTransform.array,this.normalTransform.array),this._worldID++,e&&(this._parentID=e._worldID))},t.prototype.lookAt=function(e,t){void 0===t&&(t=new Float32Array([0,1,0]));var n=s.Mat4.getRotation(s.Mat4.targetTo(e.array,this.worldTransform.position,t));this.rotationQuaternion.set(n[0],n[1],n[2],n[3])},t}(o.Transform);t.Transform3D=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vec4=void 0;var r=n(16),o=function(){function e(){}return e.set=function(e,t,n,o,i){return void 0===i&&(i=new Float32Array(4)),r.vec4.set(i,e,t,n,o)},e.transformMat4=function(e,t,n){return void 0===n&&(n=new Float32Array(4)),r.vec4.transformMat4(n,e,t)},e.fromValues=function(e,t,n,o){return r.vec4.fromValues(e,t,n,o)},e}();t.Vec4=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatrixComponent=void 0;var r=function(){function e(e,t,n){this._parent=e,this._update=n,this._array=new Float32Array(t)}return Object.defineProperty(e.prototype,"array",{get:function(){return this._id!==this._parent.transformId&&(this._update(this._array),this._id=this._parent.transformId),this._array},enumerable:!1,configurable:!0}),e}();t.MatrixComponent=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ray=void 0;var r=n(4),o=function(){function e(e,t){this._direction=new Float32Array(3),this._origin=new Float32Array(3),r.Vec3.copy(e,this._origin),r.Vec3.normalize(t,this._direction)}return Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),e.prototype.getPoint=function(e,t){return void 0===t&&(t=new Float32Array(3)),r.Vec3.add(this._origin,r.Vec3.scale(this._direction,e,t),t)},e}();t.Ray=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialDebugMode=void 0,function(e){e.alpha="alpha",e.emissive="emissive",e.f0="f0",e.metallic="metallic",e.normal="normal",e.occlusion="occlusion",e.roughness="roughness"}(t.StandardMaterialDebugMode||(t.StandardMaterialDebugMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=void 0,function(e){e.meshVertexSkinningFloatingPointTexturesNotSupported='Mesh is using vertex skinning but floating point textures is not supported on this device/environment. In case of errors, try changing the environment in PixiJS settings. Set "PIXI.settings.PREFER_ENV = PIXI.ENV.WEBGL2" before creating a renderer/application.',e.meshVertexSkinningNumberOfJointsNotSupported="Mesh is using vertex skinning but the number of joints ({joints}) is not supported on this device/environment. Max number of supported joints is {maxJoints}, try reducing the number of joints.",e.imageBasedLightingShaderTextureLodNotSupported='Image based lighting is used but shader texture lod is not supported on this device/environment, the material may not be displayed correctly. Try changing the environment in PixiJS settings. Set "PIXI.settings.PREFER_ENV = PIXI.ENV.WEBGL2" before creating a renderer/application.'}(t.Message||(t.Message={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardShaderSource=void 0,function(e){e.build=function(e,t,n){return 1===n.context.webGLVersion&&(e=e.replace(/VERSION/,"100").replace(/VERT_IN/g,"attribute").replace(/VERT_OUT/g,"varying").replace(/FRAG_COLOR/g,"gl_FragColor").replace(/FRAG_IN/g,"varying")),2===n.context.webGLVersion&&(e=e.replace(/VERSION/,"300 es").replace(/VERT_IN/g,"in").replace(/VERT_OUT/g,"out").replace(/FRAG_COLOR/g,"g_finalColor").replace(/FRAG_IN/g,"in")),e.replace(/#define FEATURES/,t.map((function(e){return"#define "+e})).join("\n"))}}(t.StandardShaderSource||(t.StandardShaderSource={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LightingEnvironment=void 0;var r=n(0),o=n(1),i=function(){function e(t,n){var o=this;this.renderer=t,this.lights=[],this.renderer.on("prerender",(function(){var e,t;try{for(var n=r.__values(o.lights),i=n.next();!i.done;i=n.next()){var a=i.value;a.parent||a.transform.updateTransform()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}})),e.main||(e.main=this),this.imageBasedLighting=n}return e.prototype.destroy=function(){},Object.defineProperty(e.prototype,"valid",{get:function(){return!this.imageBasedLighting||this.imageBasedLighting.valid},enumerable:!1,configurable:!0}),e}();t.LightingEnvironment=i,o.Renderer.registerPlugin("lighting",i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstancedStandardMaterial=void 0;var r=n(0),o=n(9),i=function(e){this.baseColor=new(o.Color.bind.apply(o.Color,r.__spreadArray([void 0],r.__read(e.baseColor.rgba))))};t.InstancedStandardMaterial=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFMaterial=void 0;var r=function(){this.alphaCutoff=.5,this.alphaMode="OPAQUE",this.doubleSided=!1,this.roughness=1,this.metallic=1,this.emissiveFactor=[0,0,0],this.baseColor=[1,1,1,1],this.unlit=!1};t.glTFMaterial=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextureTransform=void 0;var r=n(1),o=n(71),i=function(){function e(){var e=this;this._rotation=0,this._array=new Float32Array(9),this._dirty=!0,this._translation=new Float32Array([1,0,0,0,1,0,0,0,1]),this._scaling=new Float32Array([1,0,0,0,1,0,0,0,1]),this._rotate=new Float32Array([Math.cos(0),-Math.sin(0),0,Math.sin(0),Math.cos(0),0,0,0,1]),this.offset=new r.ObservablePoint((function(){e._translation.set([1,0,0,0,1,0,e.offset.x,e.offset.y,1]),e._dirty=!0}),void 0),this.scale=new r.ObservablePoint((function(){e._scaling.set([e.scale.x,0,0,0,e.scale.y,0,0,0,1]),e._dirty=!0}),void 0,1,1)}return Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e,this._rotate.set([Math.cos(e),-Math.sin(e),0,Math.sin(e),Math.cos(e),0,0,0,1]),this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"array",{get:function(){return this._dirty&&(o.Mat3.multiply(o.Mat3.multiply(this._translation,this._rotate,this._array),this._scaling,this._array),this._dirty=!1),this._array},enumerable:!1,configurable:!0}),e.fromTexture=function(t){var n=new e;if(!t.frame)return n;var o=t.frame,i=o.x,a=o.y,u=o.width,s=o.height;return 0===t.rotate&&(n.offset.set(i/t.baseTexture.width,a/t.baseTexture.height),n.scale.set(u/t.baseTexture.width,s/t.baseTexture.height)),2===t.rotate&&(i=t.frame.x+t.frame.width,n.offset.set(i/t.baseTexture.width,a/t.baseTexture.height),n.scale.set(s/t.baseTexture.height,u/t.baseTexture.width),n.rotation=-90*r.DEG_TO_RAD),n},e}();t.TextureTransform=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialNormalTexture=void 0;var r=n(0),o=function(e){function t(t,n,r){var o=e.call(this,t,r)||this;return o.scale=n,o.uvSet=r,o}return r.__extends(t,e),t}(n(20).StandardMaterialTexture);t.StandardMaterialNormalTexture=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialOcclusionTexture=void 0;var r=n(0),o=function(e){function t(t,n,r){var o=e.call(this,t,r)||this;return o.strength=n,o.uvSet=r,o}return r.__extends(t,e),t}(n(20).StandardMaterialTexture);t.StandardMaterialOcclusionTexture=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageBasedLighting=void 0;var r=n(1),o=function(){function e(e,t){this._diffuse=e,this._specular=t}return Object.defineProperty(e.prototype,"diffuse",{get:function(){return this._diffuse},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"specular",{get:function(){return this._specular},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valid",{get:function(){return this._diffuse.valid&&this._specular.valid&&(!this.lookupBrdf||this.lookupBrdf.valid)},enumerable:!1,configurable:!0}),e.defaultLookupBrdf=r.Texture.from(n(72).default,{mipmap:r.MIPMAP_MODES.OFF}),e}();t.ImageBasedLighting=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Animation=void 0;var r=n(0),o=r.__importStar(n(1)),i=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n.speed=1,n.loop=!1,n}return r.__extends(t,e),t.prototype.play=function(e){var t=this;void 0===e&&(e=o.Ticker.shared),this.position=0,this._ticker||(this._update=function(){t.update(e.deltaMS/1e3*t.speed)},this._ticker=e.add(this._update))},t.prototype.stop=function(){this._ticker&&this._update&&(this._ticker.remove(this._update),this._ticker=this._update=void 0)},t.prototype.update=function(e){this.position+=e,this.position<this.duration||(this.loop?this.position>this.duration&&(this.position=this.position%this.duration):(this.position=this.duration,this.stop()),this.emit("complete"))},t}(o.utils.EventEmitter);t.Animation=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Skin=void 0;var r=n(3),o=function(){function e(e,t){this.parent=e,this.joints=t,this._jointMatrices=[],this._jointNormalMatrices=[],this._transformIds=[],this.jointNormalMatrices=new Float32Array(16*this.joints.length),this.jointMatrices=new Float32Array(16*this.joints.length);for(var n=0;n<t.length;n++)this._transformIds.push(-1),this._jointMatrices.push(new Float32Array(this.jointMatrices.buffer,64*n,16)),this._jointNormalMatrices.push(new Float32Array(this.jointNormalMatrices.buffer,64*n,16))}return e.prototype.calculateJointMatrices=function(){for(var e=0;e<this.joints.length;e++)this.joints[e].transform._worldID!==this._transformIds[e]&&(this._transformIds[e]=this.joints[e].transform._worldID,r.Mat4.multiply(this.joints[e].worldTransform.array,this.joints[e].inverseBindMatrix,this._jointMatrices[e]),r.Mat4.multiply(this.parent.transform.inverseWorldTransform.array,this._jointMatrices[e],this._jointMatrices[e]),r.Mat4.invert(this._jointMatrices[e],this._jointNormalMatrices[e]),r.Mat4.transpose(this._jointNormalMatrices[e],this._jointNormalMatrices[e]))},e}();t.Skin=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Joint=void 0;var r=n(0),o=function(e){function t(t){var n=e.call(this)||this;return n.inverseBindMatrix=t,n}return r.__extends(t,e),t}(n(2).Container3D);t.Joint=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstancedModel=void 0;var r=n(0),o=n(2),i=n(7);var a=function(e){function t(t){var n=e.call(this)||this;return n.meshes=[],function e(t,n,a){var u,s;try{for(var c=r.__values(t.children),f=c.next();!f.done;f=c.next()){var l=f.value;if(l instanceof i.Mesh3D){var d=l.createInstance();d.name=l.name,a.push(n.addChild(d))}else if(l instanceof o.Container3D){var h=n.addChild(new o.Container3D);h.name=t.name,h.position=l.position,h.scale=l.scale,h.rotationQuaternion=l.rotationQuaternion,e(l,h,a)}}}catch(e){u={error:e}}finally{try{f&&!f.done&&(s=c.return)&&s.call(c)}finally{if(u)throw u.error}}}(t,n,n.meshes),n}return r.__extends(t,e),t}(o.Container3D);t.InstancedModel=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaterialRenderPass=void 0;var r=n(0),o=n(9),i=function(){function e(e,t){this.renderer=e,this.name=t,this.clearColor=new o.Color(0,0,0,0)}return Object.defineProperty(e.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(e){this._renderTexture=e},enumerable:!1,configurable:!0}),e.prototype.clear=function(){if(this._renderTexture&&this.clearColor){var e=this.renderer.renderTexture.current;this.renderer.renderTexture.bind(this._renderTexture),this.renderer.renderTexture.clear(Array.from(this.clearColor.rgba)),this.renderer.renderTexture.bind(e)}},e.prototype.render=function(e){var t,n,o=this.renderer.renderTexture.current;this._renderTexture&&this.renderer.renderTexture.bind(this._renderTexture);try{for(var i=r.__values(e),a=i.next();!a.done;a=i.next()){var u=a.value;u.material&&u.material.render(u,this.renderer)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}this._renderTexture&&this.renderer.renderTexture.bind(o)},e}();t.MaterialRenderPass=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowRenderPass=void 0;var r=n(0),o=n(86),i=n(89),a=function(){function e(e,t){void 0===t&&(t="shadow"),this.renderer=e,this.name=t,this._lights=[],this._filter=new o.ShadowFilter(e),this._shadow=new i.ShadowRenderer(e)}return e.prototype.addShadowCastingLight=function(e){this._lights.indexOf(e)<0&&this._lights.push(e)},e.prototype.removeShadowCastingLight=function(e){var t=this._lights.indexOf(e);t>=0&&this._lights.splice(t,1)},e.prototype.clear=function(){var e,t;try{for(var n=r.__values(this._lights),o=n.next();!o.done;o=n.next()){o.value.clear()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.render=function(e){var t,n,o,i;if(0!==e.length&&0!==this._lights.length){var a=this.renderer.renderTexture.current;try{for(var u=r.__values(this._lights),s=u.next();!s.done;s=u.next()){var c=s.value;this.renderer.renderTexture.bind(c.shadowTexture),c.updateLightViewProjection();try{for(var f=(o=void 0,r.__values(e)),l=f.next();!l.done;l=f.next()){var d=l.value;this._shadow.render(d,c)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}c.softness>0&&this._filter.applyGaussianBlur(c)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}this.renderer.renderTexture.bind(a)}},e}();t.ShadowRenderPass=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PostProcessingSprite=void 0;var r=n(0),o=n(1),i=function(e){function t(t,n){var r=e.call(this)||this;r.renderer=t,r._tickerRender=function(){};var i=n||{},a=i.width,u=void 0===a?512:a,s=i.height,c=void 0===s?512:s,f=i.objectToRender;return r._renderTexture=o.RenderTexture.create({width:u,height:c}),r._renderTexture.rotate=8,r._renderTexture.baseTexture.framebuffer.addDepthTexture(),r._texture=r._renderTexture,n&&n.width&&n.height||t.on("prerender",(function(){r._renderTexture.resize(t.screen.width,t.screen.height)})),f&&(r._tickerRender=function(){t.gl?r.worldVisible&&r.worldAlpha>0&&r.renderable&&f&&r.renderObject(f):o.Ticker.shared.remove(r._tickerRender)},o.Ticker.shared.add(r._tickerRender)),r}return r.__extends(t,e),Object.defineProperty(t.prototype,"renderTexture",{get:function(){return this._renderTexture},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTexture",{get:function(){if(this._renderTexture)return this._renderTexture.baseTexture.framebuffer.depthTexture},enumerable:!1,configurable:!0}),t.prototype.destroy=function(t){o.Ticker.shared.remove(this._tickerRender),e.prototype.destroy.call(this,t)},t.prototype.renderObject=function(e){this.renderer.render(e,this._renderTexture)},t}(o.Sprite);t.PostProcessingSprite=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CubemapResource=void 0;var r=n(0),o=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t)||this;return r.levels=n,r}return r.__extends(t,e),t.prototype.style=function(e){var t=e.gl;return t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this.levels>1?t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR):t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR),!0},t}(n(98).CubeResource);t.CubemapResource=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpriteBillboardType=void 0,function(e){e.spherical="spherical",e.cylindrical="cylindrical"}(t.SpriteBillboardType||(t.SpriteBillboardType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFLoader=void 0;var r=n(1),o=n(21);t.glTFLoader={use:function(e,t){if("gltf"!==e.extension)return t();Object.assign(e,{gltf:o.glTFAsset.load(e.data,new i(this,e))}),t()},add:function(){r.LoaderResource.setExtensionXhrType("bin",r.LoaderResource.XHR_RESPONSE_TYPE.BUFFER),r.LoaderResource.setExtensionXhrType("gltf",r.LoaderResource.XHR_RESPONSE_TYPE.JSON)}},r.Loader.registerPlugin(t.glTFLoader);var i=function(){function e(e,t){this._loader=e,this._resource=t}return e.prototype.load=function(e,t){var n=this._resource.url.substring(0,this._resource.url.lastIndexOf("/")+1)+e;if(this._loader.resources[n])if(this._loader.resources[n].data)t(this._loader.resources[n]);else var r=this._loader.onProgress.add((function(e,o){o.url===n&&(t(o),r.detach())}));else this._loader.add({parentResource:this._resource,url:n,onComplete:t})},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFBinaryLoader=void 0;var r=n(1),o=n(21);t.glTFBinaryLoader={use:function(e,t){return"glb"!==e.extension?t():o.glTFAsset.isValidBuffer(e.data)?void o.glTFAsset.fromBuffer(e.data,(function(n){Object.assign(e,{gltf:n}),t()})):t()},add:function(){r.LoaderResource.setExtensionXhrType("glb",r.LoaderResource.XHR_RESPONSE_TYPE.BUFFER)}},r.Loader.registerPlugin(t.glTFBinaryLoader)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraOrbitControl=void 0;var r=n(0).__importStar(n(1)),o=n(5),i=n(6),a=n(4),u=function(){function e(e,t){var n=this;void 0===t&&(t=o.Camera.main),this.camera=t,this._distance=5,this._grabbed=!1,this._angles=new r.ObservablePoint((function(){n._angles.x=Math.min(Math.max(-85,n._angles.x),85)}),void 0,0,180),this.target={x:0,y:0,z:0},this.allowControl=!0,this.camera.renderer.on("prerender",(function(){n.updateCamera()})),this.camera.renderer.plugins.interaction.on("mousedown",(function(e){e.stopped||(n._grabbed=!0)})),e.addEventListener("mouseup",(function(){n._grabbed=!1})),e.addEventListener("mousemove",(function(e){n.allowControl&&1===e.buttons&&n._grabbed&&(n._angles.x+=.5*e.movementY,n._angles.y-=.5*e.movementX)})),e.addEventListener("mousewheel",(function(e){n.allowControl&&(n.distance+=.01*e.deltaY,e.preventDefault())}))}return Object.defineProperty(e.prototype,"angles",{get:function(){return this._angles},enumerable:!1,configurable:!0}),e.prototype.updateCamera=function(){var e=i.Quat.fromEuler(this._angles.x,this._angles.y,0,new Float32Array(4)),t=a.Vec3.transformQuat(a.Vec3.set(0,0,1,new Float32Array(3)),e,new Float32Array(3)),n=a.Vec3.subtract(a.Vec3.set(this.target.x,this.target.y,this.target.z,new Float32Array(3)),a.Vec3.scale(t,this.distance,new Float32Array(3)),new Float32Array(3));this.camera.position.set(n[0],n[1],n[2]),this.camera.rotationQuaternion.set(e[0],e[1],e[2],e[3])},Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(e){this._distance=Math.min(Math.max(e,.01),Number.MAX_SAFE_INTEGER)},enumerable:!1,configurable:!0}),e}();t.CameraOrbitControl=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaneGeometry=void 0;var r=n(10);!function(e){e.create=function(){return Object.assign(new r.MeshGeometry3D,{positions:{buffer:new Float32Array([-1,0,1,1,0,-1,-1,0,-1,1,0,1])},indices:{buffer:new Uint8Array([0,1,2,0,3,1])},normals:{buffer:new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0])},uvs:[{buffer:new Float32Array([0,1,1,0,0,0,1,1])}]})}}(t.PlaneGeometry||(t.PlaneGeometry={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CubeGeometry=void 0;var r=n(10);!function(e){e.create=function(){return Object.assign(new r.MeshGeometry3D,{positions:{buffer:new Float32Array([-1,1,1,-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,1,1,-1,1,1,-1,1,-1,1,1,-1,-1,1,1,1,1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,-1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,1,1,1,1,-1,-1,1,-1,1,1,1])},indices:{buffer:new Uint8Array([0,1,2,0,3,1,4,5,6,4,7,5,8,9,10,8,11,9,12,13,14,12,15,13,16,17,18,16,19,17,20,21,22,20,23,21])},normals:{buffer:new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0])},uvs:[{buffer:new Float32Array([.625,1,.375,.75,.375,1,.625,.75,.625,.75,.375,.5,.375,.75,.625,.5,.625,.5,.375,.25,.375,.5,.625,.25,.625,.25,.375,0,.375,.25,.625,0,.375,.25,.125,.5,.375,.5,.125,.25,.875,.25,.625,.5,.875,.5,.625,.25])}],tangents:{buffer:new Float32Array([0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,-1,0,0,1,-1,0,0,1,-1,0,0,1,-1,0,0,1])}})}}(t.CubeGeometry||(t.CubeGeometry={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadGeometry=void 0;var r=n(10);!function(e){e.create=function(){return Object.assign(new r.MeshGeometry3D,{positions:{buffer:new Float32Array([-1,1,0,1,-1,0,-1,-1,0,1,1,0])},indices:{buffer:new Uint8Array([0,2,1,0,1,3])},normals:{buffer:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1])},uvs:[{buffer:new Float32Array([0,0,1,1,0,1,1,0])}]})}}(t.QuadGeometry||(t.QuadGeometry={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstancedMesh3D=void 0;var r=n(0),o=function(e){function t(t,n){var r=e.call(this)||this;return r.mesh=t,r.material=n,r}return r.__extends(t,e),t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.mesh.removeInstance(this)},t}(n(2).Container3D);t.InstancedMesh3D=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialFeatureSet=void 0;var r=n(1),o=n(18),i=n(38),a=n(13),u=n(24),s=n(26),c=n(39);!function(e){e.build=function(e,t,n,f,l){var d=[];if(t.instances.length>0&&d.push("USE_INSTANCING 1"),1===e.context.webGLVersion&&d.push("WEBGL1 1"),2===e.context.webGLVersion&&d.push("WEBGL2 1"),n.normals&&d.push("HAS_NORMALS 1"),n.uvs&&n.uvs[0]&&d.push("HAS_UV_SET1 1"),n.uvs&&n.uvs[1]&&d.push("HAS_UV_SET2 1"),n.tangents&&d.push("HAS_TANGENTS 1"),n.targets){for(var h=0;h<n.targets.length;h++)n.targets[h].positions&&d.push("HAS_TARGET_POSITION"+h),n.targets[h].normals&&d.push("HAS_TARGET_NORMAL"+h),n.targets[h].tangents&&d.push("HAS_TARGET_TANGENT"+h);t.targetWeights&&(d.push("WEIGHT_COUNT "+t.targetWeights.length),d.push("USE_MORPHING 1"))}if(n.joints&&d.push("HAS_JOINT_SET1 1"),n.weights&&d.push("HAS_WEIGHT_SET1 1"),t.skin&&function(e,t,n){if(!e.skin)return;var o=a.Capabilities.getMaxVertexUniformVectors(n)-20,i=Math.floor(o/8),f=e.skin.joints.length<=i,l=function(){var n;t.push("USE_SKINNING 1"),t.push("JOINT_COUNT "+(null===(n=e.skin)||void 0===n?void 0:n.joints.length))},d=function(){var n;t.push("USE_SKINNING 1"),t.push("JOINT_COUNT "+(null===(n=e.skin)||void 0===n?void 0:n.joints.length)),t.push("USE_SKINNING_TEXTURE 1")};if(r.settings.PREFER_UNIFORMS_WHEN_UPLOADING_SKIN_JOINTS){if(f)return void l();if(u.StandardMaterialMatrixTexture.isSupported(n))return void d();s.Debug.error(c.Message.meshVertexSkinningNumberOfJointsNotSupported,{joints:e.skin.joints.length,maxJoints:i})}else{if(u.StandardMaterialMatrixTexture.isSupported(n))return void d();s.Debug.warn(c.Message.meshVertexSkinningFloatingPointTexturesNotSupported),f?l():s.Debug.error(c.Message.meshVertexSkinningNumberOfJointsNotSupported,{joints:e.skin.joints.length,maxJoints:i})}}(t,d,e),f.unlit&&d.push("MATERIAL_UNLIT 1"),d.push("MATERIAL_METALLICROUGHNESS 1"),l.lights.length>0&&(d.push("LIGHT_COUNT "+l.lights.length),d.push("USE_PUNCTUAL 1")),l.imageBasedLighting){if(!l.imageBasedLighting.valid)return;a.Capabilities.isShaderTextureLodSupported(e)?d.push("USE_TEX_LOD 1"):s.Debug.warn(c.Message.imageBasedLightingShaderTextureLodNotSupported),d.push("USE_IBL 1")}if(f.shadowCastingLight&&d.push("USE_SHADOW_MAPPING 1"),f.baseColorTexture){if(!f.baseColorTexture.valid)return;f.baseColorTexture.transform&&d.push("HAS_BASECOLOR_UV_TRANSFORM 1"),d.push("HAS_BASE_COLOR_MAP 1")}if(f.emissiveTexture){if(!f.emissiveTexture.valid)return;f.emissiveTexture.transform&&d.push("HAS_EMISSIVE_UV_TRANSFORM 1"),d.push("HAS_EMISSIVE_MAP 1")}if(f.normalTexture){if(!f.normalTexture.valid)return;f.normalTexture.transform&&d.push("HAS_NORMAL_UV_TRANSFORM 1"),d.push("HAS_NORMAL_MAP 1")}if(f.metallicRoughnessTexture){if(!f.metallicRoughnessTexture.valid)return;f.metallicRoughnessTexture.transform&&d.push("HAS_METALLICROUGHNESS_UV_TRANSFORM 1"),d.push("HAS_METALLIC_ROUGHNESS_MAP 1")}if(f.occlusionTexture){if(!f.occlusionTexture.valid)return;f.occlusionTexture.transform&&d.push("HAS_OCCLUSION_UV_TRANSFORM 1"),d.push("HAS_OCCLUSION_MAP 1")}switch(f.alphaMode){case o.StandardMaterialAlphaMode.opaque:d.push("ALPHAMODE_OPAQUE 1");break;case o.StandardMaterialAlphaMode.mask:d.push("ALPHAMODE_MASK 1")}switch(f.debugMode&&d.push("DEBUG_OUTPUT 1"),f.debugMode){case i.StandardMaterialDebugMode.alpha:d.push("DEBUG_ALPHA 1");break;case i.StandardMaterialDebugMode.emissive:d.push("DEBUG_EMISSIVE 1");break;case i.StandardMaterialDebugMode.f0:d.push("DEBUG_F0 1");break;case i.StandardMaterialDebugMode.metallic:d.push("DEBUG_METALLIC 1");break;case i.StandardMaterialDebugMode.normal:d.push("DEBUG_NORMAL 1");break;case i.StandardMaterialDebugMode.occlusion:d.push("DEBUG_OCCLUSION 1");break;case i.StandardMaterialDebugMode.roughness:d.push("DEBUG_ROUGHNESS 1")}return d},e.hasSkinningTextureFeature=function(e){return e.includes("USE_SKINNING_TEXTURE 1")}}(t.StandardMaterialFeatureSet||(t.StandardMaterialFeatureSet={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardShader=void 0;var r=n(0),o=r.__importStar(n(1)),i=n(8),a=n(66),u=n(40),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._instancing=new a.StandardShaderInstancing,t}return r.__extends(t,e),t.build=function(e,r){var i=n(67),a=n(68);return new t(o.Program.from(u.StandardShaderSource.build(i,r,e),u.StandardShaderSource.build(a,r,e)))},Object.defineProperty(t.prototype,"name",{get:function(){return"standard-shader"},enumerable:!1,configurable:!0}),t.prototype.createShaderGeometry=function(t,n){var r=e.prototype.createShaderGeometry.call(this,t,n);if(n&&this._instancing.addGeometryAttributes(r),t.targets)for(var i=0;i<t.targets.length;i++){var a=t.targets[i].positions;a&&r.addAttribute("a_Target_Position"+i,new o.Buffer(a.buffer),3,!1,a.componentType,a.stride);var u=t.targets[i].normals;u&&r.addAttribute("a_Target_Normal"+i,new o.Buffer(u.buffer),3,!1,u.componentType,u.stride);var s=t.targets[i].tangents;s&&r.addAttribute("a_Target_Tangent"+i,new o.Buffer(s.buffer),3,!1,s.componentType,s.stride)}return t.uvs&&t.uvs[1]&&r.addAttribute("a_UV2",new o.Buffer(t.uvs[1].buffer),2,!1,t.uvs[1].componentType,t.uvs[1].stride),t.joints&&r.addAttribute("a_Joint1",new o.Buffer(t.joints.buffer),4,!1,t.joints.componentType,t.joints.stride),t.weights&&r.addAttribute("a_Weight1",new o.Buffer(t.weights.buffer),4,!1,t.weights.componentType,t.weights.stride),r},t.prototype.render=function(t,n,r,o){t.instances.length>0&&this._instancing.updateBuffers(t.instances),e.prototype.render.call(this,t,n,r,o)},t}(i.MeshShader);t.StandardShader=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardShaderInstancing=void 0;var r=n(0).__importStar(n(1)),o=function(){function e(){this._maxInstances=200,this._modelMatrix=[new r.Buffer,new r.Buffer,new r.Buffer,new r.Buffer],this._normalMatrix=[new r.Buffer,new r.Buffer,new r.Buffer,new r.Buffer],this._baseColor=new r.Buffer,this.expandBuffers(this._maxInstances)}return e.prototype.expandBuffers=function(e){for(;e>this._maxInstances;)this._maxInstances+=Math.floor(.5*this._maxInstances);for(var t=0;t<4;t++)this._modelMatrix[t].update(new Float32Array(4*this._maxInstances)),this._normalMatrix[t].update(new Float32Array(4*this._maxInstances));this._baseColor.update(new Float32Array(4*this._maxInstances))},e.prototype.updateBuffers=function(e){e.length>this._maxInstances&&this.expandBuffers(e.length);for(var t=0,n=0;n<e.length;n++)if(e[n].worldVisible&&e[n].renderable){for(var r=e[n].transform.normalTransform.array,o=0;o<4;o++)this._normalMatrix[o].data.set(r.slice(4*o,4*o+4),4*t);var i=e[n].worldTransform.array;for(o=0;o<4;o++)this._modelMatrix[o].data.set(i.slice(4*o,4*o+4),4*t);var a=e[n].material;this._baseColor.data.set(a.baseColor.rgba,4*t),t++}for(n=0;n<4;n++)this._modelMatrix[n].update(),this._normalMatrix[n].update();this._baseColor.update()},e.prototype.addGeometryAttributes=function(e){for(var t=0;t<4;t++)e.addAttribute("a_ModelMatrix"+t,this._modelMatrix[t],4,!1,void 0,0,void 0,!0);for(t=0;t<4;t++)e.addAttribute("a_NormalMatrix"+t,this._normalMatrix[t],4,!1,void 0,0,void 0,!0);e.addAttribute("a_BaseColorFactor",this._baseColor,4,!1,void 0,0,void 0,!0)},e}();t.StandardShaderInstancing=o},function(e,t){e.exports="#version VERSION\n\n#define FEATURES\n\nvec4 _texture(sampler2D sampler, vec2 coord)\n{\n#ifdef WEBGL2\n    return texture(sampler, coord);\n#else\n    return texture2D(sampler, coord);\n#endif\n}\n\nvec4 _texture(samplerCube sampler, vec3 coord)\n{\n#ifdef WEBGL2\n    return texture(sampler, coord);\n#else\n    return textureCube(sampler, coord);\n#endif\n}\n#ifdef HAS_TARGET_POSITION0\nVERT_IN vec3 a_Target_Position0;\n#endif\n\n#ifdef HAS_TARGET_POSITION1\nVERT_IN vec3 a_Target_Position1;\n#endif\n\n#ifdef HAS_TARGET_POSITION2\nVERT_IN vec3 a_Target_Position2;\n#endif\n\n#ifdef HAS_TARGET_POSITION3\nVERT_IN vec3 a_Target_Position3;\n#endif\n\n#ifdef HAS_TARGET_POSITION4\nVERT_IN vec3 a_Target_Position4;\n#endif\n\n#ifdef HAS_TARGET_POSITION5\nVERT_IN vec3 a_Target_Position5;\n#endif\n\n#ifdef HAS_TARGET_POSITION6\nVERT_IN vec3 a_Target_Position6;\n#endif\n\n#ifdef HAS_TARGET_POSITION7\nVERT_IN vec3 a_Target_Position7;\n#endif\n\n#ifdef HAS_TARGET_NORMAL0\nVERT_IN vec3 a_Target_Normal0;\n#endif\n\n#ifdef HAS_TARGET_NORMAL1\nVERT_IN vec3 a_Target_Normal1;\n#endif\n\n#ifdef HAS_TARGET_NORMAL2\nVERT_IN vec3 a_Target_Normal2;\n#endif\n\n#ifdef HAS_TARGET_NORMAL3\nVERT_IN vec3 a_Target_Normal3;\n#endif\n\n#ifdef HAS_TARGET_TANGENT0\nVERT_IN vec3 a_Target_Tangent0;\n#endif\n\n#ifdef HAS_TARGET_TANGENT1\nVERT_IN vec3 a_Target_Tangent1;\n#endif\n\n#ifdef HAS_TARGET_TANGENT2\nVERT_IN vec3 a_Target_Tangent2;\n#endif\n\n#ifdef HAS_TARGET_TANGENT3\nVERT_IN vec3 a_Target_Tangent3;\n#endif\n\n#ifdef USE_MORPHING\nuniform float u_morphWeights[WEIGHT_COUNT];\n#endif\n\n#ifdef HAS_JOINT_SET1\nVERT_IN vec4 a_Joint1;\n#endif\n\n#ifdef HAS_JOINT_SET2\nVERT_IN vec4 a_Joint2;\n#endif\n\n#ifdef HAS_WEIGHT_SET1\nVERT_IN vec4 a_Weight1;\n#endif\n\n#ifdef HAS_WEIGHT_SET2\nVERT_IN vec4 a_Weight2;\n#endif\n\n#ifdef USE_SKINNING\n#ifdef USE_SKINNING_TEXTURE\nuniform sampler2D u_jointMatrixSampler;\nuniform sampler2D u_jointNormalMatrixSampler;\n#else\nuniform mat4 u_jointMatrix[JOINT_COUNT];\nuniform mat4 u_jointNormalMatrix[JOINT_COUNT];\n#endif\n#endif\n\n// these offsets assume the texture is 4 pixels across\n#define ROW0_U ((0.5 + 0.0) / 4.0)\n#define ROW1_U ((0.5 + 1.0) / 4.0)\n#define ROW2_U ((0.5 + 2.0) / 4.0)\n#define ROW3_U ((0.5 + 3.0) / 4.0)\n\n#ifdef USE_SKINNING\nmat4 getJointMatrix(float boneNdx) {\n    #ifdef USE_SKINNING_TEXTURE\n    float v = (boneNdx + 0.5) / float(JOINT_COUNT);\n    return mat4(\n        _texture(u_jointMatrixSampler, vec2(ROW0_U, v)),\n        _texture(u_jointMatrixSampler, vec2(ROW1_U, v)),\n        _texture(u_jointMatrixSampler, vec2(ROW2_U, v)),\n        _texture(u_jointMatrixSampler, vec2(ROW3_U, v))\n    );\n    #else\n    return u_jointMatrix[int(boneNdx)];\n    #endif\n}\n\nmat4 getJointNormalMatrix(float boneNdx) {\n    #ifdef USE_SKINNING_TEXTURE\n    float v = (boneNdx + 0.5) / float(JOINT_COUNT);\n    return mat4(\n        _texture(u_jointNormalMatrixSampler, vec2(ROW0_U, v)),\n        _texture(u_jointNormalMatrixSampler, vec2(ROW1_U, v)),\n        _texture(u_jointNormalMatrixSampler, vec2(ROW2_U, v)),\n        _texture(u_jointNormalMatrixSampler, vec2(ROW3_U, v))\n    );\n    #else\n    return u_jointNormalMatrix[int(boneNdx)];\n    #endif\n}\n\nmat4 getSkinningMatrix()\n{\n    mat4 skin = mat4(0);\n\n    #if defined(HAS_WEIGHT_SET1) && defined(HAS_JOINT_SET1)\n    skin +=\n        a_Weight1.x * getJointMatrix(a_Joint1.x) +\n        a_Weight1.y * getJointMatrix(a_Joint1.y) +\n        a_Weight1.z * getJointMatrix(a_Joint1.z) +\n        a_Weight1.w * getJointMatrix(a_Joint1.w);\n    #endif\n\n    return skin;\n}\n\nmat4 getSkinningNormalMatrix()\n{\n    mat4 skin = mat4(0);\n\n    #if defined(HAS_WEIGHT_SET1) && defined(HAS_JOINT_SET1)\n    skin +=\n        a_Weight1.x * getJointNormalMatrix(a_Joint1.x) +\n        a_Weight1.y * getJointNormalMatrix(a_Joint1.y) +\n        a_Weight1.z * getJointNormalMatrix(a_Joint1.z) +\n        a_Weight1.w * getJointNormalMatrix(a_Joint1.w);\n    #endif\n\n    return skin;\n}\n#endif // !USE_SKINNING\n\n#ifdef USE_MORPHING\nvec4 getTargetPosition()\n{\n    vec4 pos = vec4(0);\n\n#ifdef HAS_TARGET_POSITION0\n    pos.xyz += u_morphWeights[0] * a_Target_Position0;\n#endif\n\n#ifdef HAS_TARGET_POSITION1\n    pos.xyz += u_morphWeights[1] * a_Target_Position1;\n#endif\n\n#ifdef HAS_TARGET_POSITION2\n    pos.xyz += u_morphWeights[2] * a_Target_Position2;\n#endif\n\n#ifdef HAS_TARGET_POSITION3\n    pos.xyz += u_morphWeights[3] * a_Target_Position3;\n#endif\n\n#ifdef HAS_TARGET_POSITION4\n    pos.xyz += u_morphWeights[4] * a_Target_Position4;\n#endif\n\n    return pos;\n}\n\nvec4 getTargetNormal()\n{\n    vec4 normal = vec4(0);\n\n#ifdef HAS_TARGET_NORMAL0\n    normal.xyz += u_morphWeights[0] * a_Target_Normal0;\n#endif\n\n#ifdef HAS_TARGET_NORMAL1\n    normal.xyz += u_morphWeights[1] * a_Target_Normal1;\n#endif\n\n#ifdef HAS_TARGET_NORMAL2\n    normal.xyz += u_morphWeights[2] * a_Target_Normal2;\n#endif\n\n#ifdef HAS_TARGET_NORMAL3\n    normal.xyz += u_morphWeights[3] * a_Target_Normal3;\n#endif\n\n#ifdef HAS_TARGET_NORMAL4\n    normal.xyz += u_morphWeights[4] * a_Target_Normal4;\n#endif\n\n    return normal;\n}\n\nvec4 getTargetTangent()\n{\n    vec4 tangent = vec4(0);\n\n#ifdef HAS_TARGET_TANGENT0\n    tangent.xyz += u_morphWeights[0] * a_Target_Tangent0;\n#endif\n\n#ifdef HAS_TARGET_TANGENT1\n    tangent.xyz += u_morphWeights[1] * a_Target_Tangent1;\n#endif\n\n#ifdef HAS_TARGET_TANGENT2\n    tangent.xyz += u_morphWeights[2] * a_Target_Tangent2;\n#endif\n\n#ifdef HAS_TARGET_TANGENT3\n    tangent.xyz += u_morphWeights[3] * a_Target_Tangent3;\n#endif\n\n#ifdef HAS_TARGET_TANGENT4\n    tangent.xyz += u_morphWeights[4] * a_Target_Tangent4;\n#endif\n\n    return tangent;\n}\n\n#endif // !USE_MORPHING\n\n\nVERT_IN vec4 a_Position;\nVERT_OUT vec3 v_Position;\n\n#ifdef USE_INSTANCING\nVERT_IN vec4 a_ModelMatrix0;\nVERT_IN vec4 a_ModelMatrix1;\nVERT_IN vec4 a_ModelMatrix2;\nVERT_IN vec4 a_ModelMatrix3;\n#endif\n\n#ifdef USE_INSTANCING\nVERT_IN vec4 a_BaseColorFactor;\nVERT_OUT vec4 v_BaseColorFactor;\n#endif\n\n#ifdef USE_INSTANCING\nVERT_IN vec4 a_NormalMatrix0;\nVERT_IN vec4 a_NormalMatrix1;\nVERT_IN vec4 a_NormalMatrix2;\nVERT_IN vec4 a_NormalMatrix3;\n#endif\n\n#ifdef HAS_NORMALS\nVERT_IN vec4 a_Normal;\n#endif\n\n#ifdef HAS_TANGENTS\nVERT_IN vec4 a_Tangent;\n#endif\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nVERT_OUT mat3 v_TBN;\n#else\nVERT_OUT vec3 v_Normal;\n#endif\n#endif\n\n#ifdef HAS_UV_SET1\nVERT_IN vec2 a_UV1;\n#endif\n\n#ifdef HAS_UV_SET2\nVERT_IN vec2 a_UV2;\n#endif\n\nVERT_OUT vec2 v_UVCoord1;\nVERT_OUT vec2 v_UVCoord2;\n\n#ifdef HAS_VERTEX_COLOR_VEC3\nVERT_IN vec3 a_Color;\nVERT_OUT vec3 v_Color;\n#endif\n\n#ifdef HAS_VERTEX_COLOR_VEC4\nVERT_IN vec4 a_Color;\nVERT_OUT vec4 v_Color;\n#endif\n\nuniform mat4 u_ViewProjectionMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\n#ifdef USE_SHADOW_MAPPING\nuniform mat4 u_LightViewProjectionMatrix;\nVERT_OUT vec4 v_PositionLightSpace;\n#endif\n\nvec4 getPosition()\n{\n    vec4 pos = a_Position;\n\n#ifdef USE_MORPHING\n    pos += getTargetPosition();\n#endif\n\n#ifdef USE_SKINNING\n    pos = getSkinningMatrix() * pos;\n#endif\n\n    return pos;\n}\n\n#ifdef HAS_NORMALS\nvec4 getNormal()\n{\n    vec4 normal = a_Normal;\n\n#ifdef USE_MORPHING\n    normal += getTargetNormal();\n#endif\n\n#ifdef USE_SKINNING\n    normal = getSkinningNormalMatrix() * normal;\n#endif\n\n    return normalize(normal);\n}\n#endif\n\n#ifdef HAS_TANGENTS\nvec4 getTangent()\n{\n    vec4 tangent = a_Tangent;\n\n#ifdef USE_MORPHING\n    tangent += getTargetTangent();\n#endif\n\n#ifdef USE_SKINNING\n    tangent = getSkinningMatrix() * tangent;\n#endif\n\n    return normalize(tangent);\n}\n#endif\n\nvoid main()\n{\n    mat4 modelMatrix = u_ModelMatrix;\n    #ifdef USE_INSTANCING\n        modelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\n    #endif\n    vec4 pos = modelMatrix * getPosition();\n    v_Position = vec3(pos.xyz) / pos.w;\n\n    mat4 normalMatrix = u_NormalMatrix;\n    #ifdef USE_INSTANCING\n        normalMatrix = mat4(a_NormalMatrix0, a_NormalMatrix1, a_NormalMatrix2, a_NormalMatrix3);\n    #endif\n\n    #ifdef HAS_NORMALS\n    #ifdef HAS_TANGENTS\n    vec4 tangent = getTangent();\n    vec3 normalW = normalize(vec3(normalMatrix * vec4(getNormal().xyz, 0.0)));\n    vec3 tangentW = normalize(vec3(modelMatrix * vec4(tangent.xyz, 0.0)));\n    vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n    v_TBN = mat3(tangentW, bitangentW, normalW);\n    #else // !HAS_TANGENTS\n    v_Normal = normalize(vec3(normalMatrix * vec4(getNormal().xyz, 0.0)));\n    #endif\n    #endif // !HAS_NORMALS\n\n    v_UVCoord1 = vec2(0.0, 0.0);\n    v_UVCoord2 = vec2(0.0, 0.0);\n\n    #ifdef HAS_UV_SET1\n    v_UVCoord1 = a_UV1;\n    #endif\n\n    #ifdef HAS_UV_SET2\n    v_UVCoord2 = a_UV2;\n    #endif\n\n    #if defined(HAS_VERTEX_COLOR_VEC3) || defined(HAS_VERTEX_COLOR_VEC4)\n    v_Color = a_Color;\n    #endif\n\n    #ifdef USE_SHADOW_MAPPING\n    v_PositionLightSpace = u_LightViewProjectionMatrix * pos;\n    #endif\n\n    #ifdef USE_INSTANCING\n    v_BaseColorFactor = a_BaseColorFactor;\n    #endif\n\n    gl_Position = u_ViewProjectionMatrix * pos;\n}\n"},function(e,t){e.exports="#version VERSION\n\n//\n// This fragment shader defines a reference implementation for Physically Based Shading of\n// a microfacet surface material defined by a glTF model.\n//\n// References:\n// [1] Real Shading in Unreal Engine 4\n//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\n// [2] Physically Based Shading at Disney\n//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\n// [3] README.md - Environment Maps\n//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\n// [4] \"An Inexpensive BRDF Model for Physically based Rendering\" by Christophe Schlick\n//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\n\n#define FEATURES\n\n#if defined(WEBGL1) //&& defined(USE_TEX_LOD)\n#extension GL_EXT_shader_texture_lod : enable\n#endif\n\n#if defined(WEBGL1)\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n#if defined(WEBGL1) && defined(USE_HDR)\n#extension GL_OES_texture_float : enable\n#extension GL_OES_texture_float_linear : enable\n#endif\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvec4 _texture(sampler2D sampler, vec2 coord)\n{\n#ifdef WEBGL2\n    return texture(sampler, coord);\n#else\n    return texture2D(sampler, coord);\n#endif\n}\n\nvec4 _texture(samplerCube sampler, vec3 coord)\n{\n#ifdef WEBGL2\n    return texture(sampler, coord);\n#else\n    return textureCube(sampler, coord);\n#endif\n}\nvec4 _textureLod(sampler2D sampler, vec2 coord, float lod)\n{\n#ifdef WEBGL2\n    return textureLod(sampler, coord, lod);\n#endif\n#if defined(WEBGL1) && defined(GL_EXT_shader_texture_lod) \n    return texture2DLodEXT(sampler, coord, lod);\n#endif\n    return vec4(0.0);\n}\n\nvec4 _textureLod(samplerCube sampler, vec3 coord, float lod)\n{\n#ifdef WEBGL2\n    return textureLod(sampler, coord, lod);\n#endif\n#if defined(WEBGL1) && defined(GL_EXT_shader_texture_lod) \n    return textureCubeLodEXT(sampler, coord, lod);\n#endif\n    return vec4(0.0);\n}\nvec3 _dFdx(vec3 coord)\n{\n#if defined(WEBGL2) || defined(GL_OES_standard_derivatives)\n    return dFdx(coord);\n#endif\n    return vec3(0.0);\n}\n\nvec3 _dFdy(vec3 coord)\n{\n#if defined(WEBGL2) || defined(GL_OES_standard_derivatives)\n    return dFdy(coord);\n#endif\n    return vec3(0.0);\n}\nFRAG_IN vec2 v_UVCoord1;\nFRAG_IN vec2 v_UVCoord2;\n\n// General Material\n#ifdef HAS_NORMAL_MAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\nuniform int u_NormalUVSet;\nuniform mat3 u_NormalUVTransform;\n#endif\n\n#ifdef HAS_EMISSIVE_MAP\nuniform sampler2D u_EmissiveSampler;\nuniform int u_EmissiveUVSet;\nuniform vec3 u_EmissiveFactor;\nuniform mat3 u_EmissiveUVTransform;\n#endif\n\n#ifdef HAS_OCCLUSION_MAP\nuniform sampler2D u_OcclusionSampler;\nuniform int u_OcclusionUVSet;\nuniform float u_OcclusionStrength;\nuniform mat3 u_OcclusionUVTransform;\n#endif\n\n// Metallic Roughness Material\n#ifdef HAS_BASE_COLOR_MAP\nuniform sampler2D u_BaseColorSampler;\nuniform int u_BaseColorUVSet;\nuniform mat3 u_BaseColorUVTransform;\n#endif\n\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\nuniform sampler2D u_MetallicRoughnessSampler;\nuniform int u_MetallicRoughnessUVSet;\nuniform mat3 u_MetallicRoughnessUVTransform;\n#endif\n\n// Specular Glossiness Material\n#ifdef HAS_DIFFUSE_MAP\nuniform sampler2D u_DiffuseSampler;\nuniform int u_DiffuseUVSet;\nuniform mat3 u_DiffuseUVTransform;\n#endif\n\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\nuniform sampler2D u_SpecularGlossinessSampler;\nuniform int u_SpecularGlossinessUVSet;\nuniform mat3 u_SpecularGlossinessUVTransform;\n#endif\n\n// IBL\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\n#endif\n\n#ifdef USE_SHADOW_MAPPING\nuniform sampler2D u_ShadowSampler;\n#endif\n\nvec2 getNormalUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_NORMAL_MAP\n    uv.xy = u_NormalUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_NORMAL_UV_TRANSFORM\n    uv = u_NormalUVTransform * uv;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getEmissiveUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_EMISSIVE_MAP\n    uv.xy = u_EmissiveUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_EMISSIVE_UV_TRANSFORM\n    uv = u_EmissiveUVTransform * uv;\n    #endif\n#endif\n\n    return uv.xy;\n}\n\nvec2 getOcclusionUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_OCCLUSION_MAP\n    uv.xy = u_OcclusionUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_OCCLUSION_UV_TRANSFORM\n    uv = u_OcclusionUVTransform * uv;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getBaseColorUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_BASE_COLOR_MAP\n    uv.xy = u_BaseColorUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_BASECOLOR_UV_TRANSFORM\n    uv = u_BaseColorUVTransform * uv;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getMetallicRoughnessUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\n    uv.xy = u_MetallicRoughnessUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_METALLICROUGHNESS_UV_TRANSFORM\n    uv = u_MetallicRoughnessUVTransform * uv;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getSpecularGlossinessUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\n    uv.xy = u_SpecularGlossinessUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_SPECULARGLOSSINESS_UV_TRANSFORM\n    uv = u_SpecularGlossinessUVTransform * uv;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getDiffuseUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_DIFFUSE_MAP\n    uv.xy = u_DiffuseUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_DIFFUSE_UV_TRANSFORM\n    uv = u_DiffuseUVTransform * uv;\n    #endif\n#endif\n    return uv.xy;\n}\n\n// textures.glsl needs to be included\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinReflectance = 0.04;\n\nFRAG_IN vec3 v_Position;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nFRAG_IN mat3 v_TBN;\n#else\nFRAG_IN vec3 v_Normal;\n#endif\n#endif\n\n#ifdef HAS_VERTEX_COLOR_VEC3\nFRAG_IN vec3 v_Color;\n#endif\n#ifdef HAS_VERTEX_COLOR_VEC4\nFRAG_IN vec4 v_Color;\n#endif\n\nstruct AngularInfo\n{\n    float NdotL;                  // cos angle between normal and light direction\n    float NdotV;                  // cos angle between normal and view direction\n    float NdotH;                  // cos angle between normal and half vector\n    float LdotH;                  // cos angle between light direction and half vector\n\n    float VdotH;                  // cos angle between view direction and half vector\n\n    vec3 padding;\n};\n\nvec4 getVertexColor()\n{\n   vec4 color = vec4(1.0, 1.0, 1.0, 1.0);\n\n#ifdef HAS_VERTEX_COLOR_VEC3\n    color.rgb = v_Color;\n#endif\n#ifdef HAS_VERTEX_COLOR_VEC4\n    color = v_Color;\n#endif\n\n   return color;\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nvec3 getNormal()\n{\n    vec2 UV = getNormalUV();\n\n    // Retrieve the tangent space matrix\n#ifndef HAS_TANGENTS\n    vec3 pos_dx = _dFdx(v_Position);\n    vec3 pos_dy = _dFdy(v_Position);\n    vec3 tex_dx = _dFdx(vec3(UV, 0.0));\n    vec3 tex_dy = _dFdy(vec3(UV, 0.0));\n    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n    vec3 ng = normalize(v_Normal);\n#else\n    vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n    t = normalize(t - ng * dot(ng, t));\n    vec3 b = normalize(cross(ng, t));\n    mat3 tbn = mat3(t, b, ng);\n#else // HAS_TANGENTS\n    mat3 tbn = v_TBN;\n#endif\n\n#ifdef HAS_NORMAL_MAP\n    vec3 n = _texture(u_NormalSampler, UV).rgb;\n    n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n    // The tbn matrix is linearly interpolated, so we need to re-normalize\n    vec3 n = normalize(tbn[2].xyz);\n#endif\n\n    return n;\n}\n\nfloat getPerceivedBrightness(vec3 vector)\n{\n    return sqrt(0.299 * vector.r * vector.r + 0.587 * vector.g * vector.g + 0.114 * vector.b * vector.b);\n}\n\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness/examples/convert-between-workflows/js/three.pbrUtilities.js#L34\nfloat solveMetallic(vec3 diffuse, vec3 specular, float oneMinusSpecularStrength) {\n    float specularBrightness = getPerceivedBrightness(specular);\n\n    if (specularBrightness < c_MinReflectance) {\n        return 0.0;\n    }\n\n    float diffuseBrightness = getPerceivedBrightness(diffuse);\n\n    float a = c_MinReflectance;\n    float b = diffuseBrightness * oneMinusSpecularStrength / (1.0 - c_MinReflectance) + specularBrightness - 2.0 * c_MinReflectance;\n    float c = c_MinReflectance - specularBrightness;\n    float D = b * b - 4.0 * a * c;\n\n    return clamp((-b + sqrt(D)) / (2.0 * a), 0.0, 1.0);\n}\n\nAngularInfo getAngularInfo(vec3 pointToLight, vec3 normal, vec3 view)\n{\n    // Standard one-letter names\n    vec3 n = normalize(normal);           // Outward direction of surface point\n    vec3 v = normalize(view);             // Direction from surface point to view\n    vec3 l = normalize(pointToLight);     // Direction from surface point to light\n    vec3 h = normalize(l + v);            // Direction of the vector between l and v\n\n    float NdotL = clamp(dot(n, l), 0.0, 1.0);\n    float NdotV = clamp(dot(n, v), 0.0, 1.0);\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n    return AngularInfo(\n        NdotL,\n        NdotV,\n        NdotH,\n        LdotH,\n        VdotH,\n        vec3(0, 0, 0)\n    );\n}\n\n#ifdef USE_SHADOW_MAPPING\nFRAG_IN vec4 v_PositionLightSpace;\n#endif\n\nfloat linstep(float low, float high, float v)\n{\n    return clamp((v-low) / (high-low), 0.0, 1.0);\n}\n\n#ifdef USE_SHADOW_MAPPING\nfloat getShadowContribution()\n{\n    vec3 coords = v_PositionLightSpace.xyz / v_PositionLightSpace.w * 0.5 + 0.5;\n    if (coords.z < 0.01 || coords.z > 0.99 || coords.x < 0.01 || coords.x > 0.99 || coords.y < 0.01 || coords.y > 0.99) {\n        return 1.0;\n    }\n    vec2 moments = vec2(1.0) - _texture(u_ShadowSampler, coords.xy).xy;\n    float p = step(coords.z, moments.x);\n    float variance = max(moments.y - moments.x * moments.x, 0.00002);\n    float d = coords.z - moments.x;\n    float pMax = linstep(0.2, 1.0, variance / (variance + d*d));\n    return min(max(p, pMax), 1.0);\n}\n#endif\nuniform float u_Exposure;\n\nconst float GAMMA = 2.2;\nconst float INV_GAMMA = 1.0 / GAMMA;\n\n// linear to sRGB approximation\n// see http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\nvec3 LINEARtoSRGB(vec3 color)\n{\n    return pow(color, vec3(INV_GAMMA));\n}\n\n// sRGB to linear approximation\n// see http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n    return vec4(pow(srgbIn.xyz, vec3(GAMMA)), srgbIn.w);\n}\n\n// Uncharted 2 tone map\n// see: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nvec3 toneMapUncharted2Impl(vec3 color)\n{\n    const float A = 0.15;\n    const float B = 0.50;\n    const float C = 0.10;\n    const float D = 0.20;\n    const float E = 0.02;\n    const float F = 0.30;\n    return ((color*(A*color+C*B)+D*E)/(color*(A*color+B)+D*F))-E/F;\n}\n\nvec3 toneMapUncharted(vec3 color)\n{\n    const float W = 11.2;\n    color = toneMapUncharted2Impl(color * 2.0);\n    vec3 whiteScale = 1.0 / toneMapUncharted2Impl(vec3(W));\n    return LINEARtoSRGB(color * whiteScale);\n}\n\n// Hejl Richard tone map\n// see: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nvec3 toneMapHejlRichard(vec3 color)\n{\n    color = max(vec3(0.0), color - vec3(0.004));\n    return (color*(6.2*color+.5))/(color*(6.2*color+1.7)+0.06);\n}\n\n// ACES tone map\n// see: https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/\nvec3 toneMapACES(vec3 color)\n{\n    const float A = 2.51;\n    const float B = 0.03;\n    const float C = 2.43;\n    const float D = 0.59;\n    const float E = 0.14;\n    return LINEARtoSRGB(clamp((color * (A * color + B)) / (color * (C * color + D) + E), 0.0, 1.0));\n}\n\nvec3 toneMap(vec3 color)\n{\n    color *= u_Exposure;\n\n#ifdef TONEMAP_UNCHARTED\n    return toneMapUncharted(color);\n#endif\n\n#ifdef TONEMAP_HEJLRICHARD\n    return toneMapHejlRichard(color);\n#endif\n\n#ifdef TONEMAP_ACES\n    return toneMapACES(color);\n#endif\n\n    return LINEARtoSRGB(color);\n}\n\n\n// KHR_lights_punctual extension.\n// see https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n\nstruct Light\n{\n    vec3 direction;\n    float range;\n\n    vec3 color;\n    float intensity;\n\n    vec3 position;\n    float innerConeCos;\n\n    float outerConeCos;\n    int type;\n\n    vec2 padding;\n};\n\nconst int LightType_Directional = 0;\nconst int LightType_Point = 1;\nconst int LightType_Spot = 2;\n\n#ifdef USE_PUNCTUAL\nuniform Light u_Lights[LIGHT_COUNT];\n#endif\n\n#if defined(MATERIAL_SPECULARGLOSSINESS) || defined(MATERIAL_METALLICROUGHNESS)\nuniform float u_MetallicFactor;\nuniform float u_RoughnessFactor;\nuniform vec4 u_BaseColorFactor;\n#endif\n\n#ifdef USE_INSTANCING\nFRAG_IN vec4 v_BaseColorFactor;\n#endif\n\n#ifdef MATERIAL_SPECULARGLOSSINESS\nuniform vec3 u_SpecularFactor;\nuniform vec4 u_DiffuseFactor;\nuniform float u_GlossinessFactor;\n#endif\n\n#ifdef ALPHAMODE_MASK\nuniform float u_AlphaCutoff;\n#endif\n\n#ifdef USE_SHADOW_MAPPING\nuniform int u_ShadowLightIndex;\n#endif\n\nuniform vec3 u_Camera;\n\nuniform int u_MipCount;\n\nstruct MaterialInfo\n{\n    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n    vec3 reflectance0;            // full reflectance color (normal incidence angle)\n\n    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n    vec3 diffuseColor;            // color contribution from diffuse lighting\n\n    vec3 reflectance90;           // reflectance color at grazing angle\n    vec3 specularColor;           // color contribution from specular lighting\n};\n\n// Calculation of the lighting contribution from an optional Image Based Light source.\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\n// See our README.md on Environment Maps [3] for additional discussion.\n#ifdef USE_IBL\nvec3 getIBLContribution(MaterialInfo materialInfo, vec3 n, vec3 v)\n{\n    float NdotV = clamp(dot(n, v), 0.0, 1.0);\n\n    float lod = clamp(materialInfo.perceptualRoughness * float(u_MipCount), 0.0, float(u_MipCount));\n    vec3 reflection = normalize(reflect(-v, n));\n\n    vec2 brdfSamplePoint = clamp(vec2(NdotV, materialInfo.perceptualRoughness), vec2(0.0, 0.0), vec2(1.0, 1.0));\n    // retrieve a scale and bias to F0. See [1], Figure 3\n    vec2 brdf = _texture(u_brdfLUT, brdfSamplePoint).rg;\n\n    vec4 diffuseSample = _texture(u_DiffuseEnvSampler, n);\n\n#ifdef USE_TEX_LOD\n    vec4 specularSample = _textureLod(u_SpecularEnvSampler, reflection, lod);\n#else\n    vec4 specularSample = _texture(u_SpecularEnvSampler, reflection);\n#endif\n\n#ifdef USE_HDR\n    // Already linear.\n    vec3 diffuseLight = diffuseSample.rgb;\n    vec3 specularLight = specularSample.rgb;\n#else\n    vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\n    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\n#endif\n\n    vec3 diffuse = diffuseLight * materialInfo.diffuseColor;\n    vec3 specular = specularLight * (materialInfo.specularColor * brdf.x + brdf.y);\n\n    return diffuse + specular;\n}\n#endif\n\n// Lambert lighting\n// see https://seblagarde.wordpress.com/2012/01/08/pi-or-not-to-pi-in-game-lighting-equation/\nvec3 diffuse(MaterialInfo materialInfo)\n{\n    return materialInfo.diffuseColor / M_PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(MaterialInfo materialInfo, AngularInfo angularInfo)\n{\n    return materialInfo.reflectance0 + (materialInfo.reflectance90 - materialInfo.reflectance0) * pow(clamp(1.0 - angularInfo.VdotH, 0.0, 1.0), 5.0);\n}\n\n// Smith Joint GGX\n// Note: Vis = G / (4 * NdotL * NdotV)\n// see Eric Heitz. 2014. Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs. Journal of Computer Graphics Techniques, 3\n// see Real-Time Rendering. Page 331 to 336.\n// see https://google.github.io/filament/Filament.md.html#materialsystem/specularbrdf/geometricshadowing(specularg)\nfloat visibilityOcclusion(MaterialInfo materialInfo, AngularInfo angularInfo)\n{\n    float NdotL = angularInfo.NdotL;\n    float NdotV = angularInfo.NdotV;\n    float alphaRoughnessSq = materialInfo.alphaRoughness * materialInfo.alphaRoughness;\n\n    float GGXV = NdotL * sqrt(NdotV * NdotV * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\n    float GGXL = NdotV * sqrt(NdotL * NdotL * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\n\n    float GGX = GGXV + GGXL;\n    if (GGX > 0.0)\n    {\n        return 0.5 / GGX;\n    }\n    return 0.0;\n}\n\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(MaterialInfo materialInfo, AngularInfo angularInfo)\n{\n    float alphaRoughnessSq = materialInfo.alphaRoughness * materialInfo.alphaRoughness;\n    float f = (angularInfo.NdotH * alphaRoughnessSq - angularInfo.NdotH) * angularInfo.NdotH + 1.0;\n    return alphaRoughnessSq / (M_PI * f * f);\n}\n\nvec3 getPointShade(vec3 pointToLight, MaterialInfo materialInfo, vec3 normal, vec3 view)\n{\n    AngularInfo angularInfo = getAngularInfo(pointToLight, normal, view);\n\n    if (angularInfo.NdotL > 0.0 || angularInfo.NdotV > 0.0)\n    {\n        // Calculate the shading terms for the microfacet specular shading model\n        vec3 F = specularReflection(materialInfo, angularInfo);\n        float Vis = visibilityOcclusion(materialInfo, angularInfo);\n        float D = microfacetDistribution(materialInfo, angularInfo);\n\n        // Calculation of analytical lighting contribution\n        vec3 diffuseContrib = (1.0 - F) * diffuse(materialInfo);\n        vec3 specContrib = F * Vis * D;\n\n        // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n        return angularInfo.NdotL * (diffuseContrib + specContrib);\n    }\n\n    return vec3(0.0, 0.0, 0.0);\n}\n\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_lights_punctual/README.md#range-property\nfloat getRangeAttenuation(float range, float distance)\n{\n    if (range <= 0.0)\n    {\n        // negative range means unlimited\n        return 1.0;\n    }\n    return max(min(1.0 - pow(distance / range, 4.0), 1.0), 0.0) / pow(distance, 2.0);\n}\n\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_lights_punctual/README.md#inner-and-outer-cone-angles\nfloat getSpotAttenuation(vec3 pointToLight, vec3 spotDirection, float outerConeCos, float innerConeCos)\n{\n    float actualCos = dot(normalize(spotDirection), normalize(-pointToLight));\n    if (actualCos > outerConeCos)\n    {\n        if (actualCos < innerConeCos)\n        {\n            return smoothstep(outerConeCos, innerConeCos, actualCos);\n        }\n        return 1.0;\n    }\n    return 0.0;\n}\n\nvec3 applyDirectionalLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view, float shadow)\n{\n    vec3 pointToLight = -light.direction;\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view) * shadow;\n    return light.intensity * light.color * shade;\n}\n\nvec3 applyPointLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view)\n{\n    vec3 pointToLight = light.position - v_Position;\n    float distance = length(pointToLight);\n    float attenuation = getRangeAttenuation(light.range, distance);\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view);\n    return attenuation * light.intensity * light.color * shade;\n}\n\nvec3 applySpotLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view, float shadow)\n{\n    vec3 pointToLight = light.position - v_Position;\n    float distance = length(pointToLight);\n    float rangeAttenuation = getRangeAttenuation(light.range, distance);\n    float spotAttenuation = getSpotAttenuation(pointToLight, light.direction, light.outerConeCos, light.innerConeCos);\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view) * shadow;\n    return rangeAttenuation * spotAttenuation * light.intensity * light.color * shade;\n}\n\n#ifdef WEBGL2\n    out vec4 FRAG_COLOR;\n#endif\n\nvoid main()\n{\n    // Metallic and Roughness material properties are packed together\n    // In glTF, these factors can be specified by fixed scalar values\n    // or from a metallic-roughness map\n    float perceptualRoughness = 0.0;\n    float metallic = 0.0;\n    vec4 baseColor = vec4(0.0, 0.0, 0.0, 1.0);\n    vec3 diffuseColor = vec3(0.0);\n    vec3 specularColor= vec3(0.0);\n    vec3 f0 = vec3(0.04);\n\n#ifdef MATERIAL_SPECULARGLOSSINESS\n\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\n    vec4 sgSample = SRGBtoLINEAR(_texture(u_SpecularGlossinessSampler, getSpecularGlossinessUV()));\n    perceptualRoughness = (1.0 - sgSample.a * u_GlossinessFactor); // glossiness to roughness\n    f0 = sgSample.rgb * u_SpecularFactor; // specular\n#else\n    f0 = u_SpecularFactor;\n    perceptualRoughness = 1.0 - u_GlossinessFactor;\n#endif // ! HAS_SPECULAR_GLOSSINESS_MAP\n\n#ifdef HAS_DIFFUSE_MAP\n    baseColor = SRGBtoLINEAR(_texture(u_DiffuseSampler, getDiffuseUV())) * u_DiffuseFactor;\n#else\n    baseColor = u_DiffuseFactor;\n#endif // !HAS_DIFFUSE_MAP\n\n    baseColor *= getVertexColor();\n\n    // f0 = specular\n    specularColor = f0;\n    float oneMinusSpecularStrength = 1.0 - max(max(f0.r, f0.g), f0.b);\n    diffuseColor = baseColor.rgb * oneMinusSpecularStrength;\n\n#ifdef DEBUG_METALLIC\n    // do conversion between metallic M-R and S-G metallic\n    metallic = solveMetallic(baseColor.rgb, specularColor, oneMinusSpecularStrength);\n#endif // ! DEBUG_METALLIC\n\n#endif // ! MATERIAL_SPECULARGLOSSINESS\n\n#ifdef MATERIAL_METALLICROUGHNESS\n\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\n    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n    vec4 mrSample = _texture(u_MetallicRoughnessSampler, getMetallicRoughnessUV());\n    perceptualRoughness = mrSample.g * u_RoughnessFactor;\n    metallic = mrSample.b * u_MetallicFactor;\n#else\n    metallic = u_MetallicFactor;\n    perceptualRoughness = u_RoughnessFactor;\n#endif\n\n    vec4 baseColorFactor = u_BaseColorFactor;\n#ifdef USE_INSTANCING\n    baseColorFactor = v_BaseColorFactor;\n#endif\n\n    // The albedo may be defined from a base texture or a flat color\n#ifdef HAS_BASE_COLOR_MAP\n    baseColor = SRGBtoLINEAR(_texture(u_BaseColorSampler, getBaseColorUV())) * baseColorFactor;\n#else\n    baseColor = baseColorFactor;\n#endif\n\n    baseColor *= getVertexColor();\n\n    diffuseColor = baseColor.rgb * (vec3(1.0) - f0) * (1.0 - metallic);\n\n    specularColor = mix(f0, baseColor.rgb, metallic);\n\n#endif // ! MATERIAL_METALLICROUGHNESS\n\n#ifdef ALPHAMODE_MASK\n    if(baseColor.a < u_AlphaCutoff)\n    {\n        discard;\n    }\n    baseColor.a = 1.0;\n#endif\n\n#ifdef ALPHAMODE_OPAQUE\n    baseColor.a = 1.0;\n#endif\n\n#ifdef MATERIAL_UNLIT\n    FRAG_COLOR = vec4(LINEARtoSRGB(baseColor.rgb) * baseColor.a, baseColor.a);\n    return;\n#endif\n\n    perceptualRoughness = clamp(perceptualRoughness, 0.0, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    // Roughness is authored as perceptual roughness; as is convention,\n    // convert to material roughness by squaring the perceptual roughness [2].\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    // Compute reflectance.\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    // Anything less than 2% is physically impossible and is instead considered to be shadowing. Compare to \"Real-Time-Rendering\" 4th editon on page 325.\n    vec3 specularEnvironmentR90 = vec3(clamp(reflectance * 50.0, 0.0, 1.0));\n\n    MaterialInfo materialInfo = MaterialInfo(\n        perceptualRoughness,\n        specularEnvironmentR0,\n        alphaRoughness,\n        diffuseColor,\n        specularEnvironmentR90,\n        specularColor\n    );\n\n    // LIGHTING\n\n    vec3 color = vec3(0.0, 0.0, 0.0);\n    vec3 normal = getNormal();\n    vec3 view = normalize(u_Camera - v_Position);\n\n    float shadow = 1.0;\n    #ifdef USE_SHADOW_MAPPING\n        shadow = getShadowContribution();\n    #endif\n\n#ifdef USE_PUNCTUAL\n    for (int i = 0; i < LIGHT_COUNT; ++i)\n    {\n        float shadowContribution = shadow;\n        #ifdef USE_SHADOW_MAPPING\n        if (u_ShadowLightIndex != i) \n        {\n            shadowContribution = 1.0;\n        }\n        #endif\n        Light light = u_Lights[i];\n        if (light.type == LightType_Directional)\n        {\n            color += applyDirectionalLight(light, materialInfo, normal, view, shadowContribution);\n        }\n        else if (light.type == LightType_Point)\n        {\n            color += applyPointLight(light, materialInfo, normal, view);\n        }\n        else if (light.type == LightType_Spot)\n        {\n            color += applySpotLight(light, materialInfo, normal, view, shadowContribution);\n        }\n    }\n#endif\n\n    // Calculate lighting contribution from image based lighting source (IBL)\n#ifdef USE_IBL\n    color += getIBLContribution(materialInfo, normal, view);\n#endif\n\n    float ao = 1.0;\n    // Apply optional PBR terms for additional (optional) shading\n#ifdef HAS_OCCLUSION_MAP\n    ao = _texture(u_OcclusionSampler,  getOcclusionUV()).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n    vec3 emissive = vec3(0);\n#ifdef HAS_EMISSIVE_MAP\n    emissive = SRGBtoLINEAR(_texture(u_EmissiveSampler, getEmissiveUV())).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifndef DEBUG_OUTPUT // no debug\n\n   // regular shading\n    FRAG_COLOR = vec4(toneMap(color) * baseColor.a, baseColor.a);\n\n#else // debug output\n\n    #ifdef DEBUG_METALLIC\n        FRAG_COLOR.rgb = vec3(metallic);\n    #endif\n\n    #ifdef DEBUG_ROUGHNESS\n        FRAG_COLOR.rgb = vec3(perceptualRoughness);\n    #endif\n\n    #ifdef DEBUG_NORMAL\n        #ifdef HAS_NORMAL_MAP\n            FRAG_COLOR.rgb = _texture(u_NormalSampler, getNormalUV()).rgb;\n        #else\n            FRAG_COLOR.rgb = vec3(0.5, 0.5, 1.0);\n        #endif\n    #endif\n\n    #ifdef DEBUG_BASECOLOR\n        FRAG_COLOR.rgb = LINEARtoSRGB(baseColor.rgb);\n    #endif\n\n    #ifdef DEBUG_OCCLUSION\n        FRAG_COLOR.rgb = vec3(ao);\n    #endif\n\n    #ifdef DEBUG_EMISSIVE\n        FRAG_COLOR.rgb = LINEARtoSRGB(emissive);\n    #endif\n\n    #ifdef DEBUG_F0\n        FRAG_COLOR.rgb = vec3(f0);\n    #endif\n\n    #ifdef DEBUG_ALPHA\n        FRAG_COLOR.rgb = vec3(baseColor.a);\n    #endif\n\n    FRAG_COLOR.a = 1.0;\n\n#endif // !DEBUG_OUTPUT\n}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialSkinUniforms=void 0;var r=n(24),o=function(){function e(){}return e.prototype.enableJointMatrixTextures=function(e){this._jointMatrixTexture||(this._jointMatrixTexture=new r.StandardMaterialMatrixTexture(e)),this._jointNormalTexture||(this._jointNormalTexture=new r.StandardMaterialMatrixTexture(e))},e.prototype.destroy=function(){var e,t;null===(e=this._jointNormalTexture)||void 0===e||e.destroy(!0),null===(t=this._jointMatrixTexture)||void 0===t||t.destroy(!0)},e.prototype.update=function(e,t){e.skin&&(this._jointMatrixTexture?(this._jointMatrixTexture.updateBuffer(e.skin.jointMatrices),t.uniforms.u_jointMatrixSampler=this._jointMatrixTexture):t.uniforms.u_jointMatrix=e.skin.jointMatrices,this._jointNormalTexture?(this._jointNormalTexture.updateBuffer(e.skin.jointNormalMatrices),t.uniforms.u_jointNormalMatrixSampler=this._jointNormalTexture):t.uniforms.u_jointNormalMatrix=e.skin.jointNormalMatrices)},e}();t.StandardMaterialSkinUniforms=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardMaterialFactory=void 0;var r=n(43),o=n(44),i=n(19),a=n(9),u=n(11),s=n(18),c=n(45),f=n(46),l=n(20),d=function(){function e(){}return e.prototype.create=function(e){var t=new u.StandardMaterial;if(!(e instanceof r.glTFMaterial))return t;switch(t.baseColor=a.Color.from(e.baseColor),e.baseColorTexture&&(t.baseColorTexture=new l.StandardMaterialTexture(e.baseColorTexture.baseTexture,e.baseColorTexture.texCoord),t.baseColorTexture.transform=this.createTextureTransform(e.baseColorTexture)),t.metallic=e.metallic,t.roughness=e.roughness,e.metallicRoughnessTexture&&(t.metallicRoughnessTexture=new l.StandardMaterialTexture(e.metallicRoughnessTexture.baseTexture,e.metallicRoughnessTexture.texCoord),t.metallicRoughnessTexture.transform=this.createTextureTransform(e.metallicRoughnessTexture)),t.emissive=a.Color.from(e.emissiveFactor),e.emissiveTexture&&(t.emissiveTexture=new l.StandardMaterialTexture(e.emissiveTexture.baseTexture,e.emissiveTexture.texCoord),t.emissiveTexture.transform=this.createTextureTransform(e.emissiveTexture)),e.alphaMode){case"BLEND":t.alphaMode=s.StandardMaterialAlphaMode.blend,t.renderSortType=i.MaterialRenderSortType.transparent;break;case"MASK":t.alphaMode=s.StandardMaterialAlphaMode.mask;break;case"OPAQUE":t.alphaMode=s.StandardMaterialAlphaMode.opaque}return t.unlit=e.unlit,t.doubleSided=e.doubleSided,t.alphaCutoff=e.alphaCutoff,e.normalTexture&&(t.normalTexture=new c.StandardMaterialNormalTexture(e.normalTexture.baseTexture,e.normalTexture.scale,e.normalTexture.texCoord),t.normalTexture.transform=this.createTextureTransform(e.normalTexture)),e.occlusionTexture&&(t.occlusionTexture=new f.StandardMaterialOcclusionTexture(e.occlusionTexture.baseTexture,e.occlusionTexture.strength,e.occlusionTexture.texCoord),t.occlusionTexture.transform=this.createTextureTransform(e.occlusionTexture)),t},e.prototype.createTextureTransform=function(e){if(e.transform){var t=new o.TextureTransform;return e.transform.offset&&(t.offset.x=e.transform.offset[0],t.offset.y=e.transform.offset[1]),void 0!==e.transform.rotation&&(t.rotation=e.transform.rotation),e.transform.scale&&(t.scale.x=e.transform.scale[0],t.scale.y=e.transform.scale[1]),t}},e}();t.StandardMaterialFactory=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mat3=void 0;var r=n(16),o=function(){function e(){}return e.multiply=function(e,t,n){return void 0===n&&(n=new Float32Array(9)),r.mat3.multiply(n,e,t)},e}();t.Mat3=o},function(e,t,n){"use strict";n.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAADAFBMVEX/AACvAwC4BgC1BQD7AAD3AQDzAQD+AAD9AAD8AQDpAQC/CACxAwD5BgDACwCtAwDxAQC9CADDEQCrAwC7BwC4AQDfAQB+AADvAQD1AQD7AwB7AABrAADHAQDCDgDiAQCyBQCRAQD5AAC1AQDYAQDNAQCpAQCUAQCeAQB0AABhAAD3BwCnAQDCBwCMAACOAAD6BABvAADFAgDsAQD4AACIAADEDADKAQDnAQCfAQCoAwDuEADqFACAAACFAACKAADzCwCCAAC/AQCbAgDKDQDwDgC9AQDBAgCiAAC7AQCkAADlAQD0CACzAQDjGwBoAADEFgB4AAD2CADGEQDGDADQAQDbAQDGCADSAQDNCwDWAQDdAQDUAQBlAAB2AADJCADBGgCVAgDOEADtAQBxAADSDADBFgCZAADnGADXDADcIgDKEgDDAQBcAADQLQCkAwDSEADPCADfHgClAgDXBwDTCADkDACYAAC9IACxLgCiAwCZAgDIFgDINgDdDADxCgDuCACSAQDnEADqCgCPAQBYAAC+HADYJgDLMACWAADOFgDbEQCtMwDSGwCGAADLBgC4JwDbGADaDADBIACoVQDRIQCgAgCxTQDHGwDVKQC6IwDCPACRbADGIQDMGwBUAADgEQDgBwDXEgDkFQDkBgCHdgDnCQDSFQC1KgDWFwDgFwDgDACaRwDCJwCcAADLKAC4LwC2RwDELwCYZADLIACkPQDcBgC9KACFXgDrEAB/ZQCoOgDGKAC+LgDYHACpTwC6QwCWTQB5bQCiWwCcAgCfQgBxdACMVgCzNAB9fwCeYADXIQC4NwC+NgCxOgCHbQCRUQDDNwCrOQDRJwCnRQCYWQCuQQBnfQC+QACNZABziwBskAAY4QCXAgB4hQBghgBllwC1QACtSACfTgBfngCPXABYpQChSAC7PAB/dwCeVABTkQBKnABRrABBuwA4wwBcjgBKtAByfAAxywBApQA3sAAo1QBshgAK8QAY0QBXmgAkxgBPpAAqugBFrgA1uwB98tmWAAAOvklEQVR4nO3Ye1jW5RnA8d+Wtmmews2yJTlXrVWUmUNLt5xSVrpygqJZQShMwqWYOHSWhvMwkSESRRaej5hT8ZiJpCvDI5annGYecmpaOWdhHnff93O6n+f3exFc17yubTfG1V9+P8/9/F54X73Tp/fs+fqfX37xj8///um+3X/bu27GjDfeWLT+ry+//OqrC9/56PXXX3hh9HPPvTZq1LPP9u//2GO9e7du3bpVq1YPPtimTZuOHTvfAVO7dtOmN9xwQ40aNb6P8z01XqXm/4DTp09//b+9gT2n91zZDezZc6U3sOcKb+CbKw745hvo/7cALkcAgLNwA198fsUAZ8+epUfg8081YNF/EnD2/NmzX14UN3AZG+j8LQDOn7948YsLdAO7964jwHof4DUOeKuSgEoJCPDVhQvn5CPgXsEHLqD3twy4eP4rGAM4OqNMAEqqBGgaCKiM4KLsnzvz7wIucwUIOHXqFAD2nagS4EEGCHkHlSBcwPypc8fPnDmxu7xcAtZXFtAxEFClS7iA/ePHj585se+T8r0nsY+vQgQsrAqA/zC2VnApwgXKHz9z7MSJ8vKT66oM6GwDggQVE85h/tgx6H+iALvoVVgJQBsNqOAOLiUAwLHj1P+k/OTJo0fLynYtWrQdAQeCAI+FBFyu4MyZYzjQ37lTAbYDoAQ28M47RwAw2g94CwFD1UMQBHAFoQ0EOCH7a9dAf9eu7ds/gwUcsAGjLEArDehMAHEHFQpCIPadwDr2d0IfF4B9Adh/5MgmDdggANM4IPAOKhIEMPbp/tq1a9esWbFr1yEEHATA/v1HPpKArQLQXwBaM4C6g6oILM1umRf9MgUoEYAjHPCsAfCHwFqBJagMwSsvL9+p+2tWLN91CAEHAbBDAIoAsHXraxsUYFqGfQfOCmzBpQme6K8V+1+xAvqH8AYObyPAJgLMl4DC/oUIyNCAoXwFwYJLGby9J+HhXyvPv2L58kOHtsACDpZs2wGAjQgoQsDWDRtWwQYKC6dN660BQ4cGrUAIOKEihLdO9CmP/fcPbVl9EBagAEVFRfMBkEeAQgRMQwAKhqKAraBJU74DhxBK4a07KvKiv/z997cA4DABNm+0AatyJECuYJgEKEETJahWrUYIQ8DviaNH1xwVedO3ASsJkAeA/oV0BxkZGbiCYQgY2rGjuITqtWs3byIJ1aoZQqCBabwZKi/6CFgt+wgoFhvII0COWIEGGAEAqtdurgRNqlmEChFeWVkZy8u+BhQX0wbmWwApGNbKABre0bB69eYkAEITIbAMoRQIKMO6Of+bb7733ra3P9y8uXTjgmIQrFzpBwzPGP7WMLaChjDVDQG/BRkCJN4b8MtH1k1/yRIDmAeAxQDIQgAIJtMGADA8tEBMtWqhERri7cI5dEjkZf+9JW8DoLR0AQDm+QCTBQBGCOoRoaEhMINBhHJ4i/Bnn8xTXy6AAxYbQM5kAAy0BTBXw4Qg2Agfw4O3PyDYIvK6//aHY0s5YPHEvKw5c1YJwOSBAwcKAAmuB0A9LQgkuAhG8dZvhxF1kRcLGDsW+wuWLQNAAQDysrJAAIBMIcjImKkFQ68fWq/j1RaBDC4iEEKA1dtlXpyfFjB2EADGIaAAARMJMDUnM1OtYOZMtoJ6MA4hpMF2eJ/hrD64+k19fNEfO2jQbAUAwcSJCJgzNVMLZhoBGhwCM4RU0CDgIIy/X0p9CZgoATlCMHeuLbgepp5LEAaFCKXwXj5Ygj/7Dx+WeeiPpfMPmj2bALkCkJU1a9asOVMVgAvu9RG0QSK0ws/wSkpKDsu+yBNA9MdNWJaeC4D8fNjAmFlZCEDBi3O1gAj39uw5rKcmuAaFMAoOAcDhkm0wS7aZvOqPW5aePk8DxsAKJEAKpmsBEHoSga+BIwzDcjRv7h04cIDnqY8PIC1gQjpuIB8BYyyAEExHQc2ZNYfXvNclaIOFYAwlQcCBHdu2URx+/snzE2CCAOQCYIjcQD8QjM8cLwXTpxNhZs2aKDAEaTAIR8Eh3sIDO2g+xBlr+uNEHwDxCBgyhlbQDwTJ48cLwZQpStByuCHYBoYIYMB4C/djfbPKD1LHFxcAgHgBSEFAPwAkJyvBlCmS0KFlSyS4Bo2wFI7D2w+zGWdsqdtHwMj43PhO0EdAQgIA+iVrwZQpFqGmJAiDD+EyJEQD4HdPqcrLPgBGjoyPj+/UCQEpCQkkSHQE02k6KEKAwVK4DO/Ikf0bN5ZSvlTl9QNAfQB0QoAUJCrB0qVLzQ46dCACM0iEUVgMDQHARhwSLJhtHV8vQAJIkJjIBZJwUwiDQjCF65CABTSiLvoT0kdCHwBJkDeAxEQlGCAE0nCTFDCDi7AZyuFtwllAgtnjFjh57Cc5G0BDWlryABwh6IEAmg7GIBFKwRi2w/sA+8ViAzovnj8EJBEgOjoaAVHqDkCQNmDAeC3o0aBBkEEhtIIzeirAB5uKN8Gb3+JlOLpu+hKAhKjuOImpBEgbwJeAhgYNLINEaIVhcAcAioqpD4IJSEhPF4+f6gMgDPPRKVFRJEhNlQJJ6Np1aVcUEEEaNEIpDIM5UOLBR6+i4iK5gGWyrvpiA2FhtIGoaFcgAANuvrkrInr0sPbAEEEM5fBeQME8GpkXdXX+pKQwBaDpLgmpaS4Bpoe7CEuhGRzijSZA0Tx46wNf6bmqD6cfqfpCEBMVowipqZrw5JNCoAwMYRQWgzlaImD0ShzcQK6Yker1Z/oIiIkhQTYTkOFJmCeeGPDEzS7Cp3AcAuKNnj9aAApyhSCeJkn35QoiY3DioqLi4rKzu2cLQrfULt26pXUTBhhmsBUWw3J48Nl7PgDgnWeBvy/rYeFhkTAkoMmmIUOXLmDoRgaDcBWKYTsI4j1HggI58fG5/PyqHx4eKQWxcUEEMrgIo1AM7WAQbyv0F8+nem5BfH7g+RUgMiYWhgGyb7lFAAIQUsEY2mEgDQAAAvjotbgA3/zmF+R3gt9++vxJ4bB904+MlWMbYCyEUIRkMAhIALB1MU1BPgri8/F3j9p+nSTR9wli+UU4CEshGcphQ1Di4T+ACUE+Tic58vEPNxPpGgSiRYsW2dktblHTJZihHBqiJd7WPCGYKABKIG6/TlIditP3iIjICJjY2AgJaNSoURz810JNgEIytENDtMTLy8P+RBx895vP+2EyXocmIjxCT7NmzWLhT2xss0Y0LfwKy6Egfok3Ko+GBPDecwjrh1t9EKiJlQY9jVwGdwRCtMTbkLdB5qkP7770+cOsvEWQ06dPAIM7QkI0xduwAf/1JcsIojtFq3yS069zjRxot2/fnr6179PHZgQ6LIhFAQDk87LGjNEAGHMBTllPe3f6WJBG1rSowOKtWoWCiVn42S8lRfSjzQOg+9daQ4i2OMESzWlUEaWFAKzCKxCAISkKEM4X4NTlPKSmbVsfpY89AVtRGASskn3YgALwPo/+gM0j1z7ykG/asgm09HHuCAFz5mTNmiUBKSkuILgO/aCpqqZPMy8HAXMMgG2g6v2KOG2DOV5OjgCAIIEAQAiL9PV1+Lt8fhhiqgACQI4AzEpIUBuAXzl2P6BdUb/SJHB4hQYgriAK+5G8789fJeYnlZlLoDiANhAVHRPQ97Vxfl3ZqciFgBwCwOfOlAT4+BWjAeb4/vhVVzWmv7tx48Y8VUtO5WUEmDp1zqx++MlX98PVj5+gfGM1svadKkwtNmTwCguhP3Vqv34JQIhiC3D6dtzXrRtybEBd+aUHATkCADcAnz8V4Bp1Ab48a/NQ/VBzq/1Vt775ql+/LgIy3Q3wBZi8rNttq1T1qX8rADIlICGKAGwBvM/PbrXZX3e/nDsrnkfpjxxvWmFmjtpAlAbQr1+nz+tW3G0+b+bRS443bbLeALsBp6/zfOsmjak7Te/hwLlPfuEfNgTI1IAYC8D7Tp7i+rR9+wZkX1Fznzu34cj/B8BkAUhM6C5fhE6/sezrPB1dxfv27Tt48GAryiowf6lg2rVrpwGJGhBBAKtv57Eu44NpXnnlYRW+ze62k/PbkCMByQDorgF6AVaf8verel9ZV2dmXTf5ezEfq/kTHwFITsYFdKfXAFuA7rt5FtdtWeZRlntGzE/VvKTGBsQhIIIWENCnZ17nRR3K74q2KausSb7E5sdq/kjDAVEAiBU3IBeg+ip/P+bl4eno78KoY4u0DPMqy8m5W85dd92FgBcJQDcA/Yg61gJ438qr+h9UW6RNmVdVTs8DarwMAIxXgFi2AKtv52Ud4jAyTm23zLM6+cDP+ViAOPjszxbg9k2ezi7qIq7OrdIm7Eb/bOaXOA5APIJiAVZfHV/m6fCmzto6bYWtJs6v1HgZAzUgLk7dgLwA3rfydHiqO3GTtsJu9RdmADCXAKnyBtgC3D48eioPh6ezm7qImzYvO9nr+AQC1AU4fXr0VF5unuombtqs7O/+yIwNiIyANwJsAbIv13+buHuZ99V13LSdsMn+Rs3TEpAGAHoEQvX18Vle1dXRVdzfdsNPi/kZjA2I4AC8ANaX2w/KO3HetsumK6dXLw2AF4F4BCrq06On825dxe12ULmXmHtgHIBeAF2A24cXXnDe1EO07fI9em68UQFSu2drAFuA7os89WXeqeujO20rzcJqLIC5AbmA55+nPj++P8/PruPs3Fb6RjaP4xgAPoNqAbVUv29AXyyf8vrwvjo7tz/9uJqnnnrKG64B4gbEAswFqP4zKn+3nXfr+uSBbVamuf12CUjkAL2Avub+nzHHD8izuj65G/elxTgbEDeACxAPQIi+P8/q5ujB7dutEYC0tNTsuKAFsH6IvDy8r27HA9q/EyMBiRyAL4FL9HneHN49Oo8HtGFGjCBAMgPQDcAC6ALg5w/vh8zze684ztJiFKA7/RTAR4BugBaALwDTt4+v887hWd2N+9ojRkyaNIkAA+gZjIiQN0ALUBfg9HX+OjsfWPfHrTYNB4gbkAugC4D+x9QX128f38mHrPvik/gogH4EGtfSC4ALkH08v1y/yYu77+XmA+vBcZx/AeDdATn/vA1ZAAAAAElFTkSuQmCC"},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.glTFParser=void 0;var o=n(0),i=o.__importStar(n(1)),a=n(14),u=n(82),s=n(83),c=n(43),f=n(7),l=n(2),d=n(11),h=n(10),p=n(29),_=n(23),m=n(49),v=n(50),g=function(){function e(e,t){var n;this._textures=[],this._asset=e,this._materialFactory=t||d.StandardMaterial,this._descriptor=this._asset.descriptor;for(var r=0;r<(null===(n=this._descriptor.textures)||void 0===n?void 0:n.length);r++)this._textures.push(this.parseTexture(r))}return e.createModel=function(t,n){return new e(t,n).parseModel()},e.createMesh=function(t,n,r){return void 0===r&&(r=0),new e(t,n).parseMesh(r)},e.prototype.parseBuffer=function(e){if(void 0!==e){"number"==typeof e&&(e=this._asset.descriptor.accessors[e]);var t=this._descriptor.bufferViews[e.bufferView||0],n=e.byteOffset||0;void 0!==t.byteOffset&&(n+=t.byteOffset);var r=e.count*b[e.type];void 0!==t.byteStride&&0!==t.byteStride&&(r=t.byteStride/y[e.componentType]*(e.count-1)+b[e.type]);var o=this._asset.buffers[t.buffer];return s.glTFAttribute.from(e.componentType,o,n,r,t.byteStride,e.min,e.max)}},e.prototype.parseAnimation=function(e,t){var n,r;"number"==typeof e&&(e=this._asset.descriptor.animations[e]);var i=[];try{for(var s=o.__values(e.channels),c=s.next();!c.done;c=s.next()){var f=c.value,l=e.samplers[f.sampler],d=this.parseBuffer(l.input);if(void 0!==d){var h=this.parseBuffer(l.output);if(void 0!==h){var p=a.glTFChannel.from(d.buffer,h.buffer,l.interpolation||"LINEAR",f.target.path,t[f.target.node]);p&&i.push(p)}}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return new u.glTFAnimation(i,e.name)},e.prototype.parseMaterial=function(e){"number"==typeof e&&(e=this._asset.descriptor.materials[e]);var t=new c.glTFMaterial;if(!e)return this._materialFactory.create(t);void 0!==e.occlusionTexture&&(t.occlusionTexture=this._textures[e.occlusionTexture.index].clone(),t.occlusionTexture.strength=e.occlusionTexture.strength,t.occlusionTexture.texCoord=e.occlusionTexture.texCoord,e.occlusionTexture.extensions&&e.occlusionTexture.extensions.KHR_texture_transform&&(t.occlusionTexture.transform=e.occlusionTexture.extensions.KHR_texture_transform,void 0!==e.occlusionTexture.extensions.KHR_texture_transform.texCoord&&(t.occlusionTexture.texCoord=e.occlusionTexture.extensions.KHR_texture_transform.texCoord))),void 0!==e.normalTexture&&(t.normalTexture=this._textures[e.normalTexture.index].clone(),t.normalTexture.scale=e.normalTexture.scale||1,t.normalTexture.texCoord=e.normalTexture.texCoord,e.normalTexture.extensions&&e.normalTexture.extensions.KHR_texture_transform&&(t.normalTexture.transform=e.normalTexture.extensions.KHR_texture_transform,void 0!==e.normalTexture.extensions.KHR_texture_transform.texCoord&&(t.normalTexture.texCoord=e.normalTexture.extensions.KHR_texture_transform.texCoord))),void 0!==e.emissiveTexture&&(t.emissiveTexture=this._textures[e.emissiveTexture.index].clone(),t.emissiveTexture.texCoord=e.emissiveTexture.texCoord,e.emissiveTexture.extensions&&e.emissiveTexture.extensions.KHR_texture_transform&&(t.emissiveTexture.transform=e.emissiveTexture.extensions.KHR_texture_transform,void 0!==e.emissiveTexture.extensions.KHR_texture_transform.texCoord&&(t.emissiveTexture.texCoord=e.emissiveTexture.extensions.KHR_texture_transform.texCoord))),void 0!==e.doubleSided&&(t.doubleSided=e.doubleSided),e.emissiveFactor&&(t.emissiveFactor=e.emissiveFactor),e.alphaMode&&(t.alphaMode=e.alphaMode),void 0!==e.alphaCutoff&&(t.alphaCutoff=e.alphaCutoff);var n=e.pbrMetallicRoughness;return void 0!==(null==n?void 0:n.metallicRoughnessTexture)&&(t.metallicRoughnessTexture=this._textures[n.metallicRoughnessTexture.index].clone(),t.metallicRoughnessTexture.texCoord=n.metallicRoughnessTexture.texCoord,n.metallicRoughnessTexture.extensions&&n.metallicRoughnessTexture.extensions.KHR_texture_transform&&(t.metallicRoughnessTexture.transform=n.metallicRoughnessTexture.extensions.KHR_texture_transform,void 0!==e.metallicRoughnessTexture.extensions.KHR_texture_transform.texCoord&&(t.metallicRoughnessTexture.texCoord=e.metallicRoughnessTexture.extensions.KHR_texture_transform.texCoord))),(null==n?void 0:n.baseColorFactor)&&(t.baseColor=n.baseColorFactor),void 0!==(null==n?void 0:n.baseColorTexture)&&(t.baseColorTexture=this._textures[n.baseColorTexture.index].clone(),t.baseColorTexture.texCoord=n.baseColorTexture.texCoord,n.baseColorTexture.extensions&&n.baseColorTexture.extensions.KHR_texture_transform&&(t.baseColorTexture.transform=n.baseColorTexture.extensions.KHR_texture_transform,void 0!==n.baseColorTexture.extensions.KHR_texture_transform.texCoord&&(t.baseColorTexture.texCoord=n.baseColorTexture.extensions.KHR_texture_transform.texCoord))),void 0!==(null==n?void 0:n.metallicFactor)&&(t.metallic=n.metallicFactor),void 0!==(null==n?void 0:n.roughnessFactor)&&(t.roughness=n.roughnessFactor),e.extensions&&(t.unlit=void 0!==e.extensions.KHR_materials_unlit),this._materialFactory.create(t)},e.prototype.parseTexture=function(e){var t=this._descriptor.textures[e],n=this._asset.images[t.source],r=new i.Texture(new i.BaseTexture(n.baseTexture.resource,{wrapMode:i.WRAP_MODES.REPEAT,alphaMode:i.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA}));if(this._descriptor.samplers&&void 0!==t.sampler)switch(this._descriptor.samplers[t.sampler].wrapS){case 10497:r.baseTexture.wrapMode=i.WRAP_MODES.REPEAT;break;case 33648:r.baseTexture.wrapMode=i.WRAP_MODES.MIRRORED_REPEAT;break;case 33071:r.baseTexture.wrapMode=i.WRAP_MODES.CLAMP}return r},e.prototype.parseMesh=function(e){var t=this;"number"==typeof e&&(e=this._asset.descriptor.meshes[e]);var n=e.weights||[];return e.primitives.map((function(r){return Object.assign(t.parsePrimitive(r),{name:e.name,targetWeights:n})}))},e.prototype.parseSkin=function(e,t,n){return"number"==typeof e&&(e=this._asset.descriptor.skins[e]),new m.Skin(t,e.joints.map((function(e){return n[e]})))},e.prototype.parsePrimitive=function(e){for(var t,n=e.attributes,r=e.targets,o=Object.assign(new h.MeshGeometry3D,{indices:this.parseBuffer(e.indices),positions:this.parseBuffer(n.POSITION),normals:this.parseBuffer(n.NORMAL),tangents:this.parseBuffer(n.TANGENT),joints:this.parseBuffer(n.JOINTS_0),weights:this.parseBuffer(n.WEIGHTS_0)}),i=0;;i++){var a=this.parseBuffer(n["TEXCOORD_"+i]);if(void 0===a)break;o.uvs=o.uvs||[],o.uvs.push(a)}if(r)for(i=0;i<r.length;i++)o.targets=o.targets||[],o.targets.push({positions:this.parseBuffer(r[i].POSITION),normals:this.parseBuffer(r[i].NORMAL),tangents:this.parseBuffer(r[i].TANGENT)});return t=void 0!==e.material?this.parseMaterial(this._asset.descriptor.materials[e.material]):this.parseMaterial(),new f.Mesh3D(o,t)},e.prototype.parseNode=function(e){var t,n,r,i=this._asset.descriptor.nodes[e];try{for(var a=o.__values(this._asset.descriptor.skins||[]),u=a.next();!u.done;u=a.next()){var s=u.value,c=s.joints.indexOf(e);if(c>=0){var f=this.parseBuffer(s.inverseBindMatrices),d=null==f?void 0:f.buffer.slice(16*c,16*c+16);r=Object.assign(new v.Joint(d),{name:i.name})}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}var h=r||Object.assign(new l.Container3D,{name:i.name});return i.translation&&h.position.set(i.translation[0],i.translation[1],i.translation[2]),i.rotation&&h.rotationQuaternion.set(i.rotation[0],i.rotation[1],i.rotation[2],i.rotation[3]),i.scale&&h.scale.set(i.scale[0],i.scale[1],i.scale[2]),i.matrix&&h.transform.setFromMatrix(new _.Matrix4(i.matrix)),h},e.prototype.parseModel=function(){var e,t,n,r,i=this,a=this._descriptor.nodes.map((function(e,t){return i.parseNode(t)})),u=this._descriptor.scenes[this._asset.descriptor.scene||0],s=new p.Model,c=function(e,t){var n,r,u,f,l,d=i._asset.descriptor.nodes[t].mesh;if(void 0!==i._asset.descriptor.nodes[t].skin&&(l=i.parseSkin(i._asset.descriptor.nodes[t].skin,a[t],a)),void 0!==d)try{for(var h=o.__values(i.parseMesh(d)),p=h.next();!p.done;p=h.next()){var _=p.value;s.meshes.push(a[t].addChild(_)),s.meshes[s.meshes.length-1].skin=l}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}if(e.addChild(a[t]),i._asset.descriptor.nodes[t].children)try{for(var m=o.__values(i._asset.descriptor.nodes[t].children),v=m.next();!v.done;v=m.next()){var g=v.value;c(a[t],g)}}catch(e){u={error:e}}finally{try{v&&!v.done&&(f=m.return)&&f.call(m)}finally{if(u)throw u.error}}};try{for(var f=o.__values(u.nodes),l=f.next();!l.done;l=f.next()){var d=l.value;c(s,d)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=f.return)&&t.call(f)}finally{if(e)throw e.error}}if(this._asset.descriptor.animations)try{for(var h=o.__values(this._asset.descriptor.animations),_=h.next();!_.done;_=h.next()){var m=_.value;s.animations.push(this.parseAnimation(m,a))}}catch(e){n={error:e}}finally{try{_&&!_.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}return s},e}();t.glTFParser=g;var b={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},y=((r={})[5120]=1,r[5121]=1,r[5122]=2,r[5123]=2,r[5125]=4,r[5126]=4,r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFLinear=void 0;var r=n(0),o=function(e){function t(t,n){var r=e.call(this)||this;return r._output=t,r._stride=n,r._data=new Float32Array(n),r}return r.__extends(t,e),t.prototype.interpolate=function(e,t){for(var n=(e+0)*this._stride,r=(e+1)*this._stride,o=0;o<this._stride;o++)this._output.length>r?this._data[o]=(1-t)*this._output[n+o]+t*this._output[r+o]:this._data[o]=this._output[n+o];return this._data},t}(n(15).glTFInterpolation);t.glTFLinear=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFCubicSpline=void 0;var r=n(0),o=function(e){function t(t,n,r){var o=e.call(this)||this;return o._input=t,o._output=n,o._stride=r,o._data=new Float32Array(r),o}return r.__extends(t,e),t.prototype.interpolate=function(e,n){for(var r=this._input[e+1]-this._input[e],o=(e+0)*this._stride*3,i=(e+1)*this._stride*3,a=0;a<this._stride;a++)this._data[a]=t.calculate(n,this._output[o+a+1*this._stride],this._output[i+a+1*this._stride],r*this._output[i+a],r*this._output[o+a+2*this._stride]);return this._data},t.calculate=function(e,t,n,r,o){return(2*Math.pow(e,3)-3*Math.pow(e,2)+1)*t+(Math.pow(e,3)-2*Math.pow(e,2)+e)*r+(-2*Math.pow(e,3)+3*Math.pow(e,2))*n+(Math.pow(e,3)-Math.pow(e,2))*o},t}(n(15).glTFInterpolation);t.glTFCubicSpline=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFStep=void 0;var r=n(0),o=function(e){function t(t,n){var r=e.call(this)||this;return r._output=t,r._stride=n,r._data=new Float32Array(n),r}return r.__extends(t,e),t.prototype.interpolate=function(e){for(var t=0;t<this._stride;t++)this._data[t]=this._output[e*this._stride+t];return this._data},t}(n(15).glTFInterpolation);t.glTFStep=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFSphericalLinear=void 0;var r=n(0),o=n(6),i=function(e){function t(t){var n=e.call(this)||this;return n._output=t,n._data=new Float32Array(4),n}return r.__extends(t,e),t.prototype.interpolate=function(e,t){var n=4*(e+0),r=4*(e+1),i=o.Quat.set(this._output[n],this._output[n+1],this._output[n+2],this._output[n+3],new Float32Array(4));if(this._output.length<=r)return o.Quat.normalize(i,this._data);var a=o.Quat.set(this._output[r],this._output[r+1],this._output[r+2],this._output[r+3],new Float32Array(4));return o.Quat.normalize(o.Quat.slerp(i,a,t,this._data),this._data)},t}(n(15).glTFInterpolation);t.glTFSphericalLinear=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFScale=void 0;var r=n(0),o=function(e){function t(t,n,r){var o=e.call(this,n,r)||this;return o._transform=t,o}return r.__extends(t,e),t.prototype.updateTarget=function(e){this._transform.scale.set(e[0],e[1],e[2])},t}(n(14).glTFChannel);t.glTFScale=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFWeights=void 0;var r=n(0),o=function(e){function t(t,n,r){var o=e.call(this,n,r)||this;return o._weights=t,o}return r.__extends(t,e),t.prototype.updateTarget=function(e){for(var t=0;t<e.length;t++)this._weights[t]=e[t]},t}(n(14).glTFChannel);t.glTFWeights=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFRotation=void 0;var r=n(0),o=function(e){function t(t,n,r){var o=e.call(this,n,r)||this;return o._transform=t,o}return r.__extends(t,e),t.prototype.updateTarget=function(e){this._transform.rotationQuaternion.set(e[0],e[1],e[2],e[3])},t}(n(14).glTFChannel);t.glTFRotation=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFTranslation=void 0;var r=n(0),o=function(e){function t(t,n,r){var o=e.call(this,n,r)||this;return o._transform=t,o}return r.__extends(t,e),t.prototype.updateTarget=function(e){this._transform.position.set(e[0],e[1],e[2])},t}(n(14).glTFChannel);t.glTFTranslation=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFAnimation=void 0;var r=n(0),o=function(e){function t(t,n){var o,i,a=e.call(this,n)||this;a._duration=0,a._position=0,a._channels=[];try{for(var u=r.__values(t),s=u.next();!s.done;s=u.next()){var c=s.value;a._duration=Math.max(a._duration,c.duration)}}catch(e){o={error:e}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return a._channels=t,a}return r.__extends(t,e),Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){var t,n;this._position=e;try{for(var o=r.__values(this._channels),i=o.next();!i.done;i=o.next()){i.value.position=this._position}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},enumerable:!1,configurable:!0}),t}(n(48).Animation);t.glTFAnimation=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glTFAttribute=void 0;var r=function(){function e(e,t,n,r,o){void 0===n&&(n=0),this.buffer=e,this.componentType=t,this.stride=n,this.min=r,this.max=o}return e.from=function(t,n,r,o,i,a,u){switch(t){case 5125:return new e(new Uint32Array(n,r,o),t,i,a,u);case 5126:return new e(new Float32Array(n,r,o),t,i,a,u);case 5120:return new e(new Int8Array(n,r,o),t,i,a,u);case 5121:return new e(new Uint8Array(n,r,o),t,i,a,u);case 5122:return new e(new Int16Array(n,r,o),t,i,a,u);case 5123:return new e(new Uint16Array(n,r,o),t,i,a,u);default:throw new Error('PIXI3D: Unknown component type "'+t+'".')}},e}();t.glTFAttribute=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Light=void 0;var r=n(0),o=n(9),i=n(2),a=n(12),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=a.LightType.point,t.color=new o.Color(1,1,1),t.range=10,t.intensity=10,t.innerConeAngle=0,t.outerConeAngle=45,t}return r.__extends(t,e),t}(i.Container3D);t.Light=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardPipeline=void 0;var r=n(0),o=n(1),i=n(52),a=n(53),u=n(54),s=n(29),c=n(11),f=n(19),l=function(e){function t(t){var n=e.call(this,t)||this;return n.renderer=t,n._meshes=[],n.materialPass=new i.MaterialRenderPass(n.renderer,"material"),n.shadowPass=new a.ShadowRenderPass(n.renderer,"shadow"),n.renderPasses=[n.shadowPass,n.materialPass],t.on("prerender",(function(){var e,t;try{for(var o=r.__values(n.renderPasses),i=o.next();!i.done;i=o.next()){var a=i.value;a.clear&&a.clear()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}})),n}return r.__extends(t,e),t.prototype.createPostProcessingSprite=function(e){var t=new u.PostProcessingSprite(this.renderer,e);return this.materialPass.renderTexture=t.renderTexture,t},t.prototype.render=function(e){this._meshes.push(e)},t.prototype.flush=function(){var e,t;this.sort();var n=function(e){e.render(o._meshes.filter((function(t){return t.isRenderPassEnabled(e.name)})))},o=this;try{for(var i=r.__values(this.renderPasses),a=i.next();!a.done;a=i.next()){n(a.value)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this._meshes=[]},t.prototype.sort=function(){this._meshes.sort((function(e,t){return e.material&&t.material?e.material.renderSortType!==t.material.renderSortType?e.material.renderSortType===f.MaterialRenderSortType.transparent?1:-1:e.renderSortOrder-t.renderSortOrder:0}))},t.prototype.enableShadows=function(e,t){var n,o,i=e instanceof s.Model?e.meshes:[e];try{for(var a=r.__values(i),u=a.next();!u.done;u=a.next()){var f=u.value;t&&f.material instanceof c.StandardMaterial&&(f.material.shadowCastingLight=t),f.enableRenderPass(this.shadowPass.name)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}t&&this.shadowPass.addShadowCastingLight(t)},t.prototype.disableShadows=function(e){var t,n,o=e instanceof s.Model?e.meshes:[e];try{for(var i=r.__values(o),a=i.next();!a.done;a=i.next()){var u=a.value;u.material instanceof c.StandardMaterial&&(u.material.shadowCastingLight=void 0),u.disableRenderPass(this.shadowPass.name)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t}(o.ObjectRenderer);t.StandardPipeline=l,o.Renderer.registerPlugin("pipeline",l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowFilter=void 0;var r=n(1),o=n(8),i=n(7),a=function(){function e(e){this.renderer=e,this._mesh=i.Mesh3D.createQuad(),this._gaussianBlurShader=new o.MeshShader(r.Program.from(n(87),n(88)))}return e.prototype.applyGaussianBlur=function(e){this.applyBlurScale(e.shadowTexture,e.filterTexture,new Float32Array([0,e.softness/e.shadowTexture.height])),this.applyBlurScale(e.filterTexture,e.shadowTexture,new Float32Array([e.softness/e.shadowTexture.width,0]))},e.prototype.applyBlurScale=function(e,t,n){this.renderer.renderTexture.bind(t),this.renderer.renderTexture.clear(),this._gaussianBlurShader.uniforms.u_FilterSampler=e,this._gaussianBlurShader.uniforms.u_BlurScale=n,this._gaussianBlurShader.render(this._mesh,this.renderer),this.renderer.renderTexture.bind(void 0)},e}();t.ShadowFilter=a},function(e,t){e.exports="#version 100\n\nattribute vec3 a_Position;\nattribute vec2 a_UV1;\n\nvarying vec2 v_UV1;\n\nvoid main() {\n  v_UV1 = a_UV1;\n  gl_Position = vec4(a_Position, 1.0);\n}"},function(e,t){e.exports="#version 100\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvarying vec2 v_UV1;\n\nuniform vec2 u_BlurScale;\nuniform sampler2D u_FilterSampler;\n\nvoid main() {\n  vec4 color = vec4(0.0);\n\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-3.0) * u_BlurScale.xy)) * (1.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-2.0) * u_BlurScale.xy)) * (6.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-1.0) * u_BlurScale.xy)) * (15.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+0.0) * u_BlurScale.xy)) * (20.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+1.0) * u_BlurScale.xy)) * (15.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+2.0) * u_BlurScale.xy)) * (6.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+3.0) * u_BlurScale.xy)) * (1.0/64.0);\n\n  gl_FragColor = color;\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowRenderer=void 0;var r=n(1),o=n(30),i=n(92),a=n(93),u=n(26),s=n(39),c=function(){function e(e){this.renderer=e,this._state=Object.assign(new r.State,{depthTest:!0,clockwiseFrontFace:!1,culling:!0,blendMode:r.BLEND_MODES.NONE}),this._shadowShader=new o.ShadowShader(this.renderer)}return e.prototype.getSkinningShader=function(){return this._textureShader||this._skinningShader?this._textureShader||this._skinningShader:(a.TextureShader.isSupported(this.renderer)?this._textureShader=new a.TextureShader(this.renderer):(u.Debug.warn(s.Message.meshVertexSkinningFloatingPointTexturesNotSupported),this._skinningShader=new i.SkinningShader(this.renderer)),this._textureShader||this._skinningShader)},e.prototype.render=function(e,t){var n=this._shadowShader;if(e.skin){var r=this.getSkinningShader();r&&e.skin.joints.length>r.maxSupportedJoints?u.Debug.error(s.Message.meshVertexSkinningNumberOfJointsNotSupported,{joints:e.skin.joints.length,maxJoints:r.maxSupportedJoints}):n=r}n&&(n.updateUniforms(e,t),n.render(e,this.renderer,this._state))},e}();t.ShadowRenderer=c},function(e,t){e.exports="#version 100\n\n#define FEATURES\n\nattribute vec3 a_Position;\n\n#ifdef USE_SKINNING\nattribute vec4 a_Joint1;\nattribute vec4 a_Weight1;\n#endif\n\nuniform mat4 u_ViewProjectionMatrix;\nuniform mat4 u_ModelMatrix;\n\n#ifdef USE_SKINNING\n  #ifdef USE_SKINNING_TEXTURE\n    uniform sampler2D u_jointMatrixSampler;\n  #else\n    uniform mat4 u_jointMatrix[MAX_JOINT_COUNT];\n  #endif\n#endif\n\n// these offsets assume the texture is 4 pixels across\n#define ROW0_U ((0.5 + 0.0) / 4.0)\n#define ROW1_U ((0.5 + 1.0) / 4.0)\n#define ROW2_U ((0.5 + 2.0) / 4.0)\n#define ROW3_U ((0.5 + 3.0) / 4.0)\n\n#ifdef USE_SKINNING\nmat4 getJointMatrix(float boneNdx) {\n    #ifdef USE_SKINNING_TEXTURE\n    float v = (boneNdx + 0.5) / float(MAX_JOINT_COUNT);\n    return mat4(\n        texture2D(u_jointMatrixSampler, vec2(ROW0_U, v)),\n        texture2D(u_jointMatrixSampler, vec2(ROW1_U, v)),\n        texture2D(u_jointMatrixSampler, vec2(ROW2_U, v)),\n        texture2D(u_jointMatrixSampler, vec2(ROW3_U, v))\n    );\n    #else\n    return u_jointMatrix[int(boneNdx)];\n    #endif\n}\n\nmat4 getSkinningMatrix()\n{\n    mat4 skin = mat4(0);\n    skin +=\n        a_Weight1.x * getJointMatrix(a_Joint1.x) +\n        a_Weight1.y * getJointMatrix(a_Joint1.y) +\n        a_Weight1.z * getJointMatrix(a_Joint1.z) +\n        a_Weight1.w * getJointMatrix(a_Joint1.w);\n    return skin;\n}\n#endif\n\nvoid main() {\n  vec4 pos = vec4(a_Position, 1.0);\n  #ifdef USE_SKINNING\n    pos = getSkinningMatrix() * pos;\n  #endif\n  gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * pos;\n}"},function(e,t){e.exports="#version 100\n\n#extension GL_OES_standard_derivatives : enable\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvoid main() {\n  float depth = gl_FragCoord.z;\n  float dx = 0.0;\n  float dy = 0.0;\n\n  #ifdef GL_OES_standard_derivatives\n    dx = dFdx(depth);\n    dy = dFdy(depth);\n  #endif\n\n  float moment2 = depth * depth + 0.25 * (dx * dx + dy * dy);\n  gl_FragColor = vec4(1.0 - depth, 1.0 - moment2, 0.0, 0.0);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkinningShader=void 0;var r=n(0),o=n(1),i=n(13),a=function(e){function t(n){var r=this,o=t.getMaxJointCount(n)-1;return(r=e.call(this,n,["USE_SKINNING 1","MAX_JOINT_COUNT "+o])||this)._maxSupportedJoints=o,r}return r.__extends(t,e),Object.defineProperty(t.prototype,"maxSupportedJoints",{get:function(){return this._maxSupportedJoints},enumerable:!1,configurable:!0}),t.getMaxJointCount=function(e){var t=i.Capabilities.getMaxVertexUniformVectors(e)-8;return Math.floor(t/4)},t.prototype.createShaderGeometry=function(t){var n=e.prototype.createShaderGeometry.call(this,t);return t.joints&&n.addAttribute("a_Joint1",new o.Buffer(t.joints.buffer),4,!1,t.joints.componentType,t.joints.stride),t.weights&&n.addAttribute("a_Weight1",new o.Buffer(t.weights.buffer),4,!1,t.weights.componentType,t.weights.stride),n},Object.defineProperty(t.prototype,"name",{get:function(){return"skinned-shadow-shader"},enumerable:!1,configurable:!0}),t.prototype.updateUniforms=function(t,n){e.prototype.updateUniforms.call(this,t,n),t.skin&&(this.uniforms.u_jointMatrix=t.skin.jointMatrices)},t}(n(30).ShadowShader);t.SkinningShader=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextureShader=void 0;var r=n(0),o=n(1),i=n(30),a=n(24),u=256,s=function(e){function t(t){var n=e.call(this,t,["USE_SKINNING 1","USE_SKINNING_TEXTURE 1","MAX_JOINT_COUNT "+u])||this;return n._jointMatrixTexture=new a.StandardMaterialMatrixTexture(u),n}return r.__extends(t,e),t.isSupported=function(e){return a.StandardMaterialMatrixTexture.isSupported(e)},Object.defineProperty(t.prototype,"maxSupportedJoints",{get:function(){return u},enumerable:!1,configurable:!0}),t.prototype.createShaderGeometry=function(t){var n=e.prototype.createShaderGeometry.call(this,t);return t.joints&&n.addAttribute("a_Joint1",new o.Buffer(t.joints.buffer),4,!1,t.joints.componentType,t.joints.stride),t.weights&&n.addAttribute("a_Weight1",new o.Buffer(t.weights.buffer),4,!1,t.weights.componentType,t.weights.stride),n},Object.defineProperty(t.prototype,"name",{get:function(){return"skinned-shadow-shader"},enumerable:!1,configurable:!0}),t.prototype.updateUniforms=function(t,n){e.prototype.updateUniforms.call(this,t,n),t.skin&&(this._jointMatrixTexture.updateBuffer(t.skin.jointMatrices),this.uniforms.u_jointMatrixSampler=this._jointMatrixTexture)},t}(i.ShadowShader);t.TextureShader=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CubemapLoader=void 0;var r=n(0).__importStar(n(1)),o=n(31);t.CubemapLoader={use:function(e,t){if("cubemap"!==e.extension)return t();var n=this,i=e.data.map((function(t){return o.Cubemap.faces.map((function(n){return e.url.substring(0,e.url.lastIndexOf("/")+1)+t.replace("{{face}}",n)}))})),a=i.reduce((function(e,t){return e.concat(t)}),[]);n.add(a.filter((function(e){return!n.resources[e]})).map((function(t){return{parentResource:e,url:t}})));var u=0,s=n.onLoad.add((function(t,n){if(a.includes(n.url)&&++u===a.length){var c=i.map((function(e){return{posx:r.Texture.from(e[0]),negx:r.Texture.from(e[1]),posy:r.Texture.from(e[2]),negy:r.Texture.from(e[3]),posz:r.Texture.from(e[4]),negz:r.Texture.from(e[5])}}));e.cubemap=o.Cubemap.fromFaces(c),s.detach()}}));t()},add:function(){r.LoaderResource.setExtensionXhrType("cubemap",r.LoaderResource.XHR_RESPONSE_TYPE.JSON)}},r.Loader.registerPlugin(t.CubemapLoader)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MipmapResource=void 0;var r=n(0),o=n(96),i=n(1),a=n(97),u=n(25),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.target=n,r}return r.__extends(t,e),t.prototype.upload=function(e,t){e.gl.pixelStorei(e.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===i.ALPHA_MODES.UNPACK);for(var n=0;n<this.items.length;n++){var r=this.items[n].resource;r instanceof u.BufferResource&&e.gl.texImage2D(this.target,n,t.format,r.width,r.height,0,t.format,t.type,r.data),r instanceof a.BaseImageResource&&e.gl.texImage2D(this.target,n,t.format,t.format,t.type,r.source)}return!0},t}(o.ArrayResource);t.MipmapResource=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayResource=void 0;var r=n(0).__importStar(n(1));t.ArrayResource=r.ArrayResource||r.resources.ArrayResource},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseImageResource=void 0;var r=n(0).__importStar(n(1));t.BaseImageResource=r.BaseImageResource||r.resources.BaseImageResource},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CubeResource=void 0;var r=n(0).__importStar(n(1));t.CubeResource=r.CubeResource||r.resources.CubeResource},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderSourceLoader=void 0;var r=n(0),o=r.__importStar(n(1)),i=["glsl","vert","frag"];t.ShaderSourceLoader={use:function(e,t){if(!i.includes(e.extension))return t();t()},add:function(){var e,t;try{for(var n=r.__values(i),a=n.next();!a.done;a=n.next()){var u=a.value;o.LoaderResource.setExtensionXhrType(u,o.LoaderResource.XHR_RESPONSE_TYPE.TEXT)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}}},o.Loader.registerPlugin(t.ShaderSourceLoader)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Skybox=void 0;var r=n(0),o=n(101),i=n(7),a=n(2),u=n(31),s=function(e){function t(t){var n=e.call(this)||this;return n._mesh=n.addChild(i.Mesh3D.createCube(new o.SkyboxMaterial(t))),n}return r.__extends(t,e),Object.defineProperty(t.prototype,"camera",{get:function(){return this._mesh.material.camera},set:function(e){this._mesh.material.camera=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cubemap",{get:function(){return this._mesh.material.cubemap},set:function(e){this._mesh.material.cubemap=e},enumerable:!1,configurable:!0}),t.from=function(e){return new t(u.Cubemap.fromFaces(e))},t}(a.Container3D);t.Skybox=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkyboxMaterial=void 0;var r=n(0),o=n(1),i=n(8),a=n(5),u=function(e){function t(t){var n=e.call(this)||this;return n._cubemap=t,n.state=Object.assign(new o.State,{culling:!0,clockwiseFrontFace:!0,depthTest:!0}),n}return r.__extends(t,e),Object.defineProperty(t.prototype,"cubemap",{get:function(){return this._cubemap},set:function(e){e!==this._cubemap&&(this._cubemap.valid||(this._shader=void 0),this._cubemap=e)},enumerable:!1,configurable:!0}),t.prototype.updateUniforms=function(e,t){var n=this.camera||a.Camera.main;t.uniforms.u_ModelMatrix=e.worldTransform.array,t.uniforms.u_View=n.view,t.uniforms.u_Projection=n.projection,t.uniforms.u_EnvironmentSampler=this.cubemap},t.prototype.render=function(t,n){n.gl.depthMask(!1),e.prototype.render.call(this,t,n),n.gl.depthMask(!0)},t.prototype.createShader=function(){var e=n(102),t=n(103);if(this.cubemap.valid)return new i.MeshShader(o.Program.from(e,t))},t}(n(27).Material);t.SkyboxMaterial=u},function(e,t){e.exports="attribute vec3 a_Position;\n\nvarying vec3 v_Position;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\nvoid main() {\n  v_Position = a_Position.xyz;\n\n  // Converting the view to 3x3 matrix and then back to 4x4 matrix \n  // removes the translation. We do this because we want the skybox to \n  // be centered around the camera.\n  gl_Position = u_Projection * mat4(mat3(u_View)) * u_ModelMatrix * vec4(a_Position, 1.0);\n}"},function(e,t){e.exports="varying vec3 v_Position;\n\nuniform samplerCube u_EnvironmentSampler;\n\nvoid main() {\n  gl_FragColor = vec4(textureCube(u_EnvironmentSampler, v_Position).rgb, 1.0);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickingHitArea=void 0;var r=n(105),o=function(){function e(e,t,n){this.object=t,this.camera=n,this.id=r.PickingId.next(),this._picking=e.plugins.picking}return e.prototype.contains=function(e,t){return this._picking.containsHitArea(e,t,this)},e}();t.PickingHitArea=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickingId=void 0,function(e){var t=0;e.next=function(){return t++,new Uint8Array([t>>16&255,t>>8&255,255&t])}}(t.PickingId||(t.PickingId={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickingInteraction=void 0;var r=n(1),o=n(107),i=function(){function e(e){this.renderer=e,this._hitAreas=[],this._map=new o.PickingMap(this.renderer,128),r.Ticker.shared.add(this._update,this,r.UPDATE_PRIORITY.LOW)}return e.prototype._update=function(){this.renderer.plugins&&(this.renderer.plugins.interaction.hitTest(new r.Point(0,0)),this._hitAreas.length>0&&(this._map.resizeToAspect(),this._map.update(this._hitAreas),this._hitAreas=[]))},e.prototype.destroy=function(){r.Ticker.shared.remove(this._update,this)},e.prototype.containsHitArea=function(e,t,n){return this._hitAreas.indexOf(n)<0&&this._hitAreas.push(n),this._map.containsId(e,t,n.id)},e}();t.PickingInteraction=i,r.Renderer.registerPlugin("picking",i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickingMap=void 0;var r=n(0),o=n(7),i=n(5),a=n(1),u=n(3),s=n(8),c=function(){function e(e,t){this._renderer=e,this._update=0,this._matrix=new Float32Array(16),this._pixels=new Uint8Array(t*t*4),this._output=a.RenderTexture.create({width:t,height:t}),this._shader=new s.MeshShader(a.Program.from(n(108),n(109))),this._output.framebuffer.addDepthTexture()}return e.prototype.destroy=function(){this._output.destroy(!0),this._shader.destroy()},e.prototype.resizeToAspect=function(){var e=this._renderer.width/this._renderer.height,t=Math.floor(this._output.height*e);this._output.width!==t&&(this._pixels=new Uint8Array(t*this._output.height*4),this._output.resize(t,this._output.height))},e.prototype.containsId=function(e,t,n){var r=this._renderer.screen,o=r.width,i=r.height;e=Math.floor(e/o*this._output.width),t=Math.floor((i-t)/i*this._output.height);for(var a=0;a<3;a++)if(n[a]!==this._pixels[4*(t*this._output.width+e)+a])return!1;return!0},e.prototype.update=function(e){var t,n;if(this._renderer.renderTexture.bind(this._output),this._update++%2==0){this._renderer.renderTexture.clear();try{for(var o=r.__values(e),i=o.next();!i.done;i=o.next()){var a=i.value;this.renderHitArea(a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}else{var u=this._renderer.gl;u.readPixels(0,0,this._output.width,this._output.height,u.RGBA,u.UNSIGNED_BYTE,this._pixels)}this._renderer.renderTexture.bind(void 0)},e.prototype.renderHitArea=function(e){var t,n,a=this._shader.uniforms,s=e.object instanceof o.Mesh3D?[e.object]:e.object.meshes,c=e.camera||i.Camera.main;try{for(var f=r.__values(s),l=f.next();!l.done;l=f.next()){var d=l.value;a.u_Id=e.id,a.u_ModelViewProjection=u.Mat4.multiply(c.viewProjection,d.transform.worldTransform.array,this._matrix),this._shader.render(d,this._renderer)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}},e}();t.PickingMap=c},function(e,t){e.exports="#version 100\n\nattribute vec3 a_Position;\n\nuniform mat4 u_ModelViewProjection;\n\nvoid main() {\n  gl_Position = u_ModelViewProjection * vec4(a_Position, 1.0);\n}"},function(e,t){e.exports="#version 100\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nuniform vec3 u_Id;\n\nvoid main() {\n  gl_FragColor = vec4(u_Id / 255.0, 1.0);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowCastingLight=void 0;var r=n(12),o=n(13),i=n(111),a=n(112),u=n(32),s=function(){function e(e,t,n){if(this.renderer=e,this.light=t,this._lightViewProjection=new Float32Array(16),this.softness=0,this.shadowArea=50,this.followCamera=!0,t.type===r.LightType.point)throw new Error("PIXI3D: Only directional and spot lights are supported as shadow casters.");var o=n||{},a=o.shadowTextureSize,s=void 0===a?1024:a,c=o.quality,f=void 0===c?u.ShadowQuality.medium:c;this._shadowTexture=i.ShadowTexture.create(e,s,f),this._shadowTexture.baseTexture.framebuffer.addDepthTexture(),this._filterTexture=i.ShadowTexture.create(e,s,f)}return Object.defineProperty(e.prototype,"lightViewProjection",{get:function(){return this._lightViewProjection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowTexture",{get:function(){return this._shadowTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filterTexture",{get:function(){return this._filterTexture},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._shadowTexture.destroy(!0),this._filterTexture.destroy(!0)},e.prototype.clear=function(){this.renderer.renderTexture.bind(this._shadowTexture),this.renderer.renderTexture.clear([0,0,0,0],this.renderer.gl.COLOR_BUFFER_BIT|this.renderer.gl.DEPTH_BUFFER_BIT),this.renderer.renderTexture.bind(void 0)},e.prototype.updateLightViewProjection=function(){this.light.type===r.LightType.directional?a.ShadowMath.calculateDirectionalLightViewProjection(this):this.light.type===r.LightType.spot&&a.ShadowMath.calculateSpotLightViewProjection(this)},e.isMediumQualitySupported=function(e){return o.Capabilities.isHalfFloatFramebufferSupported(e)},e.isHighQualitySupported=function(e){return o.Capabilities.isFloatFramebufferSupported(e)},e}();t.ShadowCastingLight=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowTexture=void 0;var r=n(1),o=n(13),i=n(32);!function(e){function t(e){return o.Capabilities.supportsFloatLinear(e)?r.SCALE_MODES.LINEAR:r.SCALE_MODES.NEAREST}e.create=function(e,n,a){var u=function(e,t){if(t===i.ShadowQuality.high){if(o.Capabilities.isFloatFramebufferSupported(e))return r.TYPES.FLOAT;if(o.Capabilities.isHalfFloatFramebufferSupported(e))return r.TYPES.HALF_FLOAT}if(t===i.ShadowQuality.medium&&o.Capabilities.isHalfFloatFramebufferSupported(e))return r.TYPES.HALF_FLOAT;return r.TYPES.UNSIGNED_BYTE}(e,a);return r.RenderTexture.create({width:n,height:n,type:u,scaleMode:t(e)})}}(t.ShadowTexture||(t.ShadowTexture={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowMath=void 0;var r=n(1),o=n(3),i=n(12),a=n(4),u=n(6),s=n(5);!function(e){var t=new Float32Array(16),n=new Float32Array(16),c=new Float32Array(4),f=new Float32Array(3),l=new Float32Array(3),d=new Float32Array(3),h=new Float32Array(3);e.calculateDirectionalLightViewProjection=function(e){if(e.light.type===i.LightType.directional){var r=e.shadowArea/2,p=2*r/e.shadowArea,_=o.Mat4.ortho(-r,r,-r,r,-r,r,t),m=e.light,v=e.camera||s.Camera.main;v&&e.followCamera?(a.Vec3.scale(v.worldTransform.forward,r,h),a.Vec3.add(v.worldTransform.position,h,d),a.Vec3.transformQuat(d,u.Quat.conjugate(e.light.worldTransform.rotation,c),f),f[0]=p*Math.floor(f[0]/p),f[1]=p*Math.floor(f[1]/p),a.Vec3.transformQuat(f,m.worldTransform.rotation,f),a.Vec3.add(f,m.worldTransform.forward,l),o.Mat4.lookAt(f,l,m.worldTransform.up,n),o.Mat4.multiply(_,n,e.lightViewProjection)):(a.Vec3.add(m.worldTransform.position,e.light.worldTransform.forward,d),o.Mat4.lookAt(m.worldTransform.position,d,m.worldTransform.up,n),o.Mat4.multiply(_,n,e.lightViewProjection))}},e.calculateSpotLightViewProjection=function(e){if(e.light.type===i.LightType.spot){var u=e.light;o.Mat4.perspective(u.outerConeAngle*r.DEG_TO_RAD*2,1,2,u.range,t),a.Vec3.add(u.worldTransform.position,u.worldTransform.forward,d),o.Mat4.lookAt(u.worldTransform.position,d,u.worldTransform.up,n),o.Mat4.multiply(t,n,e.lightViewProjection)}}}(t.ShadowMath||(t.ShadowMath={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Plane=void 0;var r=n(4);var o=1e-6,i=function(){function e(e,t){this.distance=t,this._normal=new Float32Array(3),r.Vec3.normalize(e,this._normal)}return Object.defineProperty(e.prototype,"normal",{get:function(){return this._normal},enumerable:!1,configurable:!0}),e.prototype.rayCast=function(e){var t,n,i=r.Vec3.dot(e.direction,this.normal);return t=i,n=0,Math.abs(t-n)<=o*Math.max(1,Math.abs(t),Math.abs(n))?0:(-r.Vec3.dot(e.origin,this.normal)-this.distance)/i},e}();t.Plane=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sprite3D=void 0;var r=n(0),o=n(5),i=n(56),a=n(2),u=n(3),s=n(115),c=function(e){function t(t){var n=e.call(this)||this;return n._modelView=new Float32Array(16),n._sprite=new s.ProjectionSprite(t),n._sprite.anchor.set(.5),n}return r.__extends(t,e),Object.defineProperty(t.prototype,"billboardType",{get:function(){return this._billboardType},set:function(e){e!==this._billboardType&&(this._billboardType=e,this._cameraTransformId=void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pixelsPerUnit",{get:function(){return this._sprite.pixelsPerUnit},set:function(e){this._sprite.pixelsPerUnit=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._sprite.tint},set:function(e){this._sprite.tint=e},enumerable:!1,configurable:!0}),t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this._sprite.destroy(t)},t.prototype._render=function(e){var t=this.camera||o.Camera.main;if(t.transformId!==this._cameraTransformId||this._parentID!==this.transform._worldID){var n=this.worldTransform.scaling;switch(u.Mat4.multiply(t.view,this.worldTransform.array,this._modelView),this._billboardType){case i.SpriteBillboardType.spherical:this._modelView[0]=n[0],this._modelView[1]=0,this._modelView[2]=0,this._modelView[3]=0,this._modelView[4]=0,this._modelView[5]=n[1],this._modelView[6]=0,this._modelView[7]=0;break;case i.SpriteBillboardType.cylindrical:this._modelView[0]=n[0],this._modelView[1]=0,this._modelView[2]=0,this._modelView[3]=0,this._modelView[8]=0,this._modelView[9]=0,this._modelView[10]=1,this._modelView[11]=0}u.Mat4.multiply(t.projection,this._modelView,this._sprite.modelViewProjection),this._parentID=this.transform._worldID,this._cameraTransformId=t.transformId}this._sprite.worldAlpha=this.worldAlpha,this._sprite.render(e)},Object.defineProperty(t.prototype,"anchor",{get:function(){return this._sprite.anchor},set:function(e){this._sprite.anchor=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._sprite.texture},set:function(e){this._sprite.texture=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._sprite.blendMode},set:function(e){this._sprite.blendMode=e},enumerable:!1,configurable:!0}),t}(a.Container3D);t.Sprite3D=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectionSprite=void 0;var r=n(0),o=r.__importStar(n(1)),i=function(e){function t(t){var n=e.call(this,t)||this;return n._pixelsPerUnit=100,n.modelViewProjection=new Float32Array(16),n.pluginName="sprite3d",n}return r.__extends(t,e),Object.defineProperty(t.prototype,"pixelsPerUnit",{get:function(){return this._pixelsPerUnit},set:function(e){e!==this._pixelsPerUnit&&(this._transformID=-1,this._pixelsPerUnit=e)},enumerable:!1,configurable:!0}),t.prototype.calculateVertices=function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var t=this.transform.worldTransform,n=e.orig,r=this._anchor,i=e.trim?e.trim.x-r._x*n.width:-r._x*n.width,a=e.trim?i+e.trim.width:i+n.width,u=e.trim?e.trim.y-r._y*n.height:-r._y*n.height,s=e.trim?u+e.trim.height:u+n.height;if(this.vertexData[0]=(t.a*i+t.c*-u)/this._pixelsPerUnit,this.vertexData[1]=(t.d*-u+t.b*i)/this._pixelsPerUnit,this.vertexData[2]=(t.a*a+t.c*-u)/this._pixelsPerUnit,this.vertexData[3]=(t.d*-u+t.b*a)/this._pixelsPerUnit,this.vertexData[4]=(t.a*a+t.c*-s)/this._pixelsPerUnit,this.vertexData[5]=(t.d*-s+t.b*a)/this._pixelsPerUnit,this.vertexData[6]=(t.a*i+t.c*-s)/this._pixelsPerUnit,this.vertexData[7]=(t.d*-s+t.b*i)/this._pixelsPerUnit,this.roundPixels)for(var c=o.settings.RESOLUTION,f=0;f<this.vertexData.length;++f)this.vertexData[f]=Math.round((this.vertexData[f]*c|0)/c)}},t}(o.Sprite);t.ProjectionSprite=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpriteBatchRenderer=void 0;var r=n(0),o=r.__importStar(n(1)),i=n(117),a=function(e){function t(t){var r=e.call(this,t)||this;return r.shaderGenerator=new o.BatchShaderGenerator(n(118),n(119)),r.geometryClass=i.SpriteBatchGeometry,r.vertexSize=22,Object.assign(r.state,{culling:!1,clockwiseFrontFace:!1,depthTest:!0}),r}return r.__extends(t,e),t.prototype.packInterleavedGeometry=function(e,t,n,r,i){for(var a=t.uint32View,u=t.float32View,s=r/this.vertexSize,c=e.uvs,f=e.indices,l=e.vertexData,d=e._texture.baseTexture._batchLocation,h=Math.min(e.worldAlpha,1),p=h<1&&e._texture.baseTexture.alphaMode?o.utils.premultiplyTint(e._tintRGB,h):e._tintRGB+(255*h<<24),_=0;_<l.length;_+=2){u[r++]=l[_],u[r++]=l[_+1],u[r++]=c[_],u[r++]=c[_+1],a[r++]=p,u[r++]=d;for(var m=0;m<16;m++)u[r++]=e.modelViewProjection[m]}for(_=0;_<f.length;_++)n[i++]=s+f[_]},t}(o.AbstractBatchRenderer);t.SpriteBatchRenderer=a,o.Renderer.registerPlugin("sprite3d",a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpriteBatchGeometry=void 0;var r=n(0),o=r.__importStar(n(1)),i=function(e){function t(){var t=e.call(this)||this;return t.addAttribute("aMatrix0",t._buffer,4,!1,o.TYPES.FLOAT),t.addAttribute("aMatrix1",t._buffer,4,!1,o.TYPES.FLOAT),t.addAttribute("aMatrix2",t._buffer,4,!1,o.TYPES.FLOAT),t.addAttribute("aMatrix3",t._buffer,4,!1,o.TYPES.FLOAT),t}return r.__extends(t,e),t}(o.BatchGeometry);t.SpriteBatchGeometry=i},function(e,t){e.exports="precision highp float;\n\nattribute vec2 aVertexPosition;\n\nattribute vec4 aMatrix0;\nattribute vec4 aMatrix1;\nattribute vec4 aMatrix2;\nattribute vec4 aMatrix3;\n\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void) {\n  mat4 modelMatrix = mat4(aMatrix0, aMatrix1, aMatrix2, aMatrix3);\n\n  gl_Position = modelMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);\n\n  vTextureCoord = vec2(aTextureCoord.x, aTextureCoord.y);\n  vTextureId = aTextureId;\n  vColor = aColor * tint;\n}"},function(e,t){e.exports="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = vColor * vec4(color.rgb, color.a);\n}"}])}));